webpackJsonp([37],{0:function(module,exports,__webpack_require__){"use strict";var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);__webpack_require__(4);__webpack_require__(5);__webpack_require__(246);__webpack_require__(6);__webpack_require__(247);var _ScormResultsCtrl=__webpack_require__(1880);var _ScormResultsCtrl2=_interopRequireDefault(_ScormResultsCtrl);var _ScormResultsService=__webpack_require__(1881);var _ScormResultsService2=_interopRequireDefault(_ScormResultsService);var _ScormResultsDirective=__webpack_require__(1882);var _ScormResultsDirective2=_interopRequireDefault(_ScormResultsDirective);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_index2.default.module("ScormResultsModule",["ui.router","ui.translation","ui.bootstrap","ui.bootstrap.tpls","ngAnimate","angular-loading-bar","ngTable"]).controller("ScormResultsCtrl",["NgTableParams","ScormResultsService",_ScormResultsCtrl2.default]).service("ScormResultsService",_ScormResultsService2.default).directive("scormResults",function(){return new _ScormResultsDirective2.default}).config(["cfpLoadingBarProvider",function configureLoadingBar(cfpLoadingBarProvider){cfpLoadingBarProvider.latencyThreshold=200;cfpLoadingBarProvider.includeBar=true;cfpLoadingBarProvider.includeSpinner=true}])},1880:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ScormResultsCtrl=function(){function ScormResultsCtrl(NgTableParams,ScormResultsService){(0,_classCallCheck3.default)(this,ScormResultsCtrl);this.NgTableParams=NgTableParams;this.ScormResultsService=ScormResultsService;this.type=ScormResultsService.getType();this.scos=ScormResultsService.getScos();this.scosTrackings=ScormResultsService.getScosTrackings();this.trackingsDetails=ScormResultsService.getTrackingsDetails();this.isCollapsed={};this.scosTableParams={};this.initializeTableParams()}(0,_createClass3.default)(ScormResultsCtrl,[{key:"initializeTableParams",value:function initializeTableParams(){var _this=this;this.scos.forEach(function(s){var scoId=s["id"];_this.scosTableParams[scoId]=new _this.NgTableParams({count:20},{counts:[10,20,50,100],dataset:_this.scosTrackings[scoId]})})}},{key:"loadDetails",value:function loadDetails(userId,trackingId,scoId){this.ScormResultsService.loadTrackingDetails(userId,trackingId,scoId)}}]);return ScormResultsCtrl}();exports.default=ScormResultsCtrl},1881:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ScormResultsService=function(){function ScormResultsService($http){(0,_classCallCheck3.default)(this,ScormResultsService);this.$http=$http;this.resourceNodeId=ScormResultsService._getGlobal("resourceNodeId");this.type=ScormResultsService._getGlobal("type");this.scos=JSON.parse(ScormResultsService._getGlobal("scos"));this.scosTrackings={};this.trackings=this.formatTrackingsDatas(ScormResultsService._getGlobal("trackings"));this.trackingsDetails={}}(0,_createClass3.default)(ScormResultsService,[{key:"getType",value:function getType(){return this.type}},{key:"getScos",value:function getScos(){return this.scos}},{key:"getTrackings",value:function getTrackings(){return this.trackings}},{key:"getScosTrackings",value:function getScosTrackings(){return this.scosTrackings}},{key:"getTrackingsDetails",value:function getTrackingsDetails(){return this.trackingsDetails}},{key:"formatTrackingsDatas",value:function formatTrackingsDatas(serializedDatas){var _this=this;var datas=JSON.parse(serializedDatas);datas.forEach(function(t){t["userId"]=t["user"]["id"];t["userFirstName"]=t["user"]["firstName"];t["userLastName"]=t["user"]["lastName"];t["userUsername"]=t["user"]["username"];if(_this.type==="scorm12"){t["transBestLessonStatus"]=Translator.trans(t["bestLessonStatus"],{},"scorm");t["transLessonStatus"]=Translator.trans(t["lessonStatus"],{},"scorm");t["convertedSessionTime"]=_this.convertScorm12Time(t["sessionTime"]);t["convertedTotalTime"]=_this.convertScorm12Time(t["totalTime"])}else if(_this.type==="scorm2004"){t["transCompletionStatus"]=Translator.trans(t["completionStatus"],{},"scorm");t["transSuccessStatus"]=Translator.trans(t["successStatus"],{},"scorm");t["convertedSessionTime"]=_this.convertScorm2004Time(t["details"]["cmi.session_time"]);t["convertedTotalTime"]=_this.convertScorm2004Time(t["totalTime"])}_this.sortTrackingBySco(t)});return datas}},{key:"sortTrackingBySco",value:function sortTrackingBySco(tracking){var scoId=tracking["sco"]["id"];if(!this.scosTrackings[scoId]){this.scosTrackings[scoId]=[]}this.scosTrackings[scoId].push(tracking)}},{key:"convertScorm12Time",value:function convertScorm12Time(time){if(time===undefined||time===null){return null}var remainingTime=Math.floor(time/100);var hours=Math.floor(remainingTime/3600);remainingTime%=3600;var minutes=Math.floor(remainingTime/60);remainingTime%=60;var minutesTxt=minutes>9?minutes:"0"+minutes;var secundsTxt=remainingTime>9?remainingTime:"0"+remainingTime;return hours+":"+minutesTxt+":"+secundsTxt}},{key:"convertScorm2004Time",value:function convertScorm2004Time(time){if(time===undefined||time===null){return null}var pattern=/T([0-9]+H)?([0-9]+M)?([0-9]+S)?$/;var formattedTime=this.formatScorm2004Date(time);var matches=formattedTime.match(pattern);var hours=matches[1]===undefined?0:parseInt(matches[1].replace(/H/,""));var minutes=matches[2]===undefined?0:parseInt(matches[2].replace(/M/,""));var secunds=matches[3]===undefined?0:parseInt(matches[3].replace(/S/,""));var minutesTxt=minutes>9?minutes:"0"+minutes;var secundsTxt=secunds>9?secunds:"0"+secunds;return hours+":"+minutesTxt+":"+secundsTxt}},{key:"formatScorm12Date",value:function formatScorm12Date(date){var formattedDate=date.replace(/\..*$/,"");return formattedDate}},{key:"formatScorm2004Date",value:function formatScorm2004Date(date){var formattedDate=date.replace(/\..*S$/,"S");return formattedDate}},{key:"loadTrackingDetails",value:function loadTrackingDetails(userId,trackingId,scoId){var _this2=this;if(this.trackingsDetails[trackingId]===undefined){var url=Routing.generate("claro_scorm_get_tracking_details",{user:userId,resourceNode:this.resourceNodeId,scoId:scoId});this.$http.get(url).then(function(d){if(d["status"]===200){_this2.trackingsDetails[trackingId]=_this2.formatDetailsDatas(d["data"])}})}}},{key:"formatDetailsDatas",value:function formatDetailsDatas(detailsDatas){var _this3=this;detailsDatas.forEach(function(d){d["formattedDate"]=_this3.formatScorm12Date(d["dateLog"]["date"]);if(_this3.type==="scorm12"){d["transLessonStatus"]=Translator.trans(d["details"]["lessonStatus"],{},"scorm");d["convertedSessionTime"]=_this3.convertScorm12Time(d["details"]["sessionTime"]);d["convertedTotalTime"]=_this3.convertScorm12Time(d["details"]["totalTime"])}else if(_this3.type==="scorm2004"){d["transCompletionStatus"]=Translator.trans(d["details"]["cmi.completion_status"],{},"scorm");d["transSuccessStatus"]=Translator.trans(d["details"]["cmi.success_status"],{},"scorm");d["convertedSessionTime"]=_this3.convertScorm2004Time(d["details"]["cmi.session_time"]);d["convertedTotalTime"]=_this3.convertScorm2004Time(d["details"]["cmi.total_time"])}});return detailsDatas}}],[{key:"_getGlobal",value:function _getGlobal(name){if(typeof window[name]==="undefined"){throw new Error("Expected "+name+" to be exposed in a window."+name+" variable")}return window[name]}}]);return ScormResultsService}();exports.default=ScormResultsService},1882:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _scormResults=__webpack_require__(1883);var _scormResults2=_interopRequireDefault(_scormResults);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ScormResultsDirective=function ScormResultsDirective(){(0,_classCallCheck3.default)(this,ScormResultsDirective);this.controllerAs="src";this.bindToController=true;this.controller="ScormResultsCtrl";this.template=_scormResults2.default};exports.default=ScormResultsDirective},1883:function(module,exports){module.exports="<div>\n    <uib-tabset active=\"active\">\n        <uib-tab index=\"sco['id']\" ng-repeat=\"sco in src.scos\">\n            <uib-tab-heading>\n                {{ sco['title'] }}\n            </uib-tab-heading>\n            <br>\n            <div ng-if=\"src.type === 'scorm12'\">\n                <div class=\"alert alert-warning\" ng-if=\"src.scosTrackings[sco['id']].length === 0\">\n                    {{ 'no_result'|trans:{}:'scorm' }}\n                </div>\n                <div class=\"table-responsive\" ng-if=\"src.scosTrackings[sco['id']].length > 0\">\n                    <table class=\"table\" ng-table=\"src.scosTableParams[sco['id']]\" show-filter=\"true\">\n                        <tbody ng-repeat=\"tracking in $data\">\n                            <tr>\n                                <td>\n                                    <span data-toggle=\"tooltip\" data-placement=\"top\" title=\"{{ 'display_details'|trans:{}:'scorm' }}\">\n                                        <i class=\"fa pointer-hand\" ng-class=\"src.isCollapsed[tracking['id']] ? 'fa-chevron-circle-down' : 'fa-chevron-circle-right'\"\n                                           style=\"color: #286090\"\n                                           ng-click=\"(src.isCollapsed[tracking['id']] = !src.isCollapsed[tracking['id']]) && src.loadDetails(tracking['userId'], tracking['id'], sco['id'])\"\n                                        >\n                                        </i>\n                                    </span>\n                                </td>\n                                <td data-title=\"'firstName'|trans:{}:'platform'\" filter=\"{userFirstName: 'text'}\" sortable=\"'userFirstName'\">\n                                    {{ tracking['userFirstName'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'lastName'|trans:{}:'platform'\" filter=\"{userLastName: 'text'}\" sortable=\"'userLastName'\">\n                                    {{ tracking['userLastName'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'last_status'|trans:{}:'scorm'\" filter=\"{transLessonStatus: 'text'}\" sortable=\"'transLessonStatus'\">\n                                    {{ tracking['transLessonStatus'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'best_status'|trans:{}:'scorm'\" filter=\"{transBestLessonStatus: 'text'}\" sortable=\"'transBestLessonStatus'\">\n                                    {{ tracking['transBestLessonStatus'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'last_score'|trans:{}:'scorm'\" filter=\"{scoreRaw: 'text'}\" sortable=\"'scoreRaw'\">\n                                    {{ tracking['scoreRaw'] }}\n                                    <span ng-if=\"tracking['scoreMax'] > 0\">/ {{ tracking['scoreMax'] }}</span>\n                                </td>\n                                <td class=\"text-center\" data-title=\"'best_score'|trans:{}:'scorm'\" filter=\"{bestScoreRaw: 'text'}\" sortable=\"'bestScoreRaw'\">\n                                    {{ tracking['bestScoreRaw'] }}\n                                    <span ng-if=\"tracking['scoreMax'] > 0\">/ {{ tracking['scoreMax'] }}</span>\n                                </td>\n                                <td class=\"text-center\" data-title=\"'session_time'|trans:{}:'scorm'\" filter=\"{convertedSessionTime: 'text'}\" sortable=\"'convertedSessionTime'\">\n                                    {{ tracking['convertedSessionTime'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'total_time'|trans:{}:'platform'\" filter=\"{convertedTotalTime: 'text'}\" sortable=\"'convertedTotalTime'\">\n                                    {{ tracking['convertedTotalTime'] }}\n                                </td>\n                            </tr>\n                            <tr uib-collapse=\"!src.isCollapsed[tracking['id']]\">\n                                <td></td>\n                                <td colspan=\"5\">\n                                    <div class=\"table-responsive\" ng-if=\"src.trackingsDetails[tracking['id']].length > 0\">\n                                        <table class=\"table\">\n                                            <tr>\n                                                <th class=\"results-details-cell-header\">{{ 'date'|trans:{}:'platform' }}</th>\n                                                <th class=\"results-details-cell-header\">{{ 'status'|trans:{}:'platform' }}</th>\n                                                <th class=\"results-details-cell-header\">{{ 'score'|trans:{}:'platform' }}</th>\n                                                <th class=\"results-details-cell-header\">{{ 'duration'|trans:{}:'platform' }}</th>\n                                                <th class=\"results-details-cell-header\">{{ 'total_time'|trans:{}:'platform' }}</th>\n                                            </tr>\n                                            <tr class=\"text-center\" ng-repeat=\"details in src.trackingsDetails[tracking['id']]\">\n                                                <td>{{ details['formattedDate'] }}</td>\n                                                <td>{{ details['transLessonStatus'] }}</td>\n                                                <td>\n                                                    {{ details['details']['scoreRaw'] }}\n                                                    <span ng-if=\"details['details']['scoreMax'] > 0\">\n                                                        / {{ details['details']['scoreMax'] }}\n                                                    </span>\n                                                </td>\n                                                <td>{{ details['convertedSessionTime'] }}</td>\n                                                <td>{{ details['convertedTotalTime'] }}</td>\n                                            </tr>\n                                        </table>\n                                    </div>\n                                    <div class=\"alert alert-warning\" ng-if=\"src.trackingsDetails[tracking['id']].length === 0\">\n                                        {{ 'no_detail'|trans:{}:'scorm' }}\n                                    </div>\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n\n            <div ng-if=\"src.type === 'scorm2004'\">\n                <div class=\"alert alert-warning\" ng-if=\"src.scosTrackings[sco['id']].length === 0\">\n                    {{ 'no_result'|trans:{}:'scorm' }}\n                </div>\n                <div class=\"table-responsive\" ng-if=\"src.scosTrackings[sco['id']].length > 0\">\n                    <table class=\"table\" ng-table=\"src.scosTableParams[sco['id']]\" show-filter=\"true\">\n                        <tbody ng-repeat=\"tracking in $data\">\n                            <tr>\n                                <td>\n                                    <span data-toggle=\"tooltip\" data-placement=\"top\" title=\"{{ 'display_details'|trans:{}:'scorm' }}\">\n                                        <i class=\"fa pointer-hand\" ng-class=\"src.isCollapsed[tracking['id']] ? 'fa-chevron-circle-down' : 'fa-chevron-circle-right'\"\n                                           style=\"color: #286090\"\n                                           ng-click=\"(src.isCollapsed[tracking['id']] = !src.isCollapsed[tracking['id']]) && src.loadDetails(tracking['userId'], tracking['id'], sco['id'])\"\n                                        >\n                                        </i>\n                                    </span>\n                                </td>\n                                <td data-title=\"'firstName'|trans:{}:'platform'\" filter=\"{userFirstName: 'text'}\" sortable=\"'userFirstName'\">\n                                    {{ tracking['userFirstName'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'lastName'|trans:{}:'platform'\" filter=\"{userLastName: 'text'}\" sortable=\"'userLastName'\">\n                                    {{ tracking['userLastName'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'completion_status'|trans:{}:'scorm'\" filter=\"{transCompletionStatus: 'text'}\" sortable=\"'transCompletionStatus'\">\n                                    {{ tracking['transCompletionStatus'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'success_status'|trans:{}:'scorm'\" filter=\"{transSuccessStatus: 'text'}\" sortable=\"'transSuccessStatus'\">\n                                    {{ tracking['transSuccessStatus'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'score'|trans:{}:'platform'\" filter=\"{scoreRaw: 'text'}\" sortable=\"'scoreRaw'\">\n                                    {{ tracking['scoreRaw'] }}\n                                    <span ng-if=\"tracking['scoreMax'] > 0\">/ {{ tracking['scoreMax'] }}</span>\n                                </td>\n                                <td class=\"text-center\" data-title=\"'session_time'|trans:{}:'scorm'\" filter=\"{convertedSessionTime: 'text'}\" sortable=\"'convertedSessionTime'\">\n                                    {{ tracking['convertedSessionTime'] }}\n                                </td>\n                                <td class=\"text-center\" data-title=\"'total_time'|trans:{}:'platform'\" filter=\"{convertedTotalTime: 'text'}\" sortable=\"'convertedTotalTime'\">\n                                    {{ tracking['convertedTotalTime'] }}\n                                </td>\n                            </tr>\n                            <tr uib-collapse=\"!src.isCollapsed[tracking['id']]\">\n                                <td></td>\n                                <td colspan=\"6\">\n                                    <div class=\"table-responsive\" ng-if=\"src.trackingsDetails[tracking['id']].length > 0\">\n                                        <table class=\"table\">\n                                            <tr>\n                                                <th class=\"results-details-cell-header\">{{ 'date'|trans:{}:'platform' }}</th>\n                                                <th class=\"results-details-cell-header\">{{ 'completion_status'|trans:{}:'scorm' }}</th>\n                                                <th class=\"results-details-cell-header\">{{ 'success_status'|trans:{}:'scorm' }}</th>\n                                                <th class=\"results-details-cell-header\">{{ 'score'|trans:{}:'platform' }}</th>\n                                                <th class=\"results-details-cell-header\">{{ 'duration'|trans:{}:'platform' }}</th>\n                                                <th class=\"results-details-cell-header\">{{ 'total_time'|trans:{}:'platform' }}</th>\n                                            </tr>\n                                            <tr class=\"text-center\" ng-repeat=\"details in src.trackingsDetails[tracking['id']]\">\n                                                <td>{{ details['formattedDate'] }}</td>\n                                                <td>{{ details['transCompletionStatus'] }}</td>\n                                                <td>{{ details['transSuccessStatus'] }}</td>\n                                                <td>\n                                                    {{ details['details']['cmi.score.raw'] }}\n                                                    <span ng-if=\"details['details']['cmi.score.max'] > 0\">\n                                                        / {{ details['details']['cmi.score.max'] }}\n                                                    </span>\n                                                </td>\n                                                <td>{{ details['convertedSessionTime'] }}</td>\n                                                <td>{{ details['convertedTotalTime'] }}</td>\n                                            </tr>\n                                        </table>\n                                    </div>\n                                    <div class=\"alert alert-warning\" ng-if=\"src.trackingsDetails[tracking['id']].length === 0\">\n                                        {{ 'no_detail'|trans:{}:'scorm' }}\n                                    </div>\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </uib-tab>\n    </uib-tabset>\n</div>"}});