webpackJsonp([30],{0:function(module,exports,__webpack_require__){"use strict";var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);__webpack_require__(247);__webpack_require__(5);__webpack_require__(245);__webpack_require__(6);__webpack_require__(237);__webpack_require__(448);__webpack_require__(90);__webpack_require__(1729);__webpack_require__(1734);var _AdminCtrl=__webpack_require__(1739);var _AdminCtrl2=_interopRequireDefault(_AdminCtrl);var _AdminService=__webpack_require__(1744);var _AdminService2=_interopRequireDefault(_AdminService);var _admin=__webpack_require__(1745);var _admin2=_interopRequireDefault(_admin);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var adminApp=_index2.default.module("AdminApp",["ngRoute","angular-loading-bar","ui.html-truster","ui.translation","ui.fos-js-router","ui.modal","ui.bootstrap.popover","Shared","Modals"]);adminApp.config(["cfpLoadingBarProvider",function adminAppConfig(cfpLoadingBarProvider){cfpLoadingBarProvider.latencyThreshold=200;cfpLoadingBarProvider.includeBar=false;cfpLoadingBarProvider.spinnerTemplate='<div class="loading">Loading&#8230;</div>'}]);adminApp.component("mrAdmin",{template:_admin2.default,bindings:{resource:"="},controller:_AdminCtrl2.default});adminApp.service("AdminService",["$http","$q","url",_AdminService2.default])},448:function(module,exports,__webpack_require__){"use strict";__webpack_require__(10);var _angularBootstrap=__webpack_require__(5);var _angularBootstrap2=_interopRequireDefault(_angularBootstrap);var _ConfirmModalDirective=__webpack_require__(449);var _ConfirmModalDirective2=_interopRequireDefault(_ConfirmModalDirective);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}angular.module("ui.modal",["ui.bootstrap"]).directive("confirmModal",["$uibModal",function(){return new _ConfirmModalDirective2.default}])},449:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _ConfirmModalController=__webpack_require__(450);var _ConfirmModalController2=_interopRequireDefault(_ConfirmModalController);var _confirmModal=__webpack_require__(451);var _confirmModal2=_interopRequireDefault(_confirmModal);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ConfirmModalDirective=function ConfirmModalDirective(){(0,_classCallCheck3.default)(this,ConfirmModalDirective);this.restrict="A";this.replace=false;this.scope={content:"@confirmModal",confirmCallback:"&confirmModalAction",cancelCallback:"&confirmModalCancel"};this.bindToController=true;this.controllerAs="modalCtrl";this.controller=["$uibModal",function(){function ModalCtrl($uibModal){(0,_classCallCheck3.default)(this,ModalCtrl);this.$uibModal=$uibModal}(0,_createClass3.default)(ModalCtrl,[{key:"open",value:function open(){var _this=this;var message=this.content;this.$uibModal.open({template:_confirmModal2.default,controller:_ConfirmModalController2.default,controllerAs:"confirmCtrl",resolve:{content:function content(){return message}}}).result.then(function(d){if(typeof _this.confirmCallback==="function"){_this.confirmCallback()}},function(d){if(typeof _this.cancelCallback==="function"){_this.cancelCallback()}})}}]);return ModalCtrl}()];this.link=function link(scope,element,attr,controller){element.on("click",controller.open.bind(controller));scope.$on("$destroy",function(){element.off("click",controller.open.bind(controller))})}};exports.default=ConfirmModalDirective},450:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ConfirmModalController=function(){function ConfirmModalController($uibModalInstance,content){(0,_classCallCheck3.default)(this,ConfirmModalController);this.$uibModalInstance=$uibModalInstance;this.content=content}(0,_createClass3.default)(ConfirmModalController,[{key:"cancel",value:function cancel(){this.$uibModalInstance.dismiss("cancel")}},{key:"confirm",value:function confirm(){this.$uibModalInstance.close()}}]);return ConfirmModalController}();exports.default=ConfirmModalController},451:function(module,exports){module.exports='<div class="modal-body" data-ng-bind-html="confirmCtrl.content"></div>\n\n<div class="modal-footer">\n    <button class="btn btn-primary" data-ng-click="confirmCtrl.confirm()">\n        {{ \'confirm\' | trans:{}:\'platform\' }}\n    </button>\n    <button class="btn btn-default cancel" data-ng-click="confirmCtrl.cancel()">\n        {{ \'cancel\' | trans:{}:\'platform\' }}\n    </button>\n</div>'},1729:function(module,exports,__webpack_require__){"use strict";var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);__webpack_require__(11);__webpack_require__(237);var _SecondsToHmsFilter=__webpack_require__(1730);var _SecondsToHmsFilter2=_interopRequireDefault(_SecondsToHmsFilter);var _ConfigService=__webpack_require__(1731);var _ConfigService2=_interopRequireDefault(_ConfigService);var _RegionsService=__webpack_require__(1732);var _RegionsService2=_interopRequireDefault(_RegionsService);var _UserService=__webpack_require__(1733);var _UserService2=_interopRequireDefault(_UserService);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_index2.default.module("Shared",["ngSanitize","ui.fos-js-router"]).filter("secondsToHms",[_SecondsToHmsFilter2.default]).service("configService",["$filter",_ConfigService2.default]).service("regionsService",[_RegionsService2.default]).service("userService",["$http","$q","url",_UserService2.default])},1730:function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function SecondsToHmsFilter(){return function(d){d=Number(d);var result="";if(d>0){var hours=Math.floor(d/3600);var minutes=Math.floor(d%3600/60);var seconds=Math.floor(d%3600%60);var str=d.toString();var substr=str.split(".");var ms=substr[1].substring(0,2);if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}result=minutes+":"+seconds+":"+ms}else{result="00:00:00"}return result}}exports.default=SecondsToHmsFilter},1731:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ConfigService=function(){function ConfigService($filter){(0,_classCallCheck3.default)(this,ConfigService);this.filter=$filter}(0,_createClass3.default)(ConfigService,[{key:"getHelPlayModes",value:function getHelPlayModes(){return{NORMAL:1,LOOP:2,SLOW:3,TTS:4,RELATED:5}}},{key:"getAvailableTTSLanguage",value:function getAvailableTTSLanguage(){return[{name:this.filter("trans")("options_form_tts_choices_en_US",{},"media_resource"),value:"en-US"},{name:this.filter("trans")("options_form_tts_choices_en_GB",{},"media_resource"),value:"en-GB"},{name:this.filter("trans")("options_form_tts_choices_de_DE",{},"media_resource"),value:"de-DE"},{name:this.filter("trans")("options_form_tts_choices_es_ES",{},"media_resource"),value:"es-ES"},{name:this.filter("trans")("options_form_tts_choices_fr_FR",{},"media_resource"),value:"fr-FR"},{name:this.filter("trans")("options_form_tts_choices_it_IT",{},"media_resource"),value:"it-IT"}]}},{key:"getAvailablePlayModes",value:function getAvailablePlayModes(){return[{key:"CONTINUOUS_LIVE",name:this.filter("trans")("options_form_view_mode_choices_live",{},"media_resource"),value:"live"},{key:"CONTINUOUS_PAUSE",name:this.filter("trans")("options_form_view_mode_choices_pause",{},"media_resource"),value:"pause"},{key:"FREE",name:this.filter("trans")("options_form_view_mode_choices_free",{},"media_resource"),value:"free"},{key:"CONTINUOUS_ACTIVE",name:this.filter("trans")("options_form_view_mode_choices_active",{},"media_resource"),value:"active"},{key:"SCRIPTED_ACTIVE",name:this.filter("trans")("options_form_view_mode_choices_scripted_active",{},"media_resource"),value:"scripted_active"}]}},{key:"getWavesurferOptions",value:function getWavesurferOptions(){return{container:"#waveform",waveColor:"#172B32",progressColor:"#00A1E5",height:256,interact:true,scrollParent:false,normalize:true,minimap:true}}},{key:"getAutoPauseTime",value:function getAutoPauseTime(){return 2e3}}]);return ConfigService}();exports.default=ConfigService},1732:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getIterator2=__webpack_require__(557);var _getIterator3=_interopRequireDefault(_getIterator2);var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RegionsService=function(){function RegionsService(){(0,_classCallCheck3.default)(this,RegionsService)}(0,_createClass3.default)(RegionsService,[{key:"create",value:function create(start,end){var region={uuid:this.createGuid(),start:Number(start),end:Number(end),note:"",helps:{backward:false,loop:false,rate:false,helpRegionUuid:"",helpLinks:this.createDefaultLinks(),helpTexts:this.createDefaultTexts()}};return region}},{key:"createDefaultLinks",value:function createDefaultLinks(){var links=[];for(var i=0;i<3;i++){links.push({id:null,url:""})}return links}},{key:"createDefaultTexts",value:function createDefaultTexts(){var texts=[];for(var i=0;i<3;i++){texts.push({id:null,text:""})}return texts}},{key:"getRegionByUuid",value:function getRegionByUuid(searched,regions){var result=regions.find(function(el){return el.uuid===searched});return result}},{key:"getRegionFromTime",value:function getRegionFromTime(time,regions){var currentTime=Number(time);var result=void 0;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=(0,_getIterator3.default)(regions),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var region=_step.value;if(region.start<=currentTime&&region.end>currentTime){result=region;break}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return result}},{key:"getNextRegion",value:function getNextRegion(time,regions){var next=void 0;var current=this.getRegionFromTime(time,regions);var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=(0,_getIterator3.default)(regions),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var region=_step2.value;if(region.start===current.end){next=region}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}return next}},{key:"getPrevRegion",value:function getPrevRegion(time,regions){var prev=void 0;var current=this.getRegionFromTime(time,regions);var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=(0,_getIterator3.default)(regions),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var region=_step3.value;if(region.end===current.start){prev=region}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}return prev}},{key:"regionHasHelp",value:function regionHasHelp(helps){return helps&&(helps.backward||helps.helpRegionUuid!==""||helps.helpLinks.filter(function(el){return el.url!==""}).length>0||helps.helpTexts.filter(function(el){return el.text!==""}).length>0||helps.loop||helps.rate)}},{key:"regionHasHelpTexts",value:function regionHasHelpTexts(helps){return helps.helpTexts.filter(function(el){return el.text!==""}).length>0}},{key:"regionHasHelpLinks",value:function regionHasHelpLinks(helps){return helps.helpLinks.filter(function(el){return el.url!==""}).length>0}},{key:"regionHasPlayHelps",value:function regionHasPlayHelps(helps){return helps.loop||helps.backward||helps.rate||helps.helpRegionUuid!==""}},{key:"createGuid",value:function createGuid(){var uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c==="x"?r:r&3|8;return v.toString(16)});return uuid.toUpperCase()}},{key:"removeHtml",value:function removeHtml(string){return string.replace(/<[^>]+>/g,"")}}]);return RegionsService}();exports.default=RegionsService},1733:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var UserService=function(){function UserService($http,$q,url){(0,_classCallCheck3.default)(this,UserService);this.$http=$http;this.$q=$q;this.url=url}(0,_createClass3.default)(UserService,[{key:"getConnectedUser",value:function getConnectedUser(){var deferred=this.$q.defer();this.$http.get(this.url("api_get_connected_user",{})).success(function onSuccess(response){deferred.resolve(response)}.bind(this)).error(function onError(response){deferred.reject(response)});return deferred.promise}},{key:"connectedUserIsAdmin",value:function connectedUserIsAdmin(user){return user.roles&&user.roles.length>0&&user.roles.find(function(el){return el.name==="ROLE_ADMIN"})!==undefined}}]);return UserService}();exports.default=UserService},1734:function(module,exports,__webpack_require__){"use strict";var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);__webpack_require__(5);__webpack_require__(90);var _HelpModalService=__webpack_require__(1735);var _HelpModalService2=_interopRequireDefault(_HelpModalService);var _OptionsModalService=__webpack_require__(1737);var _OptionsModalService2=_interopRequireDefault(_OptionsModalService);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_index2.default.module("Modals",["ui.bootstrap","ui.html-truster"]).service("helpModalService",["$uibModal","regionsService","configService",_HelpModalService2.default]).service("optionsModalService",["$uibModal","regionsService",_OptionsModalService2.default])},1735:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getIterator2=__webpack_require__(557);var _getIterator3=_interopRequireDefault(_getIterator2);var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _helpModal=__webpack_require__(1736);var _helpModal2=_interopRequireDefault(_helpModal);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HelpModalService=function(){function HelpModalService($uibModal,regionsService,configService){(0,_classCallCheck3.default)(this,HelpModalService);this.uibModal=$uibModal;this.regionsService=regionsService;this.configService=configService;this.dialogOpts={template:_helpModal2.default,bindToController:true,controllerAs:"modalCtrl",controller:["$uibModalInstance","data","regionsService","configService",function($uibModalInstance,data,regionsService,configService){this.modalInstance=$uibModalInstance;this.data=data;this.selected=this.data.current;this.regionsService=regionsService;this.configService=configService;this.playModes=configService.getHelPlayModes();this.audioSrc=this.data.audioSrc;this.playing=false;this.audio=new Audio;this.currentMode=this.playModes.NORMAL;this.audio.addEventListener("pause",function(){if(this.audio.loop){this.play(null,this.playModes.LOOP)}else{this.playing=false}}.bind(this));this.close=function(){if(this.playing){this.audio.pause();this.playing=false}this.modalInstance.dismiss("cancel")};this.hasHelp=function(){return regionsService.regionHasHelp(this.selected.helps)};this.hasHelpTexts=function(){return regionsService.regionHasHelpTexts(this.selected.helps)};this.hasHelpLinks=function(){return regionsService.regionHasHelpLinks(this.selected.helps)};this.hasPlayHelps=function(){return regionsService.regionHasPlayHelps(this.selected.helps)};this.play=function($event,mode){if(mode!==this.currentMode&&$event&&this.playing){this.audio.pause();this.playing=false}if(this.playing&&$event){if(this.audio.loop){this.audio.loop=false}this.audio.pause()}else if(this.playing){this.audio.currentTime=this.selected.start;this.audio.play()}else{var paramString="#t=";if(mode===this.playModes.RELATED){var uuid=this.selected.helps.helpRegionUuid;var related=regionsService.getRegionByUuid(uuid,this.data.regions);paramString+=related.start+","+related.end}else{paramString+=this.selected.start+","+this.selected.end}this.audio.src=this.audioSrc+paramString;this.audio.loop=mode===this.playModes.LOOP;this.audio.playbackRate=mode===this.playModes.SLOW?.8:1;this.audio.play();this.playing=true;this.currentMode=mode}};this.playBackward=function(){if(this.playing){this.audio.pause();this.playing=false}if(window.SpeechSynthesisUtterance!==undefined){var text=this.regionsService.removeHtml(this.selected.note);var textArray=text.split(" ");var startIndex=textArray.length-1;if(!window.speechSynthesis.speaking){this.handleUtterancePlayback(startIndex,textArray)}}};this.sayIt=function(text,callback){var utterance=new SpeechSynthesisUtterance;utterance.text=text;var voices=window.speechSynthesis.getVoices();if(voices.length===0){window.setTimeout(function(){voices=window.speechSynthesis.getVoices();this.continueToSay(utterance,voices,this.data.lang,callback)}.bind(this),200)}else{this.continueToSay(utterance,voices,this.data.lang,callback)}};this.continueToSay=function(utterance,voices,lang,callback){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=(0,_getIterator3.default)(voices),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var voice=_step.value;var fxLang=lang.split("-")[0];if(voice.lang===lang||voice.lang===fxLang){utterance.voice=voice}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}window.speechSynthesis.speak(utterance);utterance.onend=function(){return callback()}};this.handleUtterancePlayback=function(index,textArray){var toSay="";var length=textArray.length;for(var j=index;j<length;j++){toSay+=textArray[j]+" "}if(index>=0){this.sayIt(toSay,function(){index=index-1;this.handleUtterancePlayback(index,textArray)}.bind(this))}};this.showHelpText=function($event,text){var target=$event.target;target.innerHTML="";target.textContent=text;target.disabled=true}}],resolve:{data:function(){return this.data}.bind(this),regionsService:function(){return this.regionsService}.bind(this),configService:function(){return this.configService}.bind(this)}}}(0,_createClass3.default)(HelpModalService,[{key:"setData",value:function setData(current,previous,regions,audioSrc,lang,minimal){this.data={current:current,previous:previous,regions:regions,audioSrc:audioSrc,lang:lang,minimal:minimal}}},{key:"open",value:function open(){this.uibModal.open(this.dialogOpts)}}]);return HelpModalService}();exports.default=HelpModalService},1736:function(module,exports){module.exports='<div class="modal-header">\n    <button type="button" class="close" data-ng-click="modalCtrl.close()">\n        <span aria-hidden="true">&times;</span>\n    </button>\n    <h4 class="modal-title">{{\'region_help\' | trans:{}:\'media_resource\'}}</h4>\n</div>\n<div class="modal-body">\n    <!-- full help modal -->\n    <div data-ng-if="!modalCtrl.data.minimal" id="help-tab-panel" role="tabpanel">\n        <ul class="nav nav-tabs" role="tablist">\n            <li role="presentation" class="active">\n                <a href="#help-region-choice" aria-controls="help-region-choice" role="tab" data-toggle="tab">{{\'help_modal_choice_tab_label\' | trans:{}:\'media_resource\'}}</a>\n            </li>\n            <li role="presentation">\n                <a href="#region-help-available" aria-controls="region-help-available" role="tab" data-toggle="tab">{{\'help_modal_help_tab_label\' | trans:{}:\'media_resource\'}}</a>\n            </li>\n        </ul>\n        <div class="tab-content">\n            <div role="tabpanel" class="tab-pane active margin-top-lg" id="help-region-choice">\n                <div class="row">\n                    <div class="col-md-12 text-center" data-ng-bind-html="\'help_modal_intro\' | trans:{}:\'media_resource\' | trust_html"></div>\n                </div>\n                <hr>\n                <div class="row full-height-row">\n                    <div class="col-xs-10 full-height-col">\n                        <div class="row">\n                            <div class="col-md-12">\n                                <div class="input-group input-group-lg">\n                                    <span class="input-group-addon">\n                                        <input type="radio" data-ng-model="modalCtrl.selected" data-ng-value="modalCtrl.data.current" name="segment">\n                                    </span>\n                                    <input type="text" class="form-control" disabled placeholder="{{\'current_segment\'| trans:{}:\'media_resource\'}}">\n                                </div>\n                            </div>\n                        </div>\n                        <div data-ng-if="modalCtrl.data.previous">\n                            <hr>\n                            <div class="row">\n                                <div class="col-md-12">\n                                    <div class="input-group input-group-lg">\n                                        <span class="input-group-addon">\n                                            <input type="radio" data-ng-model="modalCtrl.selected" data-ng-value="modalCtrl.data.previous" name="segment">\n                                        </span>\n                                        <input type="text" class="form-control" disabled placeholder="{{\'previous_segment\'| trans:{}:\'media_resource\'}}">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-xs-2 full-height-col">\n                        <button class="btn btn-default" data-ng-click="modalCtrl.play(modalCtrl.playModes.NORMAL)" title="{{\'region_help_segment_playback\' | trans:{}:\'media_resource\'}}">\n                            <i class="fa fa-play"></i>\n                            /\n                            <i class="fa fa-pause"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <div role="tabpanel" class="tab-pane margin-top-lg" id="region-help-available">\n                <div data-ng-if="modalCtrl.hasHelp()">\n                    <div data-ng-if="modalCtrl.hasPlayHelps()">\n                        <div class="row">\n                            <div class="col-md-12">\n                                <div class="btn-group">\n                                    <!-- if help.loop -->\n                                    <button data-ng-if="modalCtrl.selected.helps.loop" data-ng-click="modalCtrl.play($event, modalCtrl.playModes.LOOP)" class="btn btn-default" title="{{\'region_help_segment_playback_loop\' | trans:{}:\'media_resource\'}}">\n                                        <i class="fa fa-retweet"></i>\n                                    </button>\n                                    <!-- if help.backward -->\n                                    <button data-ng-if="modalCtrl.selected.helps.backward" data-ng-click="modalCtrl.playBackward()" class="btn btn-default" title="{{\'region_help_segment_playback_backward\' | trans:{}:\'media_resource\'}}">\n                                        <i class="fa fa-exchange"></i>\n                                    </button>\n                                    <!-- if help.rate -->\n                                    <button data-ng-if="modalCtrl.selected.helps.rate" data-ng-click="modalCtrl.play($event, modalCtrl.playModes.SLOW)" class="btn btn-default" title="{{\'region_help_segment_playback_rate\' | trans:{}:\'media_resource\'}}">\n                                        x0.8\n                                    </button>\n                                    <!-- if (help.connex && help.connex.start && help.connex.end) -->\n                                    <button data-ng-if="modalCtrl.selected.helps.helpRegionUuid !== \'\'" data-ng-click="modalCtrl.play($event, modalCtrl.playModes.RELATED)" class="btn btn-default" title="{{\'region_help_related_segment_playback\' | trans:{}:\'media_resource\'}}">\n                                        <i class="fa fa-play"></i>\n                                        /\n                                        <i class="fa fa-pause"></i>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- if helptexts -->\n                    <div data-ng-if="modalCtrl.hasHelpTexts()">\n                        <hr>\n                        <div class="row">\n                            <div class="col-md-4">\n                                {{\'region_config_help_texts\' | trans:{}:\'media_resource\'}}\n                            </div>\n                            <div class="col-md-8">\n                                <div class="btn-group">\n                                    <button\n                                        class="btn btn-default"\n                                        title="{{\'region_help_help_text_label\'|trans:{}:\'media_resource\'}} {{$index + 1}}"\n                                        data-ng-if="item.text !== \'\'"\n                                        data-ng-click="modalCtrl.showHelpText($event, item.text)"\n                                        data-ng-repeat="item in modalCtrl.selected.helps.helpTexts">\n                                        <i class="fa fa-eye"></i>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- if helplinks -->\n                    <div data-ng-if="modalCtrl.hasHelpLinks()">\n                        <hr>\n                        <div class="row">\n                            <div class="col-md-4">\n                                {{\'region_help_help_links_label\' | trans:{}:\'media_resource\'}}\n                            </div>\n                            <div class="col-md-8">\n                                <div class="btn-group">\n                                    <a class="btn btn-default fa fa-link" data-ng-if="item.url !== \'\'" data-ng-repeat="item in modalCtrl.selected.helps.helpLinks" title="{{\'region_help_help_link_label\' | trans:{}:\'media_resource\'}} {{$index + 1}}" target="_blank" href="{{item.url}}"></a>\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n                <!-- No help available -->\n                <div data-ng-if="!modalCtrl.hasHelp()">\n                    <div class="row">\n                        <div class="col-md-12">\n                            <h4>{{\'region_help_no_help_available\' | trans:{}:\'media_resource\'}}</h4>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- minimal help modal -->\n    <div data-ng-if="modalCtrl.data.minimal">\n        <div class="row">\n            <div class="col-md-12">\n                <div class="btn-group">\n                    <button class="btn btn-default" data-ng-click="modalCtrl.play(modalCtrl.playModes.NORMAL)" title="{{\'region_help_segment_playback\' | trans:{}:\'media_resource\'}}">\n                        <i class="fa fa-play"></i>\n                        /\n                        <i class="fa fa-pause"></i>\n                    </button>\n                    <button data-ng-click="modalCtrl.play($event, modalCtrl.playModes.LOOP)" class="btn btn-default" title="{{\'region_help_segment_playback_loop\' | trans:{}:\'media_resource\'}}">\n                        <i class="fa fa-retweet"></i>\n                    </button>\n                    <button data-ng-click="modalCtrl.play($event, modalCtrl.playModes.SLOW)" class="btn btn-default" title="{{\'region_help_segment_playback_rate\' | trans:{}:\'media_resource\'}}">\n                        x0.8\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-click="modalCtrl.close()">{{\'close\' | trans:{}:\'media_resource\'}}</button>\n</div>\n'},1737:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _optionsModal=__webpack_require__(1738);var _optionsModal2=_interopRequireDefault(_optionsModal);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var OptionsModalService=function(){function OptionsModalService($uibModal,regionsService){(0,_classCallCheck3.default)(this,OptionsModalService);this.uibModal=$uibModal;this.regionsService=regionsService;this.dialogOpts={template:_optionsModal2.default,bindToController:true,controllerAs:"modalCtrl",controller:["$uibModalInstance","current","regions","audioSrc","regionsService",function($uibModalInstance,current,regions,audioSrc,regionsService){this.current=current;this.selected=this.current.helps.helpRegionUuid;this.regions=regions;this.audioSrc=audioSrc;this.playing=false;this.audio=new Audio;this.audio.addEventListener("pause",function(){this.playing=false});this.close=function(){$uibModalInstance.dismiss("cancel")};this.updateRelatedRegion=function(){if(this.selected!==""){this.current.helps.helpRegionUuid=this.selected}};this.play=function(){var related=regionsService.getRegionByUuid(this.current.helps.helpRegionUuid,this.regions);var paramString="";if(related){paramString="#t="+related.start+","+related.end}this.audio.src=this.audioSrc+paramString;if(this.playing){this.audio.pause();
this.playing=false}else{this.audio.play();this.playing=true}}}],resolve:{current:function(){return this.current}.bind(this),regions:function(){return this.regions}.bind(this),audioSrc:function(){return this.audioSrc}.bind(this),regionsService:function(){return this.regionsService}.bind(this)}}}(0,_createClass3.default)(OptionsModalService,[{key:"setData",value:function setData(current,regions,audioSrc){this.current=current;this.regions=regions;this.audioSrc=audioSrc}},{key:"open",value:function open(){this.uibModal.open(this.dialogOpts)}}]);return OptionsModalService}();exports.default=OptionsModalService},1738:function(module,exports){module.exports='<div class="modal-header">\n    <button type="button" class="close" data-ng-click="modalCtrl.close()">\n        <span aria-hidden="true">&times;</span>\n    </button>\n    <h4 class="modal-title">{{\'dialog_region_configure\' | trans:{}:\'media_resource\'}}</h4>\n</div>\n<div class="modal-body">\n    <div class="row">\n        <div class="col-md-12">\n            <div class="form-horizontal">\n                <div class="checkbox">\n                    <label>\n                        <input type="checkbox" data-ng-model="modalCtrl.current.helps.loop" name="loop" value="loop">\n                        {{\'region_config_allow_loop\' | trans:{}:\'media_resource\'}}\n                    </label>\n                </div>\n                <div class="checkbox">\n                    <label>\n                        <input type="checkbox" data-ng-model="modalCtrl.current.helps.backward" name="backward" value="backward">\n                        {{\'region_config_allow_bwb\' | trans:{}:\'media_resource\'}}\n                    </label>\n                </div>\n                <div class="checkbox">\n                    <label>\n                        <input type="checkbox" data-ng-model="modalCtrl.current.helps.rate" name="rate" value="rate">\n                        {{\'region_config_allow_rate\' | trans:{}:\'media_resource\'}}\n                    </label>\n                </div>\n                <hr>\n                <div class="row">\n                    <div class="col-md-12">\n                        <h4>{{\'region_config_help_texts\' | trans:{}:\'media_resource\'}}</h4>\n                        <div data-ng-repeat="item in modalCtrl.current.helps.helpTexts">\n                          <label for="text_{{$index}}">{{\'region_config_help_text\' | trans:{}:\'media_resource\'}}{{$index + 1}}</label>\n                          <input\n                              id="text_{{$index}}"\n                              type="text"\n                              placeholder="{{\'region_config_help_texts_placeholder\' | trans:{}:\'media_resource\'}}"\n                              class="form-control margin-bottom-sx" data-ng-model="item.text">\n                        </div>\n                    </div>\n                </div>\n                <hr>\n                <div class="row">\n                    <div class="col-md-12">\n                        <h4>{{\'region_config_help_links\' | trans:{}:\'media_resource\'}}\n                            &nbsp;\n                            <small>{{\'region_config_help_links_small\' | trans:{}:\'media_resource\'}}</small>\n                        </h4>\n                        <div data-ng-repeat="item in modalCtrl.current.helps.helpLinks">\n                          <label for="url_{{$index}}">{{\'region_config_help_link\' | trans:{}:\'media_resource\'}}{{$index + 1}}</label>\n                          <input\n                              id="url_{{$index}}"\n                              type="url"\n                              pattern="https?://.*"\n                              class="form-control margin-bottom-sx"\n                              data-ng-model="item.url"\n                              name="modal-help-links[]"\n                              placeholder="{{\'region_config_help_links_placeholder\' | trans:{}:\'media_resource\'}}">\n                        </div>\n\n                    </div>\n                </div>\n                <hr>\n                <h4>{{\'region_config_help_region_title\'|trans:{}:\'media_resource\'}}</h4>\n                <div class="row">\n                    <div class="col-md-10">\n                        <select class="form-control" id="select-help-related-region" data-ng-model="modalCtrl.selected" data-ng-change="modalCtrl.updateRelatedRegion()">\n                            <option value="">{{\'none\' |trans:{}:\'media_resource\'}}</option>\n                            <option value="{{item.uuid}}" data-ng-selected="{{current.helps.helpRegionUuid == item.uuid}}" data-ng-if="item.uuid !== current.uuid" data-ng-repeat="item in modalCtrl.regions">\n                                {{item.start | secondsToHms}}\n                                -\n                                {{item.end | secondsToHms}}\n                            </option>\n                        </select>\n                    </div>\n                    <div class="col-md-2">\n                        <button data-ng-disabled="modalCtrl.selected === \'\'" class="btn btn-default" data-ng-click="modalCtrl.play()" role="button" type="button" id="btn-help-related-region-play">\n                            <i class="fa fa-play"></i>\n                            /\n                            <i class="fa fa-pause"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-click="modalCtrl.close()">{{\'close\' | trans:{}:\'media_resource\'}}</button>\n</div>\n'},1739:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getIterator2=__webpack_require__(557);var _getIterator3=_interopRequireDefault(_getIterator2);var _create=__webpack_require__(169);var _create2=_interopRequireDefault(_create);var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _wavesurfer=__webpack_require__(1740);var _wavesurfer2=_interopRequireDefault(_wavesurfer);__webpack_require__(1741);__webpack_require__(1742);__webpack_require__(1743);var _jquery=__webpack_require__(123);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdminCtrl=function(){function AdminCtrl($scope,$window,$filter,url,configService,helpModalService,optionsModalService,regionsService,AdminService){(0,_classCallCheck3.default)(this,AdminCtrl);this.wavesurfer=(0,_create2.default)(_wavesurfer2.default);this.popoverTranscriptionTplUrl="popover.transcription.html";this.popoverPlayersTplUrl="popover.players.html";this.filter=$filter;this.configService=configService;this.urlService=url;this.helpModalService=helpModalService;this.optionsModalService=optionsModalService;this.regionsService=regionsService;this.adminService=AdminService;this.markers=[];this.setSharedData();this.initWavesurfer();this.initContentEditable();this.playing=false;this.httpSuccess=false;this.httpError=false;this.$window=$window;this.$scope=$scope;this.currentRegion=null;if(this.resource.regions.length>0){this.currentRegion=this.resource.regions[0]}}(0,_createClass3.default)(AdminCtrl,[{key:"setSharedData",value:function setSharedData(){this.options=this.configService.getWavesurferOptions();this.langs=this.configService.getAvailableTTSLanguage();this.modes=this.configService.getAvailablePlayModes()}},{key:"initWavesurfer",value:function initWavesurfer(){var progressDiv=document.querySelector("#progress-bar");var progressBar=progressDiv.querySelector(".progress-bar");var showProgress=function showProgress(percent){progressDiv.style.display="block";progressBar.style.width=percent+"%"};var hideProgress=function hideProgress(){progressDiv.style.display="none"};this.wavesurfer.on("loading",showProgress);this.wavesurfer.on("ready",hideProgress);this.wavesurfer.on("destroy",hideProgress);this.wavesurfer.on("error",hideProgress);this.wavesurfer.init(this.options);this.wavesurfer.initMinimap({height:30,waveColor:"#ddd",progressColor:"#999",cursorColor:"#999"});this.audioData=this.urlService("innova_get_mediaresource_resource_file",{workspaceId:this.resource.workspaceId,id:this.resource.id});this.wavesurfer.load(this.audioData);this.wavesurfer.on("ready",function(){var timeline=(0,_create2.default)(_wavesurfer2.default.Timeline);timeline.init({wavesurfer:this.wavesurfer,container:"#wave-timeline"});this.initRegionsAndMarkers();this.highlightWaveform();this.highligthRegionRow(this.currentRegion)}.bind(this));this.wavesurfer.on("seek",function(){var current=this.regionsService.getRegionFromTime(this.wavesurfer.getCurrentTime(),this.resource.regions);if(current&&this.currentRegion&&current.uuid!=this.currentRegion.uuid){this.currentRegion=current;this.highlightWaveform();this.highligthRegionRow(this.currentRegion)}}.bind(this));this.wavesurfer.on("audioprocess",function(){var current=this.regionsService.getRegionFromTime(this.wavesurfer.getCurrentTime(),this.resource.regions);if(current&&this.currentRegion&&current.uuid!=this.currentRegion.uuid){this.currentRegion=current;this.highlightWaveform();this.highligthRegionRow(this.currentRegion)}}.bind(this))}},{key:"initRegionsAndMarkers",value:function initRegionsAndMarkers(){var _this=this;if(this.resource.regions.length===0){(function(){var region=_this.regionsService.create(0,_this.wavesurfer.getDuration());_this.$scope.$apply(function(){this.resource.regions.push(region);this.currentRegion=region}.bind(_this))})()}else{var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=(0,_getIterator3.default)(this.resource.regions),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _region=_step.value;if(Number(_region.start)>0){this.addMarker(_region.start,_region.uuid)}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}}},{key:"optionsModeChanged",value:function optionsModeChanged(){if(this.resource.options.mode!=="free"){this.resource.options.showTextTranscription=false}}},{key:"addMarker",value:function addMarker(time,uuid){var $canvas=(0,_jquery2.default)("#waveform").find("wave").first().find("canvas").first();var cHeight=$canvas.height();var left=this.getMarkerLeftPostionFromTime(time);var markerWidth=1;var dragHandlerBorderSize=1;var dragHandlerSize=18;var dragHandlerTop=cHeight/2-dragHandlerSize/2;var dragHandlerLeft=dragHandlerBorderSize-dragHandlerSize/2;var marker=document.createElement("div");marker.className="divide-marker";marker.style.left=left+"px";marker.style.width=markerWidth+"px";marker.dataset.time=time;var dragHandler=document.createElement("div");dragHandler.className="marker-drag-handler";dragHandler.style.border=dragHandlerBorderSize+"px solid white";dragHandler.style.width=dragHandlerSize+"px";dragHandler.style.height=dragHandlerSize+"px";dragHandler.style.top=dragHandlerTop+"px";dragHandler.style.left=dragHandlerLeft+"px";dragHandler.title=this.filter("trans")("marker_drag_title",{},"media_resource");var guid=uuid||this.regionsService.createGuid();dragHandler.dataset.uuid=guid;marker.appendChild(dragHandler);(0,_jquery2.default)("#waveform").find("wave").first().append(marker);var dragData=void 0;dragHandler.addEventListener("mousedown",function(event){var time=this.getTimeFromPosition((0,_jquery2.default)(event.target).closest(".divide-marker").position().left);dragData=this.setDragData(time,marker);this.$window.addEventListener("mousemove",moveMarker);this.$window.addEventListener("mouseup",dropMarker)}.bind(this));var moveMarker=function moveMarker(event){var rect=document.getElementById("waveform").getBoundingClientRect();var left=event.pageX-rect.left-this.$window.pageXOffset;var time=this.getTimeFromPosition(left);if(left>rect.left&&left<rect.right&&dragData.minTime<time&&dragData.maxTime>time){var position=this.getMarkerLeftPostionFromTime(time);dragData.marker.style.left=position+"px";if(dragData.prevRegion){dragData.prevRegion.end=Number(time)}if(dragData.nextRegion){dragData.nextRegion.start=Number(time)}dragData.marker.dataset.time=time;dragData.markerO.time=time;var current=this.regionsService.getRegionFromTime(time,this.resource.regions);this.wavesurfer.clearRegions();this.wavesurfer.addRegion({start:current.start,end:current.end,color:"rgba(255,0,0,0.5)",drag:false,resize:false})}else{return false}}.bind(this);var dropMarker=function dropMarker(){this.$window.removeEventListener("mousemove",moveMarker);this.$window.removeEventListener("mouseup",dropMarker);this.$scope.$apply(function(){dragData.prevRegion.end=Number(dragData.marker.dataset.time);dragData.nextRegion.start=Number(dragData.marker.dataset.time)})}.bind(this);var mark={time:Number(time),uuid:guid};this.markers.push(mark);return mark}},{key:"setDragData",value:function setDragData(time,marker){var data={};var tolerance=1;var prevRegion=this.regionsService.getPrevRegion(time+.01,this.resource.regions);var nextRegion=this.regionsService.getNextRegion(time-.01,this.resource.regions);var min=prevRegion&&prevRegion.start?prevRegion.start:0;var max=nextRegion&&nextRegion.end?nextRegion.end:this.wavesurfer.getDuration();var markerObject=void 0;var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=(0,_getIterator3.default)(this.markers),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var mark=_step2.value;if(mark.time.toFixed(2)===time.toFixed(2)){markerObject=mark}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}data={minTime:min+tolerance,maxTime:max-tolerance,prevRegion:prevRegion,nextRegion:nextRegion,marker:marker,markerO:markerObject};return data}},{key:"getMarkerLeftPostionFromTime",value:function getMarkerLeftPostionFromTime(time){var duration=this.wavesurfer.getDuration();var $canvas=(0,_jquery2.default)("#waveform").find("wave").first().find("canvas").first();var cWidth=$canvas.width();return time*cWidth/duration}},{key:"getTimeFromPosition",value:function getTimeFromPosition(position){var duration=this.wavesurfer.getDuration();var $canvas=(0,_jquery2.default)("#waveform").find("wave").first().find("canvas").first();var cWidth=$canvas.width();return position*duration/cWidth}},{key:"highlightWaveform",value:function highlightWaveform(){this.wavesurfer.clearRegions();var params={start:this.currentRegion.start,end:this.currentRegion.end,color:"rgba(255,0,0,0.5)",drag:false,resize:false};this.wavesurfer.addRegion(params)}},{key:"highligthRegionRow",value:function highligthRegionRow(region){var row=this.getRegionRow(region);(0,_jquery2.default)(".active-row").each(function(){(0,_jquery2.default)(this).removeClass("active-row")});(0,_jquery2.default)(row).closest(".region").addClass("active-row")}},{key:"getRegionRow",value:function getRegionRow(region){var row;(0,_jquery2.default)(".region").each(function(){var temp=(0,_jquery2.default)(this);if((0,_jquery2.default)(this).attr("data-uuid")===region.uuid){row=temp}});return row}},{key:"configureRegionHelps",value:function configureRegionHelps(region){this.optionsModalService.setData(region,this.resource.regions,this.audioData);this.optionsModalService.open()}},{key:"deleteRegion",value:function deleteRegion(region){this.removeMeFromHelp(region);if(region.start===0){var next=this.regionsService.getNextRegion(region.end-.1,this.resource.regions);if(next){next.start=0;this.currentRegion=next}}else{var previous=this.regionsService.getPrevRegion(region.start+.1,this.resource.regions);if(previous){previous.end=region.end;this.currentRegion=previous}}(0,_jquery2.default)(".marker-drag-handler").each(function(){var $marker=(0,_jquery2.default)(this).closest(".divide-marker");var time=Number($marker.attr("data-time"));if(region.start>0&&time===region.start){$marker.remove()}else if(region.start===0&&time===region.end){$marker.remove()}});var index=this.resource.regions.indexOf(region);this.resource.regions.splice(index,1);var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=(0,_getIterator3.default)(this.markers),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var marker=_step3.value;if(marker.time===region.start){var i=this.markers.indexOf(marker);this.markers.splice(i,1)}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}this.highlightWaveform();this.highligthRegionRow(this.currentRegion)}},{key:"hasHelp",value:function hasHelp(helps){return this.regionsService.regionHasHelp(helps)}},{key:"removeMeFromHelp",value:function removeMeFromHelp(region){var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=(0,_getIterator3.default)(this.resource.regions),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var r=_step4.value;if(r.helps.helpRegionUuid!==""&&r.helps.helpRegionUuid===region.uuid){r.helps.helpRegionUuid=""}}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}}},{key:"play",value:function play(){if(!this.playing){this.wavesurfer.play();this.playing=true}else{this.wavesurfer.pause();this.playing=false}}},{key:"playRegion",value:function playRegion(region){var wRegion=this.wavesurfer.addRegion({start:region?region.start:this.currentRegion.start,end:region?region.end:this.currentRegion.end,color:"rgba(0,0,0,0)",drag:false,resize:false});if(!this.playing){wRegion.play();this.playing=true;this.wavesurfer.once("pause",function(){this.playing=false}.bind(this))}else{this.wavesurfer.pause();this.playing=false}}},{key:"goTo",value:function goTo(time){var percent=time/this.wavesurfer.getDuration();this.wavesurfer.seekAndCenter(percent);if(this.playing||this.wavesurfer.isPlaying()){this.wavesurfer.pause();this.playing=false}}},{key:"createRegion",value:function createRegion(time){var toSplit=this.regionsService.getRegionFromTime(time,this.resource.regions);var region=this.regionsService.create(time,toSplit.end);toSplit.end=time;this.resource.regions.push(region);this.currentRegion=region;this.highlightWaveform();window.setTimeout(function(){this.highligthRegionRow(this.currentRegion)}.bind(this),100)}},{key:"backward",value:function backward(){if(this.resource.regions.length>1){var prev=void 0;if(this.currentRegion.start>0){prev=this.regionsService.getPrevRegion(this.wavesurfer.getCurrentTime()+.01,this.resource.regions);this.goTo(prev.start)}else{this.wavesurfer.seekAndCenter(0)}}else{this.wavesurfer.seekAndCenter(0)}}},{key:"forward",value:function forward(){if(this.resource.regions.length>1){var next=void 0;if(this.currentRegion.end<this.wavesurfer.getDuration().toFixed(2)){next=this.regionsService.getNextRegion(this.wavesurfer.getCurrentTime(),this.resource.regions);this.goTo(next.start)}}}},{key:"mark",value:function mark(){var time=this.wavesurfer.getCurrentTime();if(time>0){var mark=this.addMarker(time);this.createRegion(mark.time)}}},{key:"help",value:function help(){var previous=null;if(this.currentRegion.start>0){var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=(0,_getIterator3.default)(this.resource.regions),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var region=_step5.value;if(region.end===this.currentRegion.start){previous=region}}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally{try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally{if(_didIteratorError5){throw _iteratorError5}}}}if(this.playing){if(this.wavesurfer.isPlaying()){this.wavesurfer.pause()}this.playing=false}this.helpModalService.setData(this.currentRegion,previous,this.resource.regions,this.audioData,this.resource.options.lang,false);this.helpModalService.open()}},{key:"initContentEditable",value:function initContentEditable(){(0,_jquery2.default)("body").on("focus","[contenteditable]",function(event){var $input=(0,_jquery2.default)(event.target);$input.data("before",$input.html());var start=$input.closest(".region").find(".start").attr("data-start");this.goTo(start);return $input}.bind(this)).on("blur keypress keyup paste input","[contenteditable]",function(e){var $input=(0,_jquery2.default)(this);if(e.type==="keypress"&&e.which===13){return false}if($input.data("before")!==$input.html()){$input.data("before",$input.html());$input.trigger("change")}return $input})}},{key:"annotate",value:function annotate(color){var selection=window.getSelection();document.execCommand("insertHTML",false,'<span class="accent-'+color+'">'+selection.toString()+"</span>")}},{key:"zip",value:function zip(){this.adminService.zip(this.resource).then(function onSuccess(response){var a=document.createElement("a");a.style.display="none";var blob=new Blob([response]);var url=URL.createObjectURL(blob);a.href=url;a.download=this.resource.name+".zip";document.body.appendChild(a);a.click();setTimeout(function(){document.body.removeChild(a);window.URL.revokeObjectURL(url)},100)}.bind(this),function onError(){this.httpSuccess=false;this.httpError=true}.bind(this))}},{key:"togglePanel",value:function togglePanel($event){(0,_jquery2.default)($event.target).closest(".panel").find(".panel-body").toggle();(0,_jquery2.default)($event.target).hasClass("fa-chevron-down")?(0,_jquery2.default)($event.target).removeClass("fa-chevron-down").addClass("fa-chevron-up"):(0,_jquery2.default)($event.target).removeClass("fa-chevron-up").addClass("fa-chevron-down")}},{key:"save",value:function save(){var my=this;(0,_jquery2.default)(".region").each(function(){var note=(0,_jquery2.default)(this).find("[contenteditable]").html();var uuid=(0,_jquery2.default)(this).attr("data-uuid");var region=my.regionsService.getRegionByUuid(uuid,my.resource.regions);region.note=note});this.adminService.save(this.resource).then(function onSuccess(){this.httpError=false;this.httpSuccess=true}.bind(this),function onError(){this.httpSuccess=false;this.httpError=true}.bind(this))}}]);return AdminCtrl}();AdminCtrl.$inject=["$scope","$window","$filter","url","configService","helpModalService","optionsModalService","regionsService","AdminService"];exports.default=AdminCtrl},1740:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(root,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return root["WaveSurfer"]=factory()}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports==="object"){module.exports=factory()}else{root["WaveSurfer"]=factory()}})(this,function(){"use strict";var WaveSurfer={defaultParams:{height:128,waveColor:"#999",progressColor:"#555",cursorColor:"#333",cursorWidth:1,skipLength:2,minPxPerSec:20,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,fillParent:true,scrollParent:false,hideScrollbar:false,normalize:false,audioContext:null,container:null,dragSelection:true,loopSelection:true,audioRate:1,interact:true,splitChannels:false,mediaContainer:null,mediaControls:false,renderer:"Canvas",backend:"WebAudio",mediaType:"audio",autoCenter:true},init:function(params){this.params=WaveSurfer.util.extend({},this.defaultParams,params);this.container="string"==typeof params.container?document.querySelector(this.params.container):this.params.container;if(!this.container){throw new Error("Container element not found")}if(this.params.mediaContainer==null){this.mediaContainer=this.container}else if(typeof this.params.mediaContainer=="string"){this.mediaContainer=document.querySelector(this.params.mediaContainer)}else{this.mediaContainer=this.params.mediaContainer}if(!this.mediaContainer){throw new Error("Media Container element not found")}this.savedVolume=0;this.isMuted=false;this.tmpEvents=[];this.currentAjax=null;this.createDrawer();this.createBackend()},createDrawer:function(){var my=this;this.drawer=Object.create(WaveSurfer.Drawer[this.params.renderer]);this.drawer.init(this.container,this.params);this.drawer.on("redraw",function(){my.drawBuffer();my.drawer.progress(my.backend.getPlayedPercents())});this.drawer.on("click",function(e,progress){setTimeout(function(){my.seekTo(progress)},0)});this.drawer.on("scroll",function(e){my.fireEvent("scroll",e)})},createBackend:function(){var my=this;if(this.backend){this.backend.destroy()}if(this.params.backend=="AudioElement"){this.params.backend="MediaElement"}if(this.params.backend=="WebAudio"&&!WaveSurfer.WebAudio.supportsWebAudio()){this.params.backend="MediaElement"}this.backend=Object.create(WaveSurfer[this.params.backend]);this.backend.init(this.params);this.backend.on("finish",function(){my.fireEvent("finish")});this.backend.on("play",function(){my.fireEvent("play")});this.backend.on("pause",function(){my.fireEvent("pause")});this.backend.on("audioprocess",function(time){my.drawer.progress(my.backend.getPlayedPercents());my.fireEvent("audioprocess",time)})},getDuration:function(){return this.backend.getDuration()},getCurrentTime:function(){return this.backend.getCurrentTime()},play:function(start,end){this.fireEvent("interaction",this.play.bind(this,start,end));this.backend.play(start,end)},pause:function(){this.backend.pause()},playPause:function(){this.backend.isPaused()?this.play():this.pause()},isPlaying:function(){return!this.backend.isPaused()},skipBackward:function(seconds){this.skip(-seconds||-this.params.skipLength)},skipForward:function(seconds){this.skip(seconds||this.params.skipLength)},skip:function(offset){var position=this.getCurrentTime()||0;var duration=this.getDuration()||1;position=Math.max(0,Math.min(duration,position+(offset||0)));this.seekAndCenter(position/duration)},seekAndCenter:function(progress){this.seekTo(progress);this.drawer.recenter(progress)},seekTo:function(progress){this.fireEvent("interaction",this.seekTo.bind(this,progress));var paused=this.backend.isPaused();var oldScrollParent=this.params.scrollParent;if(paused){this.params.scrollParent=false}this.backend.seekTo(progress*this.getDuration());this.drawer.progress(this.backend.getPlayedPercents());if(!paused){this.backend.pause();this.backend.play()}this.params.scrollParent=oldScrollParent;this.fireEvent("seek",progress)},stop:function(){this.pause();this.seekTo(0);this.drawer.progress(0)},setVolume:function(newVolume){this.backend.setVolume(newVolume)},setPlaybackRate:function(rate){this.backend.setPlaybackRate(rate)},toggleMute:function(){if(this.isMuted){this.backend.setVolume(this.savedVolume);this.isMuted=false}else{this.savedVolume=this.backend.getVolume();this.backend.setVolume(0);this.isMuted=true}},toggleScroll:function(){this.params.scrollParent=!this.params.scrollParent;this.drawBuffer()},toggleInteraction:function(){this.params.interact=!this.params.interact},drawBuffer:function(){var nominalWidth=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio);var parentWidth=this.drawer.getWidth();var width=nominalWidth;if(this.params.fillParent&&(!this.params.scrollParent||nominalWidth<parentWidth)){width=parentWidth}var peaks=this.backend.getPeaks(width);this.drawer.drawPeaks(peaks,width);this.fireEvent("redraw",peaks,width)},zoom:function(pxPerSec){this.params.minPxPerSec=pxPerSec;this.params.scrollParent=true;this.drawBuffer();this.seekAndCenter(this.getCurrentTime()/this.getDuration());this.fireEvent("zoom",pxPerSec)},loadArrayBuffer:function(arraybuffer){this.decodeArrayBuffer(arraybuffer,function(data){this.loadDecodedBuffer(data)}.bind(this))},loadDecodedBuffer:function(buffer){this.backend.load(buffer);this.drawBuffer();this.fireEvent("ready")},loadBlob:function(blob){var my=this;var reader=new FileReader;reader.addEventListener("progress",function(e){my.onProgress(e)});reader.addEventListener("load",function(e){my.loadArrayBuffer(e.target.result)});reader.addEventListener("error",function(){my.fireEvent("error","Error reading file")});reader.readAsArrayBuffer(blob);this.empty()},load:function(url,peaks){this.empty();switch(this.params.backend){case"WebAudio":return this.loadBuffer(url,peaks);case"MediaElement":return this.loadMediaElement(url,peaks)}},loadBuffer:function(url,peaks){var load=function(action){if(action){this.tmpEvents.push(this.once("ready",action))}return this.getArrayBuffer(url,this.loadArrayBuffer.bind(this))}.bind(this);if(peaks){this.backend.setPeaks(peaks);this.drawBuffer();this.tmpEvents.push(this.once("interaction",load))}else{return load()}},loadMediaElement:function(urlOrElt,peaks){var url=urlOrElt;if(typeof urlOrElt==="string"){this.backend.load(url,this.mediaContainer,peaks)}else{var elt=urlOrElt;this.backend.loadElt(elt,peaks);url=elt.src}this.tmpEvents.push(this.backend.once("canplay",function(){this.drawBuffer();this.fireEvent("ready")}.bind(this)),this.backend.once("error",function(err){this.fireEvent("error",err)}.bind(this)));if(peaks){this.backend.setPeaks(peaks)}else if(this.backend.supportsWebAudio()){this.getArrayBuffer(url,function(arraybuffer){this.decodeArrayBuffer(arraybuffer,function(buffer){this.backend.buffer=buffer;this.drawBuffer()}.bind(this))}.bind(this))}},decodeArrayBuffer:function(arraybuffer,callback){this.arraybuffer=arraybuffer;this.backend.decodeArrayBuffer(arraybuffer,function(data){if(this.arraybuffer==arraybuffer){callback(data);this.arraybuffer=null}}.bind(this),this.fireEvent.bind(this,"error","Error decoding audiobuffer"))},getArrayBuffer:function(url,callback){var my=this;var ajax=WaveSurfer.util.ajax({url:url,responseType:"arraybuffer"});this.currentAjax=ajax;this.tmpEvents.push(ajax.on("progress",function(e){my.onProgress(e)}),ajax.on("success",function(data,e){callback(data);my.currentAjax=null}),ajax.on("error",function(e){my.fireEvent("error","XHR error: "+e.target.statusText);my.currentAjax=null}));return ajax},onProgress:function(e){if(e.lengthComputable){var percentComplete=e.loaded/e.total}else{percentComplete=e.loaded/(e.loaded+1e6)}this.fireEvent("loading",Math.round(percentComplete*100),e.target)},exportPCM:function(length,accuracy,noWindow){length=length||1024;accuracy=accuracy||1e4;noWindow=noWindow||false;var peaks=this.backend.getPeaks(length,accuracy);var arr=[].map.call(peaks,function(val){return Math.round(val*accuracy)/accuracy});var json=JSON.stringify(arr);if(!noWindow){window.open("data:application/json;charset=utf-8,"+encodeURIComponent(json))}return json},cancelAjax:function(){if(this.currentAjax){this.currentAjax.xhr.abort();this.currentAjax=null}},clearTmpEvents:function(){this.tmpEvents.forEach(function(e){e.un()})},empty:function(){if(!this.backend.isPaused()){this.stop();this.backend.disconnectSource()}this.cancelAjax();this.clearTmpEvents();this.drawer.progress(0);this.drawer.setWidth(0);this.drawer.drawPeaks({length:this.drawer.getWidth()},0)},destroy:function(){this.fireEvent("destroy");this.cancelAjax();this.clearTmpEvents();this.unAll();this.backend.destroy();this.drawer.destroy()}};WaveSurfer.create=function(params){var wavesurfer=Object.create(WaveSurfer);wavesurfer.init(params);return wavesurfer;
};WaveSurfer.util={extend:function(dest){var sources=Array.prototype.slice.call(arguments,1);sources.forEach(function(source){Object.keys(source).forEach(function(key){dest[key]=source[key]})});return dest},min:function(values){var min=+Infinity;for(var i in values){if(values[i]<min){min=values[i]}}return min},max:function(values){var max=-Infinity;for(var i in values){if(values[i]>max){max=values[i]}}return max},getId:function(){return"wavesurfer_"+Math.random().toString(32).substring(2)},ajax:function(options){var ajax=Object.create(WaveSurfer.Observer);var xhr=new XMLHttpRequest;var fired100=false;xhr.open(options.method||"GET",options.url,true);xhr.responseType=options.responseType||"json";xhr.addEventListener("progress",function(e){ajax.fireEvent("progress",e);if(e.lengthComputable&&e.loaded==e.total){fired100=true}});xhr.addEventListener("load",function(e){if(!fired100){ajax.fireEvent("progress",e)}ajax.fireEvent("load",e);if(200==xhr.status||206==xhr.status){ajax.fireEvent("success",xhr.response,e)}else{ajax.fireEvent("error",e)}});xhr.addEventListener("error",function(e){ajax.fireEvent("error",e)});xhr.send();ajax.xhr=xhr;return ajax}};WaveSurfer.Observer={on:function(event,fn){if(!this.handlers){this.handlers={}}var handlers=this.handlers[event];if(!handlers){handlers=this.handlers[event]=[]}handlers.push(fn);return{name:event,callback:fn,un:this.un.bind(this,event,fn)}},un:function(event,fn){if(!this.handlers){return}var handlers=this.handlers[event];if(handlers){if(fn){for(var i=handlers.length-1;i>=0;i--){if(handlers[i]==fn){handlers.splice(i,1)}}}else{handlers.length=0}}},unAll:function(){this.handlers=null},once:function(event,handler){var my=this;var fn=function(){handler.apply(this,arguments);setTimeout(function(){my.un(event,fn)},0)};return this.on(event,fn)},fireEvent:function(event){if(!this.handlers){return}var handlers=this.handlers[event];var args=Array.prototype.slice.call(arguments,1);handlers&&handlers.forEach(function(fn){fn.apply(null,args)})}};WaveSurfer.util.extend(WaveSurfer,WaveSurfer.Observer);"use strict";WaveSurfer.WebAudio={scriptBufferSize:256,PLAYING_STATE:0,PAUSED_STATE:1,FINISHED_STATE:2,supportsWebAudio:function(){return!!(window.AudioContext||window.webkitAudioContext)},getAudioContext:function(){if(!WaveSurfer.WebAudio.audioContext){WaveSurfer.WebAudio.audioContext=new(window.AudioContext||window.webkitAudioContext)}return WaveSurfer.WebAudio.audioContext},getOfflineAudioContext:function(sampleRate){if(!WaveSurfer.WebAudio.offlineAudioContext){WaveSurfer.WebAudio.offlineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,sampleRate)}return WaveSurfer.WebAudio.offlineAudioContext},init:function(params){this.params=params;this.ac=params.audioContext||this.getAudioContext();this.lastPlay=this.ac.currentTime;this.startPosition=0;this.scheduledPause=null;this.states=[Object.create(WaveSurfer.WebAudio.state.playing),Object.create(WaveSurfer.WebAudio.state.paused),Object.create(WaveSurfer.WebAudio.state.finished)];this.createVolumeNode();this.createScriptNode();this.createAnalyserNode();this.setState(this.PAUSED_STATE);this.setPlaybackRate(this.params.audioRate)},disconnectFilters:function(){if(this.filters){this.filters.forEach(function(filter){filter&&filter.disconnect()});this.filters=null;this.analyser.connect(this.gainNode)}},setState:function(state){if(this.state!==this.states[state]){this.state=this.states[state];this.state.init.call(this)}},setFilter:function(){this.setFilters([].slice.call(arguments))},setFilters:function(filters){this.disconnectFilters();if(filters&&filters.length){this.filters=filters;this.analyser.disconnect();filters.reduce(function(prev,curr){prev.connect(curr);return curr},this.analyser).connect(this.gainNode)}},createScriptNode:function(){if(this.ac.createScriptProcessor){this.scriptNode=this.ac.createScriptProcessor(this.scriptBufferSize)}else{this.scriptNode=this.ac.createJavaScriptNode(this.scriptBufferSize)}this.scriptNode.connect(this.ac.destination)},addOnAudioProcess:function(){var my=this;this.scriptNode.onaudioprocess=function(){var time=my.getCurrentTime();if(time>=my.getDuration()){my.setState(my.FINISHED_STATE);my.fireEvent("pause")}else if(time>=my.scheduledPause){my.pause()}else if(my.state===my.states[my.PLAYING_STATE]){my.fireEvent("audioprocess",time)}}},removeOnAudioProcess:function(){this.scriptNode.onaudioprocess=null},createAnalyserNode:function(){this.analyser=this.ac.createAnalyser();this.analyser.connect(this.gainNode)},createVolumeNode:function(){if(this.ac.createGain){this.gainNode=this.ac.createGain()}else{this.gainNode=this.ac.createGainNode()}this.gainNode.connect(this.ac.destination)},setVolume:function(newGain){this.gainNode.gain.value=newGain},getVolume:function(){return this.gainNode.gain.value},decodeArrayBuffer:function(arraybuffer,callback,errback){if(!this.offlineAc){this.offlineAc=this.getOfflineAudioContext(this.ac?this.ac.sampleRate:44100)}this.offlineAc.decodeAudioData(arraybuffer,function(data){callback(data)}.bind(this),errback)},setPeaks:function(peaks){this.peaks=peaks},getPeaks:function(length){if(this.peaks){return this.peaks}var sampleSize=this.buffer.length/length;var sampleStep=~~(sampleSize/10)||1;var channels=this.buffer.numberOfChannels;var splitPeaks=[];var mergedPeaks=[];for(var c=0;c<channels;c++){var peaks=splitPeaks[c]=[];var chan=this.buffer.getChannelData(c);for(var i=0;i<length;i++){var start=~~(i*sampleSize);var end=~~(start+sampleSize);var min=0;var max=0;for(var j=start;j<end;j+=sampleStep){var value=chan[j];if(value>max){max=value}if(value<min){min=value}}peaks[2*i]=max;peaks[2*i+1]=min;if(c==0||max>mergedPeaks[2*i]){mergedPeaks[2*i]=max}if(c==0||min<mergedPeaks[2*i+1]){mergedPeaks[2*i+1]=min}}}return this.params.splitChannels?splitPeaks:mergedPeaks},getPlayedPercents:function(){return this.state.getPlayedPercents.call(this)},disconnectSource:function(){if(this.source){this.source.disconnect()}},destroy:function(){if(!this.isPaused()){this.pause()}this.unAll();this.buffer=null;this.disconnectFilters();this.disconnectSource();this.gainNode.disconnect();this.scriptNode.disconnect();this.analyser.disconnect()},load:function(buffer){this.startPosition=0;this.lastPlay=this.ac.currentTime;this.buffer=buffer;this.createSource()},createSource:function(){this.disconnectSource();this.source=this.ac.createBufferSource();this.source.start=this.source.start||this.source.noteGrainOn;this.source.stop=this.source.stop||this.source.noteOff;this.source.playbackRate.value=this.playbackRate;this.source.buffer=this.buffer;this.source.connect(this.analyser)},isPaused:function(){return this.state!==this.states[this.PLAYING_STATE]},getDuration:function(){if(!this.buffer){return 0}return this.buffer.duration},seekTo:function(start,end){if(!this.buffer){return}this.scheduledPause=null;if(start==null){start=this.getCurrentTime();if(start>=this.getDuration()){start=0}}if(end==null){end=this.getDuration()}this.startPosition=start;this.lastPlay=this.ac.currentTime;if(this.state===this.states[this.FINISHED_STATE]){this.setState(this.PAUSED_STATE)}return{start:start,end:end}},getPlayedTime:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate},play:function(start,end){if(!this.buffer){return}this.createSource();var adjustedTime=this.seekTo(start,end);start=adjustedTime.start;end=adjustedTime.end;this.scheduledPause=end;this.source.start(0,start,end-start);this.setState(this.PLAYING_STATE);this.fireEvent("play")},pause:function(){this.scheduledPause=null;this.startPosition+=this.getPlayedTime();this.source&&this.source.stop(0);this.setState(this.PAUSED_STATE);this.fireEvent("pause")},getCurrentTime:function(){return this.state.getCurrentTime.call(this)},setPlaybackRate:function(value){value=value||1;if(this.isPaused()){this.playbackRate=value}else{this.pause();this.playbackRate=value;this.play()}}};WaveSurfer.WebAudio.state={};WaveSurfer.WebAudio.state.playing={init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var duration=this.getDuration();return this.getCurrentTime()/duration||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}};WaveSurfer.WebAudio.state.paused={init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var duration=this.getDuration();return this.getCurrentTime()/duration||0},getCurrentTime:function(){return this.startPosition}};WaveSurfer.WebAudio.state.finished={init:function(){this.removeOnAudioProcess();this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}};WaveSurfer.util.extend(WaveSurfer.WebAudio,WaveSurfer.Observer);"use strict";WaveSurfer.MediaElement=Object.create(WaveSurfer.WebAudio);WaveSurfer.util.extend(WaveSurfer.MediaElement,{init:function(params){this.params=params;this.media={currentTime:0,duration:0,paused:true,playbackRate:1,play:function(){},pause:function(){}};this.mediaType=params.mediaType.toLowerCase();this.elementPosition=params.elementPosition;this.setPlaybackRate(this.params.audioRate);this.createTimer()},createTimer:function(){var my=this;var playing=false;var onAudioProcess=function(){if(my.isPaused()){return}my.fireEvent("audioprocess",my.getCurrentTime());var requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame;requestAnimationFrame(onAudioProcess)};this.on("play",onAudioProcess)},load:function(url,container,peaks){var my=this;var media=document.createElement(this.mediaType);media.controls=this.params.mediaControls;media.autoplay=this.params.autoplay||false;media.preload="auto";media.src=url;media.style.width="100%";var prevMedia=container.querySelector(this.mediaType);if(prevMedia){container.removeChild(prevMedia)}container.appendChild(media);this._load(media,peaks)},loadElt:function(elt,peaks){var my=this;var media=elt;media.controls=this.params.mediaControls;media.autoplay=this.params.autoplay||false;this._load(media,peaks)},_load:function(media,peaks){var my=this;media.load();media.addEventListener("error",function(){my.fireEvent("error","Error loading media element")});media.addEventListener("canplay",function(){my.fireEvent("canplay")});media.addEventListener("ended",function(){my.fireEvent("finish")});this.media=media;this.peaks=peaks;this.onPlayEnd=null;this.buffer=null;this.setPlaybackRate(this.playbackRate)},isPaused:function(){return!this.media||this.media.paused},getDuration:function(){var duration=this.media.duration;if(duration>=Infinity){duration=this.media.seekable.end(0)}return duration},getCurrentTime:function(){return this.media&&this.media.currentTime},getPlayedPercents:function(){return this.getCurrentTime()/this.getDuration()||0},setPlaybackRate:function(value){this.playbackRate=value||1;this.media.playbackRate=this.playbackRate},seekTo:function(start){if(start!=null){this.media.currentTime=start}this.clearPlayEnd()},play:function(start,end){this.seekTo(start);this.media.play();end&&this.setPlayEnd(end);this.fireEvent("play")},pause:function(){this.media&&this.media.pause();this.clearPlayEnd();this.fireEvent("pause")},setPlayEnd:function(end){var my=this;this.onPlayEnd=function(time){if(time>=end){my.pause();my.seekTo(end)}};this.on("audioprocess",this.onPlayEnd)},clearPlayEnd:function(){if(this.onPlayEnd){this.un("audioprocess",this.onPlayEnd);this.onPlayEnd=null}},getPeaks:function(length){if(this.buffer){return WaveSurfer.WebAudio.getPeaks.call(this,length)}return this.peaks||[]},getVolume:function(){return this.media.volume},setVolume:function(val){this.media.volume=val},destroy:function(){this.pause();this.unAll();this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media);this.media=null}});WaveSurfer.AudioElement=WaveSurfer.MediaElement;"use strict";WaveSurfer.Drawer={init:function(container,params){this.container=container;this.params=params;this.width=0;this.height=params.height*this.params.pixelRatio;this.lastPos=0;this.initDrawer(params);this.createWrapper();this.createElements()},createWrapper:function(){this.wrapper=this.container.appendChild(document.createElement("wave"));this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"});if(this.params.fillParent||this.params.scrollParent){this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"})}this.setupWrapperEvents()},handleEvent:function(e){e.preventDefault();var clientX=e.targetTouches?e.targetTouches[0].clientX:e.clientX;var bbox=this.wrapper.getBoundingClientRect();var nominalWidth=this.width;var parentWidth=this.getWidth();var progress;if(!this.params.fillParent&&nominalWidth<parentWidth){progress=(clientX-bbox.left)*this.params.pixelRatio/nominalWidth||0;if(progress>1){progress=1}}else{progress=(clientX-bbox.left+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0}return progress},setupWrapperEvents:function(){var my=this;this.wrapper.addEventListener("click",function(e){var scrollbarHeight=my.wrapper.offsetHeight-my.wrapper.clientHeight;if(scrollbarHeight!=0){var bbox=my.wrapper.getBoundingClientRect();if(e.clientY>=bbox.bottom-scrollbarHeight){return}}if(my.params.interact){my.fireEvent("click",e,my.handleEvent(e))}});this.wrapper.addEventListener("scroll",function(e){my.fireEvent("scroll",e)})},drawPeaks:function(peaks,length){this.resetScroll();this.setWidth(length);this.params.barWidth?this.drawBars(peaks):this.drawWave(peaks)},style:function(el,styles){Object.keys(styles).forEach(function(prop){if(el.style[prop]!==styles[prop]){el.style[prop]=styles[prop]}});return el},resetScroll:function(){if(this.wrapper!==null){this.wrapper.scrollLeft=0}},recenter:function(percent){var position=this.wrapper.scrollWidth*percent;this.recenterOnPosition(position,true)},recenterOnPosition:function(position,immediate){var scrollLeft=this.wrapper.scrollLeft;var half=~~(this.wrapper.clientWidth/2);var target=position-half;var offset=target-scrollLeft;var maxScroll=this.wrapper.scrollWidth-this.wrapper.clientWidth;if(maxScroll==0){return}if(!immediate&&-half<=offset&&offset<half){var rate=5;offset=Math.max(-rate,Math.min(rate,offset));target=scrollLeft+offset}target=Math.max(0,Math.min(maxScroll,target));if(target!=scrollLeft){this.wrapper.scrollLeft=target}},getWidth:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)},setWidth:function(width){if(width==this.width){return}this.width=width;if(this.params.fillParent||this.params.scrollParent){this.style(this.wrapper,{width:""})}else{this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"})}this.updateSize()},setHeight:function(height){if(height==this.height){return}this.height=height;this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"});this.updateSize()},progress:function(progress){var minPxDelta=1/this.params.pixelRatio;var pos=Math.round(progress*this.width)*minPxDelta;if(pos<this.lastPos||pos-this.lastPos>=minPxDelta){this.lastPos=pos;if(this.params.scrollParent&&this.params.autoCenter){var newPos=~~(this.wrapper.scrollWidth*progress);this.recenterOnPosition(newPos)}this.updateProgress(progress)}},destroy:function(){this.unAll();if(this.wrapper){this.container.removeChild(this.wrapper);this.wrapper=null}},initDrawer:function(){},createElements:function(){},updateSize:function(){},drawWave:function(peaks,max){},clearWave:function(){},updateProgress:function(position){}};WaveSurfer.util.extend(WaveSurfer.Drawer,WaveSurfer.Observer);"use strict";WaveSurfer.Drawer.Canvas=Object.create(WaveSurfer.Drawer);WaveSurfer.util.extend(WaveSurfer.Drawer.Canvas,{createElements:function(){var waveCanvas=this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:1,left:0,top:0,bottom:0}));this.waveCc=waveCanvas.getContext("2d");this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:2,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor}));if(this.params.waveColor!=this.params.progressColor){var progressCanvas=this.progressWave.appendChild(document.createElement("canvas"));this.progressCc=progressCanvas.getContext("2d")}},updateSize:function(){var width=Math.round(this.width/this.params.pixelRatio);this.waveCc.canvas.width=this.width;this.waveCc.canvas.height=this.height;this.style(this.waveCc.canvas,{width:width+"px"});this.style(this.progressWave,{display:"block"});if(this.progressCc){this.progressCc.canvas.width=this.width;this.progressCc.canvas.height=this.height;this.style(this.progressCc.canvas,{width:width+"px"})}this.clearWave()},clearWave:function(){this.waveCc.clearRect(0,0,this.width,this.height);if(this.progressCc){this.progressCc.clearRect(0,0,this.width,this.height)}},drawBars:function(peaks,channelIndex){if(peaks[0]instanceof Array){var channels=peaks;if(this.params.splitChannels){this.setHeight(channels.length*this.params.height*this.params.pixelRatio);channels.forEach(this.drawBars,this);return}else{peaks=channels[0]}}var hasMinVals=[].some.call(peaks,function(val){return val<0});if(hasMinVals){peaks=[].filter.call(peaks,function(_,index){return index%2==0})}var $=.5/this.params.pixelRatio;var width=this.width;var height=this.params.height*this.params.pixelRatio;var offsetY=height*channelIndex||0;var halfH=height/2;var length=peaks.length;var bar=this.params.barWidth*this.params.pixelRatio;var gap=Math.max(this.params.pixelRatio,~~(bar/2));var step=bar+gap;var absmax=1;if(this.params.normalize){absmax=Math.max.apply(Math,peaks)}var scale=length/width;this.waveCc.fillStyle=this.params.waveColor;if(this.progressCc){this.progressCc.fillStyle=this.params.progressColor}[this.waveCc,this.progressCc].forEach(function(cc){if(!cc){return}for(var i=0;i<width;i+=step){var h=Math.round(peaks[Math.floor(i*scale)]/absmax*halfH);cc.fillRect(i+$,halfH-h+offsetY,bar+$,h*2)}},this)},drawWave:function(peaks,channelIndex){if(peaks[0]instanceof Array){var channels=peaks;if(this.params.splitChannels){this.setHeight(channels.length*this.params.height*this.params.pixelRatio);channels.forEach(this.drawWave,this);return}else{peaks=channels[0]}}var hasMinValues=[].some.call(peaks,function(val){return val<0});if(!hasMinValues){var reflectedPeaks=[];for(var i=0,len=peaks.length;i<len;i++){reflectedPeaks[2*i]=peaks[i];reflectedPeaks[2*i+1]=-peaks[i]}peaks=reflectedPeaks}var $=.5/this.params.pixelRatio;var height=this.params.height*this.params.pixelRatio;var offsetY=height*channelIndex||0;var halfH=height/2;var length=~~(peaks.length/2);var scale=1;if(this.params.fillParent&&this.width!=length){scale=this.width/length}var absmax=1;if(this.params.normalize){var max=Math.max.apply(Math,peaks);var min=Math.min.apply(Math,peaks);absmax=-min>max?-min:max}this.waveCc.fillStyle=this.params.waveColor;if(this.progressCc){this.progressCc.fillStyle=this.params.progressColor}[this.waveCc,this.progressCc].forEach(function(cc){if(!cc){return}cc.beginPath();cc.moveTo($,halfH+offsetY);for(var i=0;i<length;i++){var h=Math.round(peaks[2*i]/absmax*halfH);cc.lineTo(i*scale+$,halfH-h+offsetY)}for(var i=length-1;i>=0;i--){var h=Math.round(peaks[2*i+1]/absmax*halfH);cc.lineTo(i*scale+$,halfH-h+offsetY)}cc.closePath();cc.fill();cc.fillRect(0,halfH+offsetY-$,this.width,$)},this)},updateProgress:function(progress){var pos=Math.round(this.width*progress)/this.params.pixelRatio;this.style(this.progressWave,{width:pos+"px"})}});"use strict";WaveSurfer.Drawer.MultiCanvas=Object.create(WaveSurfer.Drawer);WaveSurfer.util.extend(WaveSurfer.Drawer.MultiCanvas,{initDrawer:function(params){this.maxCanvasWidth=params.maxCanvasWidth!=null?params.maxCanvasWidth:4e3;this.maxCanvasElementWidth=Math.round(this.maxCanvasWidth/this.params.pixelRatio);if(this.maxCanvasWidth<=1){throw"maxCanvasWidth must be greater than 1."}else if(this.maxCanvasWidth%2==1){throw"maxCanvasWidth must be an even number."}this.hasProgressCanvas=this.params.waveColor!=this.params.progressColor;this.halfPixel=.5/this.params.pixelRatio;this.canvases=[]},createElements:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:2,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor}));this.addCanvas()},updateSize:function(){var totalWidth=Math.round(this.width/this.params.pixelRatio),requiredCanvases=Math.ceil(totalWidth/this.maxCanvasElementWidth);while(this.canvases.length<requiredCanvases){this.addCanvas()}while(this.canvases.length>requiredCanvases){this.removeCanvas()}for(var i in this.canvases){var canvasWidth=this.maxCanvasWidth+2*Math.ceil(this.params.pixelRatio/2);if(i==this.canvases.length-1){canvasWidth=this.width-this.maxCanvasWidth*(this.canvases.length-1)}this.updateDimensions(this.canvases[i],canvasWidth,this.height);this.clearWaveForEntry(this.canvases[i])}},addCanvas:function(){var entry={};var leftOffset=this.maxCanvasElementWidth*this.canvases.length;entry.wave=this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:1,left:leftOffset+"px",top:0,bottom:0}));entry.waveCtx=entry.wave.getContext("2d");if(this.hasProgressCanvas){entry.progress=this.progressWave.appendChild(this.style(document.createElement("canvas"),{position:"absolute",left:leftOffset+"px",top:0,bottom:0}));entry.progressCtx=entry.progress.getContext("2d")}this.canvases.push(entry)},removeCanvas:function(){var lastEntry=this.canvases.pop();lastEntry.wave.parentElement.removeChild(lastEntry.wave);if(this.hasProgressCanvas){lastEntry.progress.parentElement.removeChild(lastEntry.progress)}},updateDimensions:function(entry,width,height){var elementWidth=Math.round(width/this.params.pixelRatio);entry.waveCtx.canvas.width=width;entry.waveCtx.canvas.height=height;this.style(entry.waveCtx.canvas,{width:elementWidth+"px"});this.style(this.progressWave,{display:"block"});if(this.hasProgressCanvas){entry.progressCtx.canvas.width=width;entry.progressCtx.canvas.height=height;this.style(entry.progressCtx.canvas,{width:elementWidth+"px"})}},clearWave:function(){for(var i in this.canvases){this.clearWaveForEntry(this.canvases[i])}},clearWaveForEntry:function(entry){entry.waveCtx.clearRect(0,0,entry.waveCtx.canvas.width,entry.waveCtx.canvas.height);if(this.hasProgressCanvas){entry.progressCtx.clearRect(0,0,entry.progressCtx.canvas.width,entry.progressCtx.canvas.height)}},drawBars:function(peaks,channelIndex){if(peaks[0]instanceof Array){var channels=peaks;if(this.params.splitChannels){this.setHeight(channels.length*this.params.height*this.params.pixelRatio);channels.forEach(this.drawBars,this);return}else{peaks=channels[0]}}var hasMinVals=[].some.call(peaks,function(val){return val<0});if(hasMinVals){peaks=[].filter.call(peaks,function(_,index){return index%2==0})}var width=this.width;var height=this.params.height*this.params.pixelRatio;var offsetY=height*channelIndex||0;var halfH=height/2;var length=peaks.length;var bar=this.params.barWidth*this.params.pixelRatio;var gap=Math.max(this.params.pixelRatio,~~(bar/2));var step=bar+gap;var absmax=1;if(this.params.normalize){absmax=WaveSurfer.util.max(peaks)}var scale=length/width;this.canvases[0].waveCtx.fillStyle=this.params.waveColor;if(this.canvases[0].progressCtx){this.canvases[0].progressCtx.fillStyle=this.params.progressColor}for(var i=0;i<width;i+=step){var h=Math.round(peaks[Math.floor(i*scale)]/absmax*halfH);this.fillRect(i+this.halfPixel,halfH-h+offsetY,bar+this.halfPixel,h*2)}},drawWave:function(peaks,channelIndex){if(peaks[0]instanceof Array){var channels=peaks;if(this.params.splitChannels){this.setHeight(channels.length*this.params.height*this.params.pixelRatio);channels.forEach(this.drawWave,this);return}else{peaks=channels[0]}}var hasMinValues=[].some.call(peaks,function(val){return val<0});if(!hasMinValues){var reflectedPeaks=[];for(var i=0,len=peaks.length;i<len;i++){reflectedPeaks[2*i]=peaks[i];reflectedPeaks[2*i+1]=-peaks[i]}peaks=reflectedPeaks}var height=this.params.height*this.params.pixelRatio;var offsetY=height*channelIndex||0;var halfH=height/2;var length=~~(peaks.length/this.canvases.length/2);var absmax=1;if(this.params.normalize){var max=WaveSurfer.util.max(peaks);var min=WaveSurfer.util.min(peaks);absmax=-min>max?-min:max}this.drawLine(length,peaks,absmax,halfH,offsetY);this.fillRect(0,halfH+offsetY-this.halfPixel,this.width,this.halfPixel)},drawLine:function(length,peaks,absmax,halfH,offsetY){for(var index in this.canvases){var entry=this.canvases[index];this.setFillStyles(entry);this.drawLineToContext(entry.waveCtx,length,index,peaks,absmax,halfH,offsetY);this.drawLineToContext(entry.progressCtx,length,index,peaks,absmax,halfH,offsetY)}},drawLineToContext:function(ctx,length,index,peaks,absmax,halfH,offsetY){if(!ctx){return}var scale=1;if(this.params.fillParent&&this.width!=length){scale=ctx.canvas.width/length}var first=index*length,last=first+length+1;ctx.beginPath();ctx.moveTo(this.halfPixel,halfH+offsetY);for(var i=first;i<last;i++){var h=Math.round(peaks[2*i]/absmax*halfH);ctx.lineTo((i-first)*scale+this.halfPixel,halfH-h+offsetY)}for(var i=last-1;i>=first;i--){var h=Math.round(peaks[2*i+1]/absmax*halfH);ctx.lineTo((i-first)*scale+this.halfPixel,halfH-h+offsetY)}ctx.closePath();ctx.fill()},fillRect:function(x,y,width,height){for(var i in this.canvases){var entry=this.canvases[i],leftOffset=i*this.maxCanvasWidth;var intersection={x1:Math.max(x,i*this.maxCanvasWidth),y1:y,x2:Math.min(x+width,i*this.maxCanvasWidth+entry.waveCtx.canvas.width),y2:y+height};if(intersection.x1<intersection.x2){this.setFillStyles(entry);this.fillRectToContext(entry.waveCtx,intersection.x1-leftOffset,intersection.y1,intersection.x2-intersection.x1,intersection.y2-intersection.y1);this.fillRectToContext(entry.progressCtx,intersection.x1-leftOffset,intersection.y1,intersection.x2-intersection.x1,intersection.y2-intersection.y1)}}},fillRectToContext:function(ctx,x,y,width,height){if(!ctx){return}ctx.fillRect(x,y,width,height)},setFillStyles:function(entry){entry.waveCtx.fillStyle=this.params.waveColor;if(this.hasProgressCanvas){entry.progressCtx.fillStyle=this.params.progressColor}},updateProgress:function(progress){var pos=Math.round(this.width*progress)/this.params.pixelRatio;this.style(this.progressWave,{width:pos+"px"})}});"use strict";(function(){var init=function(){var containers=document.querySelectorAll("wavesurfer");Array.prototype.forEach.call(containers,function(el){var params=WaveSurfer.util.extend({container:el,backend:"MediaElement",mediaControls:true},el.dataset);el.style.display="block";var wavesurfer=WaveSurfer.create(params);if(el.dataset.peaks){var peaks=JSON.parse(el.dataset.peaks)}wavesurfer.load(el.dataset.url,peaks)})};if(document.readyState==="complete"){init()}else{window.addEventListener("load",init)}})();return WaveSurfer})},1741:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(a,b){true?!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1740)],__WEBPACK_AMD_DEFINE_RESULT__=function(a){return b(a)}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)):"object"==typeof exports?module.exports=b(require("wavesurfer.js")):b(WaveSurfer)}(this,function(a){"use strict";a.Minimap=a.util.extend({},a.Drawer,a.Drawer.Canvas,{init:function(b,c){this.wavesurfer=b,this.container=this.wavesurfer.drawer.container,this.lastPos=this.wavesurfer.drawer.lastPos,this.params=b.util.extend({},this.wavesurfer.drawer.params,{showRegions:!1,showOverview:!1,overviewBorderColor:"green",overviewBorderSize:2},c,{scrollParent:!1,fillParent:!0}),this.width=0,this.height=this.params.height*this.params.pixelRatio,this.createWrapper(),this.createElements(),a.Regions&&this.params.showRegions&&this.regions(),this.bindWaveSurferEvents(),this.bindMinimapEvents()},regions:function(){var a=this;this.regions={},this.wavesurfer.on("region-created",function(b){a.regions[b.id]=b,a.renderRegions()}),this.wavesurfer.on("region-updated",function(b){a.regions[b.id]=b,a.renderRegions()}),this.wavesurfer.on("region-removed",function(b){delete a.regions[b.id],a.renderRegions()})},renderRegions:function(){for(var a=this,b=this.wrapper.querySelectorAll("region"),c=0;c<b.length;++c)this.wrapper.removeChild(b[c]);Object.keys(this.regions).forEach(function(b){var c=a.regions[b],d=a.width*((c.end-c.start)/a.wavesurfer.getDuration()),e=a.width*(c.start/a.wavesurfer.getDuration()),f=a.style(document.createElement("region"),{height:"inherit",backgroundColor:c.color,width:d+"px",left:e+"px",display:"block",position:"absolute"});f.classList.add(b),a.wrapper.appendChild(f)})},createElements:function(){a.Drawer.Canvas.createElements.call(this),this.params.showOverview&&(this.overviewRegion=this.style(document.createElement("overview"),{height:this.wrapper.offsetHeight-2*this.params.overviewBorderSize+"px",width:"0px",display:"block",position:"absolute",cursor:"move",border:this.params.overviewBorderSize+"px solid "+this.params.overviewBorderColor,zIndex:2,opacity:this.params.overviewOpacity}),this.wrapper.appendChild(this.overviewRegion))},bindWaveSurferEvents:function(){var a=this;this.wavesurfer.on("ready",this.render.bind(this)),this.wavesurfer.on("audioprocess",function(b){a.progress(a.wavesurfer.backend.getPlayedPercents())}),this.wavesurfer.on("seek",function(b){a.progress(a.wavesurfer.backend.getPlayedPercents())}),this.params.showOverview&&(this.wavesurfer.on("scroll",function(b){a.draggingOverview||a.moveOverviewRegion(b.target.scrollLeft/a.ratio)}),this.wavesurfer.drawer.wrapper.addEventListener("mouseover",function(b){a.draggingOverview&&(a.draggingOverview=!1)}));var b=0,c=function(){b!=a.wrapper.clientWidth&&(b=a.wrapper.clientWidth,a.render(),a.progress(a.wavesurfer.backend.getPlayedPercents()))};window.addEventListener("resize",c,!0),this.wavesurfer.on("destroy",function(){a.destroy.bind(this),window.removeEventListener("resize",c,!0)})},bindMinimapEvents:function(){var a=this,b=0,c=!0,d={clientX:0,clientY:0};this.on("click",function(a,b){c?(this.progress(b),this.wavesurfer.seekAndCenter(b)):c=!0}.bind(this)),this.params.showOverview&&(this.overviewRegion.addEventListener("mousedown",function(c){a.draggingOverview=!0,b=c.layerX,d.clientX=c.clientX,d.clientY=c.clientY}),this.wrapper.addEventListener("mousemove",function(c){a.draggingOverview&&a.moveOverviewRegion(c.clientX-a.container.getBoundingClientRect().left-b)}),this.wrapper.addEventListener("mouseup",function(b){d.clientX-b.clientX===0&&d.clientX-b.clientX===0?(c=!0,a.draggingOverview=!1):a.draggingOverview&&(c=!1,a.draggingOverview=!1)}))},render:function(){var a=this.getWidth(),b=this.wavesurfer.backend.getPeaks(a);this.drawPeaks(b,a),this.params.showOverview&&(this.ratio=this.wavesurfer.drawer.width/this.width,this.waveShowedWidth=this.wavesurfer.drawer.width/this.ratio,this.waveWidth=this.wavesurfer.drawer.width,this.overviewWidth=this.width/this.ratio,this.overviewPosition=0,this.overviewRegion.style.width=this.overviewWidth-2*this.params.overviewBorderSize+"px")},moveOverviewRegion:function(a){a<0?this.overviewPosition=0:a+this.overviewWidth<this.width?this.overviewPosition=a:this.overviewPosition=this.width-this.overviewWidth,this.overviewRegion.style.left=this.overviewPosition+"px",this.wavesurfer.drawer.wrapper.scrollLeft=this.overviewPosition*this.ratio}}),a.initMinimap=function(b){var c=Object.create(a.Minimap);return c.init(this,b),c}})},1742:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(a,b){true?!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1740)],__WEBPACK_AMD_DEFINE_RESULT__=function(a){return b(a)}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),
__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)):"object"==typeof exports?module.exports=b(require("wavesurfer.js")):b(WaveSurfer)}(this,function(a){"use strict";a.Timeline={init:function(a){this.params=a;var b=this.wavesurfer=a.wavesurfer;if(!this.wavesurfer)throw Error("No WaveSurfer intance provided");var c=this.drawer=this.wavesurfer.drawer;if(this.container="string"==typeof a.container?document.querySelector(a.container):a.container,!this.container)throw Error("No container for WaveSurfer timeline");this.width=c.width,this.pixelRatio=this.drawer.params.pixelRatio,this.maxCanvasWidth=c.maxCanvasWidth||this.width,this.maxCanvasElementWidth=c.maxCanvasElementWidth||Math.round(this.maxCanvasWidth/this.pixelRatio),this.height=this.params.height||20,this.notchPercentHeight=this.params.notchPercentHeight||90,this.primaryColor=this.params.primaryColor||"#000",this.secondaryColor=this.params.secondaryColor||"#c0c0c0",this.primaryFontColor=this.params.primaryFontColor||"#000",this.secondaryFontColor=this.params.secondaryFontColor||"#000",this.fontFamily=this.params.fontFamily||"Arial",this.fontSize=this.params.fontSize||10,this.timeInterval=this.params.timeInterval,this.primaryLabelInterval=this.params.primaryLabelInterval,this.secondaryLabelInterval=this.params.secondaryLabelInterval,this.formatTimeCallback=this.params.formatTimeCallback,this.canvases=[],this.createWrapper(),this.createCanvases(),this.render(),c.wrapper.addEventListener("scroll",function(a){this.updateScroll(a)}.bind(this)),b.on("redraw",this.render.bind(this)),b.on("destroy",this.destroy.bind(this))},destroy:function(){this.unAll(),this.wrapper&&this.wrapper.parentNode&&(this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null)},createWrapper:function(){var a=this.container.querySelector("timeline");a&&this.container.removeChild(a);var b=this.wavesurfer.params;this.wrapper=this.container.appendChild(document.createElement("timeline")),this.drawer.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.height+"px"}),(b.fillParent||b.scrollParent)&&this.drawer.style(this.wrapper,{width:"100%",overflowX:"hidden",overflowY:"hidden"});var c=this;this.wrapper.addEventListener("click",function(a){a.preventDefault();var b="offsetX"in a?a.offsetX:a.layerX;c.fireEvent("click",b/c.wrapper.scrollWidth||0)})},createCanvases:function(){for(var a,b=Math.round(this.drawer.wrapper.scrollWidth),c=Math.ceil(b/this.maxCanvasElementWidth),d=0;d<c;d++)a=this.wrapper.appendChild(document.createElement("canvas")),this.canvases.push(a),this.drawer.style(a,{position:"absolute",zIndex:4})},render:function(){this.updateCanvasStyle(),this.drawTimeCanvases()},updateCanvasStyle:function(){for(var a=this.canvases.length,b=0;b<a;b++){var c=this.canvases[b],d=this.maxCanvasElementWidth;b===a-1&&(d=this.width/this.pixelRatio-this.maxCanvasElementWidth*(a-1)),c.width=d*this.pixelRatio,c.height=this.height*this.pixelRatio,c.style.width=d+"px",c.style.height=this.height+"px",c.style.left=b*d+"px"}},drawTimeCanvases:function(){var a=this.wavesurfer.backend,b=this.wavesurfer.params,c=a.getDuration(),d=this;if(b.fillParent&&!b.scrollParent)var e=this.drawer.getWidth();else e=this.drawer.wrapper.scrollWidth*b.pixelRatio;var f=e/c;if(!(c<=0)){var g=0,h=0,i=parseInt(c,10)+1,j=function(a){if("function"==typeof d.formatTimeCallback)return d.formatTimeCallback(a);if(a/60>1){var b=parseInt(a/60),a=parseInt(a%60);return a=a<10?"0"+a:a,""+b+":"+a}return a};if(1*f>=25)var k=1,l=10,m=5;else if(5*f>=25)var k=5,l=6,m=2;else if(15*f>=25)var k=15,l=4,m=2;else var k=60,l=4,m=2;k=this.timeInterval||k,l=this.primaryLabelInterval||l,m=this.secondaryLabelInterval||m;for(var n=this.height-4,o=this.height*(this.notchPercentHeight/100)-4,p=this.fontSize*b.pixelRatio,q=0;q<i/k;q++)q%l==0?(this.setFillStyles(this.primaryColor),this.fillRect(g,0,1,n),this.setFonts(p+"px "+this.fontFamily),this.setFillStyles(this.primaryFontColor),this.fillText(j(h),g+5,n)):q%m==0?(this.setFillStyles(this.secondaryColor),this.fillRect(g,0,1,n),this.setFonts(p+"px "+this.fontFamily),this.setFillStyles(this.secondaryFontColor),this.fillText(j(h),g+5,n)):(this.setFillStyles(this.secondaryColor),this.fillRect(g,0,1,o)),h+=k,g+=f*k}},setFillStyles:function(a){for(var b in this.canvases)this.canvases[b].getContext("2d").fillStyle=a},setFonts:function(a){for(var b in this.canvases)this.canvases[b].getContext("2d").font=a},fillRect:function(a,b,c,d){for(var e in this.canvases){var f=this.canvases[e],g=e*this.maxCanvasWidth,h={x1:Math.max(a,e*this.maxCanvasWidth),y1:b,x2:Math.min(a+c,e*this.maxCanvasWidth+f.width),y2:b+d};h.x1<h.x2&&f.getContext("2d").fillRect(h.x1-g,h.y1,h.x2-h.x1,h.y2-h.y1)}},fillText:function(a,b,c){var d,e=0;for(var f in this.canvases){var g=this.canvases[f].getContext("2d"),h=g.canvas.width;if(e>b+d)break;e+h>b&&(d=g.measureText(a).width,g.fillText(a,b-e,c)),e+=h}},updateScroll:function(){this.wrapper.scrollLeft=this.drawer.wrapper.scrollLeft}},a.util.extend(a.Timeline,a.Observer)})},1743:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(a,b){true?!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1740)],__WEBPACK_AMD_DEFINE_RESULT__=function(a){return b(a)}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)):"object"==typeof exports?module.exports=b(require("wavesurfer.js")):b(WaveSurfer)}(this,function(a){"use strict";a.Regions={init:function(a){this.wavesurfer=a,this.wrapper=this.wavesurfer.drawer.wrapper,this.list={}},add:function(b){var c=Object.create(a.Region);return c.init(b,this.wavesurfer),this.list[c.id]=c,c.on("remove",function(){delete this.list[c.id]}.bind(this)),c},clear:function(){Object.keys(this.list).forEach(function(a){this.list[a].remove()},this)},enableDragSelection:function(a){function b(a){a.touches&&a.touches.length>1||(h=a.targetTouches?a.targetTouches[0].identifier:null,e=!0,f=i.wavesurfer.drawer.handleEvent(a),g=null)}function c(a){a.touches&&a.touches.length>1||(e=!1,k=0,g&&(g.fireEvent("update-end",a),i.wavesurfer.fireEvent("region-update-end",g,a)),g=null)}function d(b){if(e&&!(++k<=j||b.touches&&b.touches.length>1||b.targetTouches&&b.targetTouches[0].identifier!=h)){g||(g=i.add(a||{}));var c=i.wavesurfer.getDuration(),d=i.wavesurfer.drawer.handleEvent(b);g.update({start:Math.min(d*c,f*c),end:Math.max(d*c,f*c)})}}var e,f,g,h,i=this,j=a.slop||2,k=0;this.wrapper.addEventListener("mousedown",b),this.wrapper.addEventListener("touchstart",b),this.on("disable-drag-selection",function(){i.wrapper.removeEventListener("touchstart",b),i.wrapper.removeEventListener("mousedown",b)}),this.wrapper.addEventListener("mouseup",c),this.wrapper.addEventListener("touchend",c),this.on("disable-drag-selection",function(){i.wrapper.removeEventListener("touchend",c),i.wrapper.removeEventListener("mouseup",c)}),this.wrapper.addEventListener("mousemove",d),this.wrapper.addEventListener("touchmove",d),this.on("disable-drag-selection",function(){i.wrapper.removeEventListener("touchmove",d),i.wrapper.removeEventListener("mousemove",d)})},disableDragSelection:function(){this.fireEvent("disable-drag-selection")}},a.util.extend(a.Regions,a.Observer),a.Region={style:a.Drawer.style,init:function(b,c){this.wavesurfer=c,this.wrapper=c.drawer.wrapper,this.id=null==b.id?a.util.getId():b.id,this.start=Number(b.start)||0,this.end=null==b.end?this.start+4/this.wrapper.scrollWidth*this.wavesurfer.getDuration():Number(b.end),this.resize=void 0===b.resize||Boolean(b.resize),this.drag=void 0===b.drag||Boolean(b.drag),this.loop=Boolean(b.loop),this.color=b.color||"rgba(0, 0, 0, 0.1)",this.data=b.data||{},this.attributes=b.attributes||{},this.maxLength=b.maxLength,this.minLength=b.minLength,this.bindInOut(),this.render(),this.wavesurfer.on("zoom",this.updateRender.bind(this)),this.wavesurfer.fireEvent("region-created",this)},update:function(a){null!=a.start&&(this.start=Number(a.start)),null!=a.end&&(this.end=Number(a.end)),null!=a.loop&&(this.loop=Boolean(a.loop)),null!=a.color&&(this.color=a.color),null!=a.data&&(this.data=a.data),null!=a.resize&&(this.resize=Boolean(a.resize)),null!=a.drag&&(this.drag=Boolean(a.drag)),null!=a.maxLength&&(this.maxLength=Number(a.maxLength)),null!=a.minLength&&(this.minLength=Number(a.minLength)),null!=a.attributes&&(this.attributes=a.attributes),this.updateRender(),this.fireEvent("update"),this.wavesurfer.fireEvent("region-updated",this)},remove:function(){this.element&&(this.wrapper.removeChild(this.element),this.element=null,this.fireEvent("remove"),this.wavesurfer.un("zoom",this.updateRender.bind(this)),this.wavesurfer.fireEvent("region-removed",this))},play:function(){this.wavesurfer.play(this.start,this.end),this.fireEvent("play"),this.wavesurfer.fireEvent("region-play",this)},playLoop:function(){this.play(),this.once("out",this.playLoop.bind(this))},render:function(){var a=document.createElement("region");a.className="wavesurfer-region",a.title=this.formatTime(this.start,this.end),a.setAttribute("data-id",this.id);for(var b in this.attributes)a.setAttribute("data-region-"+b,this.attributes[b]);this.wrapper.scrollWidth;if(this.style(a,{position:"absolute",zIndex:2,height:"100%",top:"0px"}),this.resize){var c=a.appendChild(document.createElement("handle")),d=a.appendChild(document.createElement("handle"));c.className="wavesurfer-handle wavesurfer-handle-start",d.className="wavesurfer-handle wavesurfer-handle-end";var e={cursor:"col-resize",position:"absolute",left:"0px",top:"0px",width:"1%",maxWidth:"4px",height:"100%"};this.style(c,e),this.style(d,e),this.style(d,{left:"100%"})}this.element=this.wrapper.appendChild(a),this.updateRender(),this.bindEvents(a)},formatTime:function(a,b){return(a==b?[a]:[a,b]).map(function(a){return[Math.floor(a%3600/60),("00"+Math.floor(a%60)).slice(-2)].join(":")}).join("-")},updateRender:function(a){var b,c=this.wavesurfer.getDuration();if(b=a?Math.round(this.wavesurfer.getDuration()*a):this.wrapper.scrollWidth,this.start<0&&(this.start=0,this.end=this.end-this.start),this.end>c&&(this.end=c,this.start=c-(this.end-this.start)),null!=this.minLength&&(this.end=Math.max(this.start+this.minLength,this.end)),null!=this.maxLength&&(this.end=Math.min(this.start+this.maxLength,this.end)),null!=this.element){this.style(this.element,{left:~~(this.start/c*b)+"px",width:~~((this.end-this.start)/c*b)+"px",backgroundColor:this.color,cursor:this.drag?"move":"default"});for(var d in this.attributes)this.element.setAttribute("data-region-"+d,this.attributes[d]);this.element.title=this.formatTime(this.start,this.end)}},bindInOut:function(){var a=this;a.firedIn=!1,a.firedOut=!1;var b=function(b){!a.firedOut&&a.firedIn&&(a.start>=Math.round(100*b)/100||a.end<=Math.round(100*b)/100)&&(a.firedOut=!0,a.firedIn=!1,a.fireEvent("out"),a.wavesurfer.fireEvent("region-out",a)),!a.firedIn&&a.start<=b&&a.end>b&&(a.firedIn=!0,a.firedOut=!1,a.fireEvent("in"),a.wavesurfer.fireEvent("region-in",a))};this.wavesurfer.backend.on("audioprocess",b),this.on("remove",function(){a.wavesurfer.backend.un("audioprocess",b)}),this.on("out",function(){a.loop&&a.wavesurfer.play(a.start)})},bindEvents:function(){var a=this;this.element.addEventListener("mouseenter",function(b){a.fireEvent("mouseenter",b),a.wavesurfer.fireEvent("region-mouseenter",a,b)}),this.element.addEventListener("mouseleave",function(b){a.fireEvent("mouseleave",b),a.wavesurfer.fireEvent("region-mouseleave",a,b)}),this.element.addEventListener("click",function(b){b.preventDefault(),a.fireEvent("click",b),a.wavesurfer.fireEvent("region-click",a,b)}),this.element.addEventListener("dblclick",function(b){b.stopPropagation(),b.preventDefault(),a.fireEvent("dblclick",b),a.wavesurfer.fireEvent("region-dblclick",a,b)}),(this.drag||this.resize)&&function(){var b,c,d,e,f=a.wavesurfer.getDuration(),g=function(g){g.touches&&g.touches.length>1||(e=g.targetTouches?g.targetTouches[0].identifier:null,g.stopPropagation(),d=a.wavesurfer.drawer.handleEvent(g)*f,"handle"==g.target.tagName.toLowerCase()?c=g.target.classList.contains("wavesurfer-handle-start")?"start":"end":b=!0)},h=function(d){d.touches&&d.touches.length>1||(b||c)&&(b=!1,c=!1,d.stopPropagation(),d.preventDefault(),a.fireEvent("update-end",d),a.wavesurfer.fireEvent("region-update-end",a,d))},i=function(g){if(!(g.touches&&g.touches.length>1)&&(!g.targetTouches||g.targetTouches[0].identifier==e)&&(b||c)){var h=a.wavesurfer.drawer.handleEvent(g)*f,i=h-d;d=h,a.drag&&b&&a.onDrag(i),a.resize&&c&&a.onResize(i,c)}};a.element.addEventListener("mousedown",g),a.element.addEventListener("touchstart",g),a.wrapper.addEventListener("mousemove",i),a.wrapper.addEventListener("touchmove",i),document.body.addEventListener("mouseup",h),document.body.addEventListener("touchend",h),a.on("remove",function(){document.body.removeEventListener("mouseup",h),document.body.removeEventListener("touchend",h),a.wrapper.removeEventListener("mousemove",i),a.wrapper.removeEventListener("touchmove",i)}),a.wavesurfer.on("destroy",function(){document.body.removeEventListener("mouseup",h),document.body.removeEventListener("touchend",h)})}()},onDrag:function(a){this.update({start:this.start+a,end:this.end+a})},onResize:function(a,b){"start"==b?this.update({start:Math.min(this.start+a,this.end),end:Math.max(this.start+a,this.end)}):this.update({start:Math.min(this.end+a,this.start),end:Math.max(this.end+a,this.start)})}},a.util.extend(a.Region,a.Observer),a.initRegions=function(){this.regions||(this.regions=Object.create(a.Regions),this.regions.init(this))},a.addRegion=function(a){return this.initRegions(),this.regions.add(a)},a.clearRegions=function(){this.regions&&this.regions.clear()},a.enableDragSelection=function(a){this.initRegions(),this.regions.enableDragSelection(a)},a.disableDragSelection=function(){this.regions.disableDragSelection()}})},1744:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdminService=function(){function AdminService($http,$q,url){(0,_classCallCheck3.default)(this,AdminService);this.$http=$http;this.$q=$q;this.url=url}(0,_createClass3.default)(AdminService,[{key:"save",value:function save(resource){var deferred=this.$q.defer();this.$http.post(this.url("media_resource_save",{workspaceId:resource.workspaceId,id:resource.id}),resource).success(function onSuccess(response){deferred.resolve(response)}.bind(this)).error(function onError(response){deferred.reject(response)});return deferred.promise}},{key:"zip",value:function zip(resource){var deferred=this.$q.defer();this.$http.post(this.url("mediaresource_zip_export",{workspaceId:resource.workspaceId,id:resource.id}),resource.regions,{responseType:"arraybuffer"}).success(function onSuccess(response){deferred.resolve(response)}.bind(this)).error(function onError(response){deferred.reject(response)});return deferred.promise}}]);return AdminService}();exports.default=AdminService},1745:function(module,exports){module.exports='<!-- PANEL HEADER -->\n<div class="panel-heading clearfix">\n    <h3 class="panel-title pull-left">\n        {{$ctrl.resource.name}}\n    </h3>\n    <a href="{{ \'innova_media_resource_open\' | path:{\'workspaceId\': $ctrl.resource.workspaceId, \'id\':$ctrl.resource.id} }}" title="{{\'media_resource_open\' | trans :{}:\'media_resource\'}}" class="btn btn-default fa fa-eye pull-right"></a>\n</div>\n<div class="panel-body">\n    <!-- options for the resource -->\n    <div data-ng-if="$ctrl.httpSuccess" class="alert alert-dismissable alert-success">\n        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>\n        {{ \'resource_update_success\' | trans:{}:\'media_resource\'}}\n    </div>\n    <div data-ng-if="$ctrl.httpError" class="alert alert-dismissable alert-danger">\n        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>\n        {{ \'resource_update_error\' | trans:{}:\'media_resource\'}}\n    </div>\n    <!-- options for the resource -->\n    <div class="panel panel-primary options-panel">\n        <div class="panel-heading clearfix">\n            <h3 class="panel-title pull-left">{{\'options_panel_title\' | trans :{}:\'media_resource\'}}</h3>\n            <button type="button" role="button" title="{{\'show_hide_options_panel\' | trans:{}:\'resource_form\'}}" class="btn btn-default fa fa-chevron-up pull-right" data-ng-click="$ctrl.togglePanel($event)"></button>\n        </div>\n        <div class="panel-body">\n            <!-- CHOOSE PLAY MODE -->\n            <div class="form-group">\n                <label class="col-sm-2 control-label" for="media_resource_options_mode">\n                    {{\'options_form_view_mode\' | trans:{}:\'resource_form\'}}\n                    <button popover-append-to-body="true" popover-placement="right" uib-popover-template="$ctrl.popoverPlayersTplUrl" title="{{\'popover_button_title\' | trans:{}:\'media_resource\'}}" popover-title="{{\'popover_players_popover_title\' | trans:{}:\'media_resource\'}}" type="button" class="btn btn-default fa fa-info"></button>\n\n                </label>\n                <div class="col-sm-10">\n                    <select class="form-control" data-ng-change="$ctrl.optionsModeChanged()" data-ng-model="$ctrl.resource.options.mode">\n                        <option data-ng-repeat="mode in $ctrl.modes" value="{{mode.value}}">{{mode.name}}</option>\n                    </select>\n                </div>\n            </div>\n            <!-- SHOW TEXT TRANSCRIPTION OPTION -->\n            <div class="form-group" data-ng-show="$ctrl.resource.options.mode == \'free\'">\n                <label class="col-sm-2 control-label" for="media_resource_options_showTextTranscription">\n                    {{\'options_form_enable_text_transcription\' | trans:{}:\'resource_form\'}}\n                </label>\n                <div class="col-sm-10">\n                    <input type="checkbox" data-ng-model="$ctrl.resource.options.showTextTranscription">\n                </div>\n            </div>\n            <hr>\n            <!-- TTS LANGUAGE -->\n            <div class="form-group">\n                <label class="col-sm-2 control-label" for="media_resource_options_ttsLanguage">\n                    {{\'options_form_tts_language\' | trans:{}:\'resource_form\'}}\n                </label>\n                <div class="col-sm-10">\n                    <select class="form-control" name="" data-ng-model="$ctrl.resource.options.lang">\n                        <option data-ng-repeat="lang in $ctrl.langs" value="{{lang.value}}">{{lang.name}}</option>\n                    </select>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- resource edition -->\n    <div class="panel panel-primary">\n        <div class="panel-heading"></div>\n        <div class="panel-body">\n            <!-- timeline + waveform + minimap -->\n            <div class="row media-container">\n                <div class="col-md-12">\n                    <div id="audio-player">\n                        <div id="wave-timeline"></div>\n                        <div id="waveform">\n                            <div class="progress progress-striped active" id="progress-bar">\n                                <div class="progress-bar progress-bar-info"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <hr>\n            <!-- main controls buttons -->\n            <div class="row">\n                <div class="col-md-12 text-center">\n                    <div class="btn-group">\n                        <button type="button" role="button" class="btn btn-default" data-ng-click="$ctrl.backward()" title="{{\'move_backward\' | trans:{}:\'media_resource\'}}">\n                            <i class="fa fa-step-backward"></i>\n                        </button>\n                        <button type="button" class="btn btn-default" data-ng-click="$ctrl.play()" title="{{\'play_pause\' | trans:{}:\'media_resource\'}}">\n                            <i class="fa fa-play"></i>\n                            /\n                            <i class="fa fa-pause"></i>\n                        </button>\n                        <button type="button" class="btn btn-default" data-ng-click="$ctrl.playRegion()" title="{{\'play_current_region\' | trans:{}:\'media_resource\'}}">\n                            &nbsp;|-&nbsp;<i class="fa fa-play"></i>&nbsp;-|&nbsp;\n                        </button>\n                        <button type="button" class="btn btn-default" data-ng-click="$ctrl.forward()" title="{{\'move_forward\' | trans:{}:\'media_resource\'}}">\n                            <i class="fa fa-step-forward"></i>\n                        </button>\n                    </div>\n                    <div class="btn-group">\n                        <button type="button" class="btn btn-warning" title="{{\'add_marker\' | trans:{}:\'media_resource\'}}" data-ng-click="$ctrl.mark()">\n                            <i class="fa fa-flag"></i>\n                        </button>\n                        <button type="button" class="btn btn-default" data-ng-click="$ctrl.help()" title="{{\'region_help_preview\' | trans:{}:\'media_resource\'}}">\n                            <i class="fa fa-question"></i>\n                        </button>\n                        <button type="button" class="btn btn-default" data-ng-click="$ctrl.zip()" title="{{\'resource_zip_export\' | trans:{}:\'media_resource\'}}">\n                            <i class="fa fa-download"></i>\n                        </button>\n                        <button type="button" role="button" class="btn btn-primary" data-ng-click="$ctrl.save()" title="{{ \'media_resource_save\'|trans:{}:\'media_resource\'}}">\n                            <i class="fa fa-save"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <hr>\n\n            <!-- regions -->\n            <div class="row">\n                <div class="col-md-12 text-center regions-container">\n                    <div class="row regions-titles">\n                        <div class="col-xs-2 text-center">\n                            <b>{{\'region_list_start_end_title\' | trans:{}:\'media_resource\'}}</b>\n                        </div>\n                        <div class="col-xs-7">\n                            <b>{{\'region_list_transcription_title\' | trans:{}:\'media_resource\'}}</b>\n                            <button uib-popover-template="$ctrl.popoverTranscriptionTplUrl" title="{{\'popover_button_title\' | trans:{}:\'media_resource\'}}" popover-title="{{\'popover_transcription_popover_title\' | trans:{}:\'media_resource\'}}" type="button" class="btn btn-default fa fa-info"></button>\n                        </div>\n                        <div class="col-xs-1 text-center">\n                            <b>{{\'region_list_number_title\' | trans:{}:\'media_resource\'}}</b>\n                        </div>\n                        <div class="col-xs-2 text-center">\n                            <b>{{\'region_list_actions_title\' | trans:{}:\'media_resource\'}}</b>\n                        </div>\n                    </div>\n                    <hr>\n                    <div class="row region" data-uuid="{{region.uuid}}" data-ng-repeat="region in $ctrl.resource.regions | orderBy : \'start\'">\n                        <div class="col-xs-1 text-center">\n                            <div class="time-text start" data-start="{{region.start}}" data-ng-model="region.start">{{ region.start | secondsToHms}}</div>\n                        </div>\n                        <div class="col-xs-1 text-center">\n                            <div class="time-text end" data-ng-model="region.end">{{ region.end | secondsToHms }}</div>\n                        </div>\n                        <div class="col-xs-7">\n                            <div contenteditable="true" class="text-left note" data-ng-bind-html="region.note | trust_html" data-ng-model="region.note"></div>\n                        </div>\n                        <div class="col-xs-1 text-right">\n                            <span class="badge row-index">{{ $index + 1 }}</span>\n                        </div>\n                        <div class="col-xs-2 text-right">\n                            <div class="btn-group" role="group">\n                                <button type="button" class="btn btn-default" data-ng-click="$ctrl.playRegion(region)" title="{{\'play_pause_region\' | trans:{}:\'media_resource\'}}">\n                                    |-&nbsp;<i class="fa fa-play"></i>&nbsp;-|\n                                </button>\n                                <button role="button" type="button" data-ng-class="$ctrl.hasHelp(region.helps) ? \'btn-warning\':\'btn-default\'" class="btn" data-ng-click="$ctrl.configureRegionHelps(region)" title="{{\'region_config\' | trans:{}:\'media_resource\'}}">\n                                    <i class="fa fa-cog"></i>\n                                </button>\n                                <button\n                                    role="button"\n                                    data-ng-disabled="$ctrl.resource.regions.length === 1"\n                                    type="button"\n                                    class="btn btn-danger"\n                                    data-confirm-modal="{{ \'delete_region_confirm\'|trans:{}:\'media_resource\'}}"\n                                    data-confirm-modal-action="$ctrl.deleteRegion(region)"\n                                    title="{{\'region_delete\' | trans:{}:\'media_resource\'}}">\n                                    <i class="fa fa-trash-o"></i>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- Toggleable annotation buttons panel -->\n    <div class="panel panel-primary annotation-panel">\n        <div class="panel-heading clearfix">\n            <h3 class="panel-title pull-left">{{\'annotation_panel_title\' | trans:{}:\'media_resource\'}}</h3>\n            <button type="button" role="button" title="{{\'show_hide_annotation_panel\' | trans:{}:\'media_resource\'}}" class="btn btn-default fa fa-chevron-up pull-right" data-ng-click="$ctrl.togglePanel($event)"></button>\n        </div>\n        <div class="panel-body">\n            <div class="row annotation-container">\n                <div class="col-md-12">\n                    <div class="annotation-buttons-container text-center">\n                        <button type="button" class="btn annotation-button blue" title="{{\'accent_primary\' | trans:{}:\'media_resource\'}}" data-color="blue" data-ng-click="$ctrl.annotate(\'blue\')">&nbsp;</button>\n                        <button type="button" class="btn annotation-button red" title="{{\'accent_secondary\' | trans:{}:\'media_resource\'}}" data-color="red" data-ng-click="$ctrl.annotate(\'red\')">&nbsp;</button>\n                        <button type="button" class="btn annotation-button orange" title="{{\'accent_weak_vowel\' | trans:{}:\'media_resource\'}}" data-color="orange" data-ng-click="$ctrl.annotate(\'orange\')">&nbsp;</button>\n                        <button type="button" class="btn annotation-button black" title="{{\'accent_no_accent\' | trans:{}:\'media_resource\'}}" data-color="black" data-ng-click="$ctrl.annotate(\'black\')">&nbsp;</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- POPOVER(s) TEMPLATES -->\n    <script type="text/ng-template" id="popover.players.html">\n        <div class="row">\n            <div class="col-md-12">\n                <ul>\n                    <li>\n                        <b>{{\'options_form_view_mode_choices_live\' | trans:{}:\'media_resource\'}}</b>: {{\'popover_players_live\' | trans:{}:\'media_resource\'}}\n                    </li>\n                    <li>\n                        <b>{{\'options_form_view_mode_choices_active\' | trans:{}:\'media_resource\'}}</b>: {{\'popover_players_active\' | trans:{}:\'media_resource\'}}\n                    </li>\n                    <li>\n                        <b>{{\'options_form_view_mode_choices_pause\' | trans:{}:\'media_resource\'}}</b>: {{\'popover_players_pause\' | trans:{}:\'media_resource\'}}\n                    </li>\n                    <li>\n                        <b>{{\'options_form_view_mode_choices_scripted_active\' | trans:{}:\'media_resource\'}}</b>: {{\'popover_players_scripted\' | trans:{}:\'media_resource\'}}\n                    </li>\n                    <li>\n                        <b>{{\'options_form_view_mode_choices_free\' | trans:{}:\'media_resource\'}}</b>: {{\'popover_players_free\' | trans:{}:\'media_resource\'}}\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </script>\n\n    <script type="text/ng-template" id="popover.transcription.html">\n        <div class="row">\n            <div class="col-md-12">\n              <p>\n                {{\'popover_transcription_popover_explain_first\' | trans:{}:\'media_resource\'}}\n              </p>\n              <p>\n                {{\'popover_transcription_popover_explain_second\' | trans:{}:\'media_resource\'}}\n              </p>\n            </div>\n        </div>\n    </script>\n\n</div>\n'}});