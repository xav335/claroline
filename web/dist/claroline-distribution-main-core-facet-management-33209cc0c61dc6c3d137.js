webpackJsonp([3],{0:function(module,exports,__webpack_require__){"use strict";__webpack_require__(10);var _angularBootstrap=__webpack_require__(5);var _angularBootstrap2=_interopRequireDefault(_angularBootstrap);var _angularTranslation=__webpack_require__(6);var _angularTranslation2=_interopRequireDefault(_angularTranslation);var _angularDragula=__webpack_require__(129);var _angularDragula2=_interopRequireDefault(_angularDragula);var _interceptorsDefault=__webpack_require__(89);var _interceptorsDefault2=_interopRequireDefault(_interceptorsDefault);var _FacetManagementDirective=__webpack_require__(131);var _FacetManagementDirective2=_interopRequireDefault(_FacetManagementDirective);var _ModalController=__webpack_require__(145);var _ModalController2=_interopRequireDefault(_ModalController);var _FieldModalController=__webpack_require__(146);var _FieldModalController2=_interopRequireDefault(_FieldModalController);var _FacetRolesController=__webpack_require__(147);var _FacetRolesController2=_interopRequireDefault(_FacetRolesController);var _PanelRolesController=__webpack_require__(148);var _PanelRolesController2=_interopRequireDefault(_PanelRolesController);__webpack_require__(149);__webpack_require__(9);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}angular.module("FacetManager",["ui.bootstrap","ui.translation","FormBuilder","ClarolineAPI",(0,_angularDragula2.default)(angular)]).directive("facetManagement",function(){return new _FacetManagementDirective2.default}).controller("ModalController",_ModalController2.default).controller("FieldModalController",_FieldModalController2.default).controller("FacetRolesController",_FacetRolesController2.default).controller("PanelRolesController",_PanelRolesController2.default).config(_interceptorsDefault2.default)},129:function(module,exports,__webpack_require__){var require;var require;(function(global,setImmediate){(function(f){if(true){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.angularDragula=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return require(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var dragulaService=require("./service");var dragulaDirective=require("./directive");function register(angular){var app=angular.module("dragula",["ng"]);app.factory("dragulaService",dragulaService(angular));app.directive("dragula",dragulaDirective(angular));return"dragula"}module.exports=register},{"./directive":2,"./service":13}],2:[function(require,module,exports){"use strict";var dragula=require("dragula");function register(angular){return["dragulaService",function angularDragula(dragulaService){return{restrict:"A",scope:{dragulaScope:"=",dragulaModel:"="},link:link};function link(scope,elem,attrs){var dragulaScope=scope.dragulaScope||scope.$parent;var container=elem[0];var name=scope.$eval(attrs.dragula);var drake;var bag=dragulaService.find(dragulaScope,name);if(bag){drake=bag.drake;drake.containers.push(container)}else{drake=dragula({containers:[container]});dragulaService.add(dragulaScope,name,drake)}scope.$watch("dragulaModel",function(newValue,oldValue){if(!newValue){return}if(drake.models){var modelIndex=oldValue?drake.models.indexOf(oldValue):-1;if(modelIndex>=0){drake.models.splice(modelIndex,1,newValue)}else{drake.models.push(newValue)}}else{drake.models=[newValue]}dragulaService.handleModels(dragulaScope,drake)})}}]}module.exports=register},{dragula:5}],3:[function(require,module,exports){module.exports=function atoa(a,n){return Array.prototype.slice.call(a,n)}},{}],4:[function(require,module,exports){"use strict";var cache={};var start="(?:^|\\s)";var end="(?:\\s|$)";function lookupClass(className){var cached=cache[className];if(cached){cached.lastIndex=0}else{cache[className]=cached=new RegExp(start+className+end,"g")}return cached}function addClass(el,className){var current=el.className;if(!current.length){el.className=className}else if(!lookupClass(className).test(current)){el.className+=" "+className}}function rmClass(el,className){el.className=el.className.replace(lookupClass(className)," ").trim()}module.exports={add:addClass,rm:rmClass}},{}],5:[function(require,module,exports){(function(global){"use strict";var emitter=require("contra/emitter");var crossvent=require("crossvent");var classes=require("./classes");var doc=document;var documentElement=doc.documentElement;function dragula(initialContainers,options){var len=arguments.length;if(len===1&&Array.isArray(initialContainers)===false){options=initialContainers;initialContainers=[]}var _mirror;var _source;var _item;var _offsetX;var _offsetY;var _moveX;var _moveY;var _initialSibling;var _currentSibling;var _copy;var _renderTimer;var _lastDropTarget=null;var _grabbed;var o=options||{};if(o.moves===void 0){o.moves=always}if(o.accepts===void 0){o.accepts=always}if(o.invalid===void 0){o.invalid=invalidTarget}if(o.containers===void 0){o.containers=initialContainers||[]}if(o.isContainer===void 0){o.isContainer=never}if(o.copy===void 0){o.copy=false}if(o.copySortSource===void 0){o.copySortSource=false}if(o.revertOnSpill===void 0){o.revertOnSpill=false}if(o.removeOnSpill===void 0){o.removeOnSpill=false}if(o.direction===void 0){o.direction="vertical"}if(o.ignoreInputTextSelection===void 0){o.ignoreInputTextSelection=true}if(o.mirrorContainer===void 0){o.mirrorContainer=doc.body}var drake=emitter({containers:o.containers,start:manualStart,end:end,cancel:cancel,remove:remove,destroy:destroy,dragging:false});if(o.removeOnSpill===true){drake.on("over",spillOver).on("out",spillOut)}events();return drake;function isContainer(el){return drake.containers.indexOf(el)!==-1||o.isContainer(el)}function events(remove){var op=remove?"remove":"add";touchy(documentElement,op,"mousedown",grab);touchy(documentElement,op,"mouseup",release)}function eventualMovements(remove){var op=remove?"remove":"add";touchy(documentElement,op,"mousemove",startBecauseMouseMoved)}function movements(remove){var op=remove?"remove":"add";crossvent[op](documentElement,"selectstart",preventGrabbed);crossvent[op](documentElement,"click",preventGrabbed)}function destroy(){events(true);release({})}function preventGrabbed(e){if(_grabbed){e.preventDefault()}}function grab(e){_moveX=e.clientX;_moveY=e.clientY;var ignore=whichMouseButton(e)!==1||e.metaKey||e.ctrlKey;if(ignore){return}var item=e.target;var context=canStart(item);if(!context){return}_grabbed=context;eventualMovements();if(e.type==="mousedown"){if(isInput(item)){item.focus()}else{e.preventDefault()}}}function startBecauseMouseMoved(e){if(!_grabbed){return}if(whichMouseButton(e)===0){release({});return}if(e.clientX!==void 0&&e.clientX===_moveX&&e.clientY!==void 0&&e.clientY===_moveY){return}if(o.ignoreInputTextSelection){var clientX=getCoord("clientX",e);var clientY=getCoord("clientY",e);var elementBehindCursor=doc.elementFromPoint(clientX,clientY);if(isInput(elementBehindCursor)){return}}var grabbed=_grabbed;eventualMovements(true);movements();end();start(grabbed);var offset=getOffset(_item);_offsetX=getCoord("pageX",e)-offset.left;_offsetY=getCoord("pageY",e)-offset.top;classes.add(_copy||_item,"gu-transit");renderMirrorImage();drag(e)}function canStart(item){if(drake.dragging&&_mirror){return}if(isContainer(item)){return}var handle=item;while(getParent(item)&&isContainer(getParent(item))===false){if(o.invalid(item,handle)){return}item=getParent(item);if(!item){return}}var source=getParent(item);if(!source){return}if(o.invalid(item,handle)){return}var movable=o.moves(item,source,handle,nextEl(item));if(!movable){return}return{item:item,source:source}}function manualStart(item){var context=canStart(item);if(context){start(context)}}function start(context){if(isCopy(context.item,context.source)){_copy=context.item.cloneNode(true);drake.emit("cloned",_copy,context.item,"copy")}_source=context.source;_item=context.item;_initialSibling=_currentSibling=nextEl(context.item);drake.dragging=true;drake.emit("drag",_item,_source)}function invalidTarget(){return false}function end(){if(!drake.dragging){return}var item=_copy||_item;drop(item,getParent(item))}function ungrab(){_grabbed=false;eventualMovements(true);movements(true)}function release(e){ungrab();if(!drake.dragging){return}var item=_copy||_item;var clientX=getCoord("clientX",e);var clientY=getCoord("clientY",e);var elementBehindCursor=getElementBehindPoint(_mirror,clientX,clientY);var dropTarget=findDropTarget(elementBehindCursor,clientX,clientY);if(dropTarget&&(_copy&&o.copySortSource||(!_copy||dropTarget!==_source))){drop(item,dropTarget)}else if(o.removeOnSpill){remove()}else{cancel()}}function drop(item,target){var parent=getParent(item);if(_copy&&o.copySortSource&&target===_source){parent.removeChild(_item)}if(isInitialPlacement(target)){drake.emit("cancel",item,_source,_source)}else{drake.emit("drop",item,target,_source,_currentSibling)}cleanup()}function remove(){if(!drake.dragging){return}var item=_copy||_item;var parent=getParent(item);if(parent){parent.removeChild(item)}drake.emit(_copy?"cancel":"remove",item,parent,_source);cleanup()}function cancel(revert){if(!drake.dragging){return}var reverts=arguments.length>0?revert:o.revertOnSpill;var item=_copy||_item;var parent=getParent(item);if(parent===_source&&_copy){parent.removeChild(_copy)}var initial=isInitialPlacement(parent);if(initial===false&&!_copy&&reverts){_source.insertBefore(item,_initialSibling)}if(initial||reverts){drake.emit("cancel",item,_source,_source)}else{drake.emit("drop",item,parent,_source,_currentSibling)}cleanup()}function cleanup(){var item=_copy||_item;ungrab();removeMirrorImage();if(item){classes.rm(item,"gu-transit")}if(_renderTimer){clearTimeout(_renderTimer)}drake.dragging=false;if(_lastDropTarget){drake.emit("out",item,_lastDropTarget,_source)}drake.emit("dragend",item);_source=_item=_copy=_initialSibling=_currentSibling=_renderTimer=_lastDropTarget=null}function isInitialPlacement(target,s){var sibling;if(s!==void 0){sibling=s}else if(_mirror){sibling=_currentSibling}else{sibling=nextEl(_copy||_item)}return target===_source&&sibling===_initialSibling}function findDropTarget(elementBehindCursor,clientX,clientY){var target=elementBehindCursor;while(target&&!accepted()){target=getParent(target)}return target;function accepted(){var droppable=isContainer(target);if(droppable===false){return false}var immediate=getImmediateChild(target,elementBehindCursor);var reference=getReference(target,immediate,clientX,clientY);var initial=isInitialPlacement(target,reference);if(initial){return true}return o.accepts(_item,target,_source,reference)}}function drag(e){if(!_mirror){return}e.preventDefault();var clientX=getCoord("clientX",e);var clientY=getCoord("clientY",e);var x=clientX-_offsetX;var y=clientY-_offsetY;_mirror.style.left=x+"px";_mirror.style.top=y+"px";var item=_copy||_item;var elementBehindCursor=getElementBehindPoint(_mirror,clientX,clientY);var dropTarget=findDropTarget(elementBehindCursor,clientX,clientY);var changed=dropTarget!==null&&dropTarget!==_lastDropTarget;if(changed||dropTarget===null){out();_lastDropTarget=dropTarget;over()}var parent=getParent(item);if(dropTarget===_source&&_copy&&!o.copySortSource){if(parent){parent.removeChild(item)}return}var reference;var immediate=getImmediateChild(dropTarget,elementBehindCursor);if(immediate!==null){reference=getReference(dropTarget,immediate,clientX,clientY)}else if(o.revertOnSpill===true&&!_copy){reference=_initialSibling;dropTarget=_source}else{if(_copy&&parent){parent.removeChild(item)}return}if(reference===null||reference!==item&&reference!==nextEl(item)&&reference!==_currentSibling){_currentSibling=reference;dropTarget.insertBefore(item,reference);drake.emit("shadow",item,dropTarget,_source)}function moved(type){drake.emit(type,item,_lastDropTarget,_source)}function over(){if(changed){moved("over")}}function out(){if(_lastDropTarget){moved("out")}}}function spillOver(el){classes.rm(el,"gu-hide")}function spillOut(el){if(drake.dragging){classes.add(el,"gu-hide")}}function renderMirrorImage(){if(_mirror){return}var rect=_item.getBoundingClientRect();_mirror=_item.cloneNode(true);_mirror.style.width=getRectWidth(rect)+"px";_mirror.style.height=getRectHeight(rect)+"px";classes.rm(_mirror,"gu-transit");classes.add(_mirror,"gu-mirror");o.mirrorContainer.appendChild(_mirror);touchy(documentElement,"add","mousemove",drag);classes.add(o.mirrorContainer,"gu-unselectable");drake.emit("cloned",_mirror,_item,"mirror")}function removeMirrorImage(){if(_mirror){classes.rm(o.mirrorContainer,"gu-unselectable");touchy(documentElement,"remove","mousemove",drag);getParent(_mirror).removeChild(_mirror);_mirror=null}}function getImmediateChild(dropTarget,target){var immediate=target;while(immediate!==dropTarget&&getParent(immediate)!==dropTarget){immediate=getParent(immediate)}if(immediate===documentElement){return null}return immediate}function getReference(dropTarget,target,x,y){var horizontal=o.direction==="horizontal";var reference=target!==dropTarget?inside():outside();return reference;function outside(){var len=dropTarget.children.length;var i;var el;var rect;for(i=0;i<len;i++){el=dropTarget.children[i];rect=el.getBoundingClientRect();if(horizontal&&rect.left>x){return el}if(!horizontal&&rect.top>y){return el}}return null}function inside(){var rect=target.getBoundingClientRect();if(horizontal){return resolve(x>rect.left+getRectWidth(rect)/2)}return resolve(y>rect.top+getRectHeight(rect)/2)}function resolve(after){return after?nextEl(target):target}}function isCopy(item,container){return typeof o.copy==="boolean"?o.copy:o.copy(item,container)}}function touchy(el,op,type,fn){var touch={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"};var pointers={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"};var microsoft={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};if(global.navigator.pointerEnabled){crossvent[op](el,pointers[type],fn)}else if(global.navigator.msPointerEnabled){crossvent[op](el,microsoft[type],fn)}else{crossvent[op](el,touch[type],fn);crossvent[op](el,type,fn)}}function whichMouseButton(e){if(e.touches!==void 0){return e.touches.length}if(e.buttons!==void 0){return e.buttons}if(e.which!==void 0){return e.which}var button=e.button;if(button!==void 0){return button&1?1:button&2?3:button&4?2:0}}function getOffset(el){var rect=el.getBoundingClientRect();return{left:rect.left+getScroll("scrollLeft","pageXOffset"),top:rect.top+getScroll("scrollTop","pageYOffset")}}function getScroll(scrollProp,offsetProp){if(typeof global[offsetProp]!=="undefined"){return global[offsetProp]}if(documentElement.clientHeight){return documentElement[scrollProp]}return doc.body[scrollProp]}function getElementBehindPoint(point,x,y){var p=point||{};var state=p.className;var el;p.className+=" gu-hide";el=doc.elementFromPoint(x,y);p.className=state;return el}function never(){return false}function always(){return true}function getRectWidth(rect){return rect.width||rect.right-rect.left}function getRectHeight(rect){return rect.height||rect.bottom-rect.top}function getParent(el){return el.parentNode===doc?null:el.parentNode}function isInput(el){return el.tagName==="INPUT"||el.tagName==="TEXTAREA"||el.tagName==="SELECT"||isEditable(el)}function isEditable(el){if(!el){return false}if(el.contentEditable==="false"){return false}if(el.contentEditable==="true"){return true}return isEditable(getParent(el))}function nextEl(el){return el.nextElementSibling||manually();function manually(){var sibling=el;do{sibling=sibling.nextSibling}while(sibling&&sibling.nodeType!==1);return sibling}}function getEventHost(e){if(e.targetTouches&&e.targetTouches.length){return e.targetTouches[0]}if(e.changedTouches&&e.changedTouches.length){return e.changedTouches[0]}return e}function getCoord(coord,e){var host=getEventHost(e);var missMap={pageX:"clientX",pageY:"clientY"};if(coord in missMap&&!(coord in host)&&missMap[coord]in host){coord=missMap[coord]}return host[coord]}module.exports=dragula}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./classes":4,"contra/emitter":7,crossvent:10}],6:[function(require,module,exports){"use strict";var ticky=require("ticky");module.exports=function debounce(fn,args,ctx){if(!fn){return}ticky(function run(){fn.apply(ctx||null,args||[])})}},{ticky:8}],7:[function(require,module,exports){"use strict";var atoa=require("atoa");var debounce=require("./debounce");module.exports=function emitter(thing,options){var opts=options||{};var evt={};if(thing===undefined){thing={}}thing.on=function(type,fn){if(!evt[type]){evt[type]=[fn]}else{evt[type].push(fn)}return thing};thing.once=function(type,fn){fn._once=true;thing.on(type,fn);return thing};thing.off=function(type,fn){var c=arguments.length;if(c===1){delete evt[type]}else if(c===0){evt={}}else{var et=evt[type];if(!et){return thing}et.splice(et.indexOf(fn),1)}return thing};thing.emit=function(){var args=atoa(arguments);return thing.emitterSnapshot(args.shift()).apply(this,args)};thing.emitterSnapshot=function(type){var et=(evt[type]||[]).slice(0);return function(){var args=atoa(arguments);var ctx=this||thing;if(type==="error"&&opts.throws!==false&&!et.length){throw args.length===1?args[0]:args}et.forEach(function emitter(listen){if(opts.async){debounce(listen,args,ctx)}else{listen.apply(ctx,args)}if(listen._once){thing.off(type,listen)}});return thing}};return thing}},{"./debounce":6,atoa:3}],8:[function(require,module,exports){var si=typeof setImmediate==="function",tick;if(si){tick=function(fn){setImmediate(fn)}}else{tick=function(fn){setTimeout(fn,0)}}module.exports=tick},{}],9:[function(require,module,exports){(function(global){var NativeCustomEvent=global.CustomEvent;function useNative(){try{var p=new NativeCustomEvent("cat",{detail:{foo:"bar"}});return"cat"===p.type&&"bar"===p.detail.foo}catch(e){}return false}module.exports=useNative()?NativeCustomEvent:"function"===typeof document.createEvent?function CustomEvent(type,params){var e=document.createEvent("CustomEvent");if(params){e.initCustomEvent(type,params.bubbles,params.cancelable,params.detail)}else{e.initCustomEvent(type,false,false,void 0)}return e}:function CustomEvent(type,params){var e=document.createEventObject();e.type=type;if(params){e.bubbles=Boolean(params.bubbles);e.cancelable=Boolean(params.cancelable);e.detail=params.detail}else{e.bubbles=false;e.cancelable=false;e.detail=void 0}return e}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],10:[function(require,module,exports){(function(global){"use strict";var customEvent=require("custom-event");var eventmap=require("./eventmap");var doc=global.document;var addEvent=addEventEasy;var removeEvent=removeEventEasy;var hardCache=[];if(!global.addEventListener){addEvent=addEventHard;removeEvent=removeEventHard}module.exports={add:addEvent,remove:removeEvent,fabricate:fabricateEvent};function addEventEasy(el,type,fn,capturing){return el.addEventListener(type,fn,capturing)}function addEventHard(el,type,fn){return el.attachEvent("on"+type,wrap(el,type,fn))}function removeEventEasy(el,type,fn,capturing){return el.removeEventListener(type,fn,capturing)}function removeEventHard(el,type,fn){var listener=unwrap(el,type,fn);if(listener){return el.detachEvent("on"+type,listener)}}function fabricateEvent(el,type,model){var e=eventmap.indexOf(type)===-1?makeCustomEvent():makeClassicEvent();if(el.dispatchEvent){el.dispatchEvent(e)}else{el.fireEvent("on"+type,e)}function makeClassicEvent(){var e;if(doc.createEvent){e=doc.createEvent("Event");e.initEvent(type,true,true)}else if(doc.createEventObject){e=doc.createEventObject()}return e}function makeCustomEvent(){return new customEvent(type,{detail:model})}}function wrapperFactory(el,type,fn){return function wrapper(originalEvent){var e=originalEvent||global.event;e.target=e.target||e.srcElement;e.preventDefault=e.preventDefault||function preventDefault(){e.returnValue=false};e.stopPropagation=e.stopPropagation||function stopPropagation(){e.cancelBubble=true};e.which=e.which||e.keyCode;fn.call(el,e)}}function wrap(el,type,fn){var wrapper=unwrap(el,type,fn)||wrapperFactory(el,type,fn);hardCache.push({wrapper:wrapper,element:el,type:type,fn:fn});return wrapper}function unwrap(el,type,fn){var i=find(el,type,fn);if(i){var wrapper=hardCache[i].wrapper;hardCache.splice(i,1);return wrapper}}function find(el,type,fn){var i,item;for(i=0;i<hardCache.length;i++){item=hardCache[i];if(item.element===el&&item.type===type&&item.fn===fn){return i}}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./eventmap":11,"custom-event":9}],11:[function(require,module,exports){(function(global){"use strict";var eventmap=[];var eventname="";var ron=/^on/;for(eventname in global){if(ron.test(eventname)){eventmap.push(eventname.slice(2))}}module.exports=eventmap}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],12:[function(require,module,exports){"use strict";var atoa=require("atoa");var events=["cancel","cloned","drag","dragend","drop","out","over","remove","shadow","drop-model","remove-model"];function replicateEvents(angular,bag,scope){events.forEach(replicator);function replicator(type){bag.drake.on(type,replicate);function replicate(){var args=atoa(arguments).map(angularize);args.unshift(bag.name+"."+type);scope.$emit.apply(scope,args)}}function angularize(value){if(angular.isElement(value)){return angular.element(value)}return value}}module.exports=replicateEvents},{atoa:3}],13:[function(require,module,exports){"use strict";var dragula=require("dragula");var dragulaKey="$$dragula";var replicateEvents=require("./replicate-events");function register(angular){return[function dragulaService(){return{add:add,find:find,options:setOptions,destroy:destroy,handleModels:handleModels};function handleModels(scope,drake){if(drake.registered){return}var dragElm;var dragIndex;var dropIndex;var sourceModel;drake.on("remove",function removeModel(el,source){if(!drake.models){return}sourceModel=drake.models[drake.containers.indexOf(source)];scope.$applyAsync(function applyRemove(){sourceModel.splice(dragIndex,1);drake.emit("remove-model",el,source)})});drake.on("drag",function dragModel(el,source){dragElm=el;dragIndex=domIndexOf(el,source)});drake.on("drop",function dropModel(dropElm,target,source){if(!drake.models){return}dropIndex=domIndexOf(dropElm,target);scope.$applyAsync(function applyDrop(){sourceModel=drake.models[drake.containers.indexOf(source)];if(target===source){sourceModel.splice(dropIndex,0,sourceModel.splice(dragIndex,1)[0])}else{var notCopy=dragElm===dropElm;var targetModel=drake.models[drake.containers.indexOf(target)];var dropElmModel=notCopy?sourceModel[dragIndex]:angular.copy(sourceModel[dragIndex]);if(notCopy){sourceModel.splice(dragIndex,1)}targetModel.splice(dropIndex,0,dropElmModel);target.removeChild(dropElm)}drake.emit("drop-model",dropElm,target,source)})});drake.registered=true}function getOrCreateCtx(scope){var ctx=scope[dragulaKey];if(!ctx){ctx=scope[dragulaKey]={bags:[]}}return ctx}function domIndexOf(child,parent){return Array.prototype.indexOf.call(angular.element(parent).children(),child)}function add(scope,name,drake){var bag=find(scope,name);if(bag){throw new Error('Bag named: "'+name+'" already exists in same angular scope.')}var ctx=getOrCreateCtx(scope);bag={name:name,drake:drake};ctx.bags.push(bag);replicateEvents(angular,bag,scope);if(drake.models){handleModels(scope,drake)}return bag}function find(scope,name){var bags=getOrCreateCtx(scope).bags;for(var i=0;i<bags.length;i++){if(bags[i].name===name){return bags[i]}}}function destroy(scope,name){var bags=getOrCreateCtx(scope).bags;var bag=find(scope,name);var i=bags.indexOf(bag);bags.splice(i,1);bag.drake.destroy()}function setOptions(scope,name,options){var bag=add(scope,name,dragula(options));handleModels(scope,bag.drake)}}]}module.exports=register},{"./replicate-events":12,dragula:5}]},{},[1])(1)})}).call(exports,function(){return this}(),__webpack_require__(130).setImmediate)},130:function(module,exports,__webpack_require__){module.exports=__webpack_require__(3)(29)},131:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _FacetController=__webpack_require__(132);var _FacetController2=_interopRequireDefault(_FacetController);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FacetManagementDirective=function FacetManagementDirective(){(0,_classCallCheck3.default)(this,FacetManagementDirective);this.scope={};this.restrict="E";this.template=__webpack_require__(144);this.replace=false;this.controller=_FacetController2.default;this.controllerAs="fc"};exports.default=FacetManagementDirective},132:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _Facet=__webpack_require__(133);var _Facet2=_interopRequireDefault(_Facet);var _Field=__webpack_require__(135);var _Field2=_interopRequireDefault(_Field);var _Panel=__webpack_require__(136);var _Panel2=_interopRequireDefault(_Panel);var _PanelRole=__webpack_require__(137);var _PanelRole2=_interopRequireDefault(_PanelRole);var _ProfilePreference=__webpack_require__(138);var _ProfilePreference2=_interopRequireDefault(_ProfilePreference);var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);var _facet_form=__webpack_require__(139);var _facet_form2=_interopRequireDefault(_facet_form);var _facet_roles_form=__webpack_require__(140);var _facet_roles_form2=_interopRequireDefault(_facet_roles_form);var _panel_form=__webpack_require__(141);var _panel_form2=_interopRequireDefault(_panel_form);var _field_form=__webpack_require__(142);var _field_form2=_interopRequireDefault(_field_form);var _panel_roles_form=__webpack_require__(143);var _panel_roles_form2=_interopRequireDefault(_panel_roles_form);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FacetController=function(){function FacetController($http,$uibModal,FormBuilderService,ClarolineAPIService,dragulaService,$scope){var _this=this;(0,_classCallCheck3.default)(this,FacetController);this.$http=$http;this.$uibModal=$uibModal;this.FormBuilderService=FormBuilderService;this.ClarolineAPIService=ClarolineAPIService;this.dragulaService=dragulaService;this.facets=[];this.mainFacets=[];this.tabFacets=[];this.platformRoles=[];this.profilePreferences=[];this.alerts=[];this.$scope=$scope;$http.get(Routing.generate("api_get_facets")).then(function(d){_this.facets=d.data;_this.mainFacets=_this.facets.filter(function(el){return el.is_main});_this.tabFacets=_this.facets.filter(function(el){return!el.is_main})});$http.get(Routing.generate("api_get_platform_roles_admin_excluded")).then(function(d){return _this.platformRoles=d.data});$http.get(Routing.generate("api_get_profile_preferences")).then(function(d){_this.profilePreferences=d.data});this.formFacet=_Facet2.default;this.formPanel=_Panel2.default;this.formField=_Field2.default;this.formPanelRole=_PanelRole2.default;this.formProfilePreference=_ProfilePreference2.default;dragulaService.options($scope,"facet-bag",{moves:function moves(el,container,handle){return handle.className==="handle"}});dragulaService.options($scope,"panel-bag",{moves:function moves(el,container,target){return!target.classList.contains("list-group-item")}});$scope.$on("panel-bag.drop",this.onPanelBagDrop.bind(this));$scope.$on("field-bag.drop",this.onFieldBagDrop.bind(this))}(0,_createClass3.default)(FacetController,[{key:"closeAlert",value:function closeAlert(index){this.alerts.splice(index,1)}},{key:"onPanelBagDrop",value:function onPanelBagDrop(el,target,source){var _this2=this;var facetId=parseInt(source.attr("data-facet-id"));var container=null;this.facets.forEach(function(facet){if(facet.id===facetId)container=facet});if(container){(function(){var list=[];container.panels.forEach(function(panel){list.unshift(panel.id)});var qs=_this2.FormBuilderService.generateQueryString(list,"ids");_this2.$http.put(Routing.generate("api_put_panels_order",{facet:facetId})+"?"+qs).then(function(){},function(){_this2.ClarolineAPIService.errorModal()})})()}}},{key:"onFieldBagDrop",value:function onFieldBagDrop(el,target){var _this3=this;var container=null;var panelId=parseInt(target.attr("data-panel-id"));this.facets.forEach(function(facet){facet.panels.forEach(function(panel){if(panel.id===panelId)container=panel})});if(container){(function(){var panelId=parseInt(target.attr("data-panel-id"));var list=[];container.fields.forEach(function(field){list.unshift(field.id)});var qs=_this3.FormBuilderService.generateQueryString(list,"ids");_this3.$http.put(Routing.generate("api_put_fields_order",{panel:panelId})+"?"+qs).then(function(){},function(){return _this3.ClarolineAPIService.errorModal()})})()}}},{key:"onAddFacetFormRequest",value:function onAddFacetFormRequest(){var _this4=this;var modalInstance=this.$uibModal.open({template:_facet_form2.default,controller:"ModalController",controllerAs:"mc",resolve:{form:function form(){return _this4.formFacet},title:function title(){return"create_facet"},submit:function submit(){return"create"},model:function model(){return{}}}});modalInstance.result.then(function(result){if(!result)return;_this4.FormBuilderService.submit(Routing.generate("api_post_facet"),{facet:result}).then(function(d){_this4.facets.push(d.data);_this4.alerts.push({type:"success",msg:_this4.translate("facet_created")})},function(){return _this4.ClarolineAPIService.errorModal()})})}},{key:"onEditFacetFormRequest",value:function onEditFacetFormRequest(facet){var _this5=this;var modalInstance=this.$uibModal.open({template:_facet_form2.default,controller:"ModalController",controllerAs:"mc",resolve:{form:function form(){return _this5.formFacet},title:function title(){return"edit_facet"},submit:function submit(){return"edit"},model:function model(){return facet}}});modalInstance.result.then(function(result){if(!result)return;_this5.FormBuilderService.submit(Routing.generate("api_put_facet",{facet:result.id}),{facet:result},"PUT").then(function(){_this5.alerts.push({type:"success",msg:_this5.translate("facet_edited")})},function(){return _this5.ClarolineAPIService.errorModal()})})}},{key:"onDeleteFacet",value:function onDeleteFacet(facet){var url=Routing.generate("api_delete_facet",{facet:facet.id});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},function(){this.ClarolineAPIService.removeElements([facet],this.facets);this.alerts.push({type:"success",msg:this.translate("facet_removed")})}.bind(this),Translator.trans("delete_facet",{},"platform"),Translator.trans("delete_facet_confirm","platform"))}},{key:"onSetFacetRoles",value:function onSetFacetRoles(_facet){var _this6=this;var modalInstance=this.$uibModal.open({template:_facet_roles_form2.default,controller:"FacetRolesController",controllerAs:"frc",resolve:{facet:function facet(){return _facet},platformRoles:function platformRoles(){
return _this6.platformRoles}}});modalInstance.result.then(function(facet){var roles=facet.roles;var qs=_this6.FormBuilderService.generateQueryString(roles,"ids");var route=Routing.generate("api_put_facet_roles",{facet:facet.id})+"?"+qs;_this6.$http.put(route).then(function(){_this6.alerts.push({type:"success",msg:_this6.translate("facet_roles_edited")})},function(){return _this6.ClarolineAPIService.errorModal()})})}},{key:"onAddPanelFormRequest",value:function onAddPanelFormRequest(facet){var _this7=this;var modalInstance=this.$uibModal.open({template:_panel_form2.default,controller:"ModalController",controllerAs:"mc",resolve:{form:function form(){return _this7.formPanel},title:function title(){return"create_panel"},submit:function submit(){return"create"},model:function model(){return{}}}});modalInstance.result.then(function(result){if(!result)return;_this7.FormBuilderService.submit(Routing.generate("api_post_panel_facet",{facet:facet.id}),{panel:result}).then(function(d){if(!facet.panels)facet.panels=[];facet.panels.push(d.data);_this7.alerts.push({type:"success",msg:_this7.translate("panel_created")})},function(){return _this7.ClarolineAPIService.errorModal()})})}},{key:"onEditPanelFormRequest",value:function onEditPanelFormRequest(panel){var _this8=this;this.formPanel.model=panel;var modalInstance=this.$uibModal.open({template:_panel_form2.default,controller:"ModalController",controllerAs:"mc",resolve:{form:function form(){return _this8.formPanel},title:function title(){return"edit_panel"},submit:function submit(){return"edit"},model:function model(){return panel}}});modalInstance.result.then(function(result){if(!result)return;_this8.FormBuilderService.submit(Routing.generate("api_put_panel_facet",{panel:panel.id}),{panel:result},"PUT").then(function(){_this8.alerts.push({type:"success",msg:_this8.translate("panel_edited")})},function(){return _this8.ClarolineAPIService.errorModal()})})}},{key:"onDeletePanel",value:function onDeletePanel(panel){var url=Routing.generate("api_delete_panel_facet",{panel:panel.id});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},function(){this.facets.forEach(function(facet){facet.panels.forEach(function(){var idx=facet.panels.indexOf(panel);if(idx>-1)facet.panels.splice(idx,1)})})}.bind(this),Translator.trans("delete_panel",{},"platform"),Translator.trans("delete_panel_confirm","platform"));this.alerts.push({type:"success",msg:this.translate("panel_removed")})}},{key:"onAddFieldFormRequest",value:function onAddFieldFormRequest(panel){var _this9=this;var modalInstance=this.$uibModal.open({template:_field_form2.default,controller:"FieldModalController",controllerAs:"fmc",resolve:{form:function form(){return _this9.formField},title:function title(){return"create_field"},submit:function submit(){return"create"},model:function model(){return{}}}});modalInstance.result.then(function(result){if(!result)return;_this9.FormBuilderService.submit(Routing.generate("api_post_field_facet",{panel:panel.id}),{field:result}).then(function(d){if(!panel.fields)panel.fields=[];panel.fields.push(d.data);_this9.alerts.push({type:"success",msg:_this9.translate("field_created")})},function(){return _this9.ClarolineAPIService.errorModal()})})}},{key:"onEditFieldFormRequest",value:function onEditFieldFormRequest(field){var _this10=this;this.formField.model=field;var modalInstance=this.$uibModal.open({template:_field_form2.default,controller:"FieldModalController",controllerAs:"fmc",resolve:{form:function form(){return _this10.formField},title:function title(){return"edit_field"},submit:function submit(){return"edit"},model:function model(){return field}}});modalInstance.result.then(function(result){if(!result)return;_this10.FormBuilderService.submit(Routing.generate("api_put_field_facet",{field:field.id}),{field:result},"PUT").then(function(){_this10.alerts.push({type:"success",msg:_this10.translate("field_edited")})},function(){return _this10.ClarolineAPIService.errorModal()})})}},{key:"onDeleteField",value:function onDeleteField(field){var url=Routing.generate("api_delete_field_facet",{field:field.id});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},function(){this.facets.forEach(function(facet){facet.panels.forEach(function(panel){panel.fields.forEach(function(){var idx=panel.fields.indexOf(field);if(idx>-1)panel.fields.splice(idx,1)})})})}.bind(this),Translator.trans("delete_field",{},"platform"),Translator.trans("delete_field_confirm","platform"));this.alerts.push({type:"success",msg:this.translate("field_removed")})}},{key:"onSetPanelRoles",value:function onSetPanelRoles(_panel){var _this11=this;var modalInstance=this.$uibModal.open({template:_panel_roles_form2.default,controller:"PanelRolesController",controllerAs:"firc",resolve:{panel:function panel(){return _panel},platformRoles:function platformRoles(){return _this11.platformRoles},form:function form(){return _this11.formPanelRole}}});modalInstance.result.then(function(panel){_this11.FormBuilderService.submit(Routing.generate("api_put_panel_roles",{panel:panel.id}),{roles:panel.panel_facets_role,is_editable:panel.is_editable},"PUT").then(function(){_this11.alerts.push({type:"success",msg:_this11.translate("panel_roles_edited")})},function(){return _this11.ClarolineAPIService.errorModal()})})}},{key:"onSubmitProfilePreferences",value:function onSubmitProfilePreferences(){var _this12=this;this.FormBuilderService.submit(Routing.generate("api_put_profile_preferences"),{preferences:this.profilePreferences},"PUT").then(function(){_this12.alerts.push({type:"success",msg:_this12.translate("profile_preference_edited")})},function(){return _this12.ClarolineAPIService.errorModal()})}},{key:"translate",value:function translate(msg){return Translator.trans(msg,{},"platform")}},{key:"onFacetDown",value:function onFacetDown(facet){var _this13=this;var length=facet.is_main?this.mainFacets.length:this.tabFacets.length;if(facet.position<length-1){this.$http.put(Routing.generate("api_move_facet_down",{facet:facet.id})).then(function(d){facet=d.data;var list=facet.is_main?_index2.default.copy(_this13.mainFacets):_index2.default.copy(_this13.tabFacets);var b=list[facet.position-1];list[facet.position-1]=list[facet.position];list[facet.position]=b;facet.is_main?_this13.mainFacets=list:_this13.tabFacets=list})}}},{key:"onFacetUp",value:function onFacetUp(facet){var _this14=this;if(facet.position>0){this.$http.put(Routing.generate("api_move_facet_up",{facet:facet.id})).then(function(d){facet=d.data;var list=facet.is_main?_index2.default.copy(_this14.mainFacets):_index2.default.copy(_this14.tabFacets);var b=list[facet.position+1];list[facet.position+1]=list[facet.position];list[facet.position]=b;facet.is_main?_this14.mainFacets=list:_this14.tabFacets=list})}}}]);return FacetController}();exports.default=FacetController},133:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _NotBlank=__webpack_require__(134);var _NotBlank2=_interopRequireDefault(_NotBlank);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={fields:[["name","text",{validators:[new _NotBlank2.default],label:"name"}],["force_creation_form","checkbox",{label:"display_at_registration"}],["is_main","checkbox",{label:"is_main_facet_label"}]]}},134:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var NotBlank=function(){function NotBlank(){(0,_classCallCheck3.default)(this,NotBlank)}(0,_createClass3.default)(NotBlank,[{key:"validate",value:function validate(el){return!(el===undefined||el===""||el===null)}},{key:"getErrorMessage",value:function getErrorMessage(el){return Translator.trans("value_not_blank",{},"validators")}}]);return NotBlank}();exports.default=NotBlank},135:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _NotBlank=__webpack_require__(134);var _NotBlank2=_interopRequireDefault(_NotBlank);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={fields:[["name","text",{validators:[new _NotBlank2.default],label:"name"}],["is_required","checkbox",{label:"mandatory"}],["type","select",{values:[{value:1,label:"text"},{value:2,label:"number"},{value:3,label:"date"},{value:4,label:"radio"},{value:5,label:"select"},{value:6,label:"checkboxes"},{value:7,label:"country"},{value:8,label:"email"}],default:1,label:"type",choice_value:"value"}]]}},136:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _NotBlank=__webpack_require__(134);var _NotBlank2=_interopRequireDefault(_NotBlank);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={fields:[["name","text",{validators:[new _NotBlank2.default],label:"name"}],["is_default_collapsed","checkbox",{label:"collapse"}]]}},137:function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default={fields:[["can_open","checkbox",{label:""}],["can_edit","checkbox",{label:""}]]}},138:function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default={fields:[["base_data","checkbox",{label:""}],["mail","checkbox",{label:""}],["phone","checkbox",{label:""}],["send_message","checkbox",{label:""}]]}},139:function(module,exports){module.exports='<div class="modal-content">\n    <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="$close()">&times;</button>\n        <h4> {{ mc.title|trans:{}:\'platform\' }} </h4>\n    </div>\n    <div class="modal-body">\n        <div>\n            <form class="form-horizontal" name="facetForm" ng-submit="mc.onSubmit(facetForm)">\n                <formbuilder form="mc.form" ng-model="mc.model" form-ctrl="facetForm"></formbuilder>\n                <input data-ng-disabled="!facetForm.$valid" type="submit" class="btn btn-primary" aria-hidden="true" value="{{ mc.submit|trans:{}:\'platform\' }}"> </input>\n                <button ng-click="$close()" class="btn btn-default" data-dismiss="modal" aria-hidden="true">\n                    {{ \'cancel\'|trans:{}:\'platform \'}}\n                </button>\n            </form>\n        </div>\n    </div>\n</div>\n'},140:function(module,exports){module.exports='<div class="modal-content">\n    <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="$close()">&times;</button>\n        <h4> {{ \'roles_management\'|trans:{}:\'platform\' }} </h4>\n    </div>\n    <div class="modal-body">\n        <div class="well">\n            {{ \'roles_facet_form_explanation\'|trans:{}:\'platform\' }}\n        </div>\n        <div>\n            <form>\n                <table class="table table-striped table-bordered table-condensed">\n                    <thead>\n                        <tr>\n                            <th> {{ \'role\'|trans:{}:\'platform\' }} ({{ frc.facet.name }})</th>\n                            <th> {{ \'show\'|trans:{}:\'platform\' }} </th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr ng-repeat="(key, platformRole) in frc.platformRoles track by platformRole.id">\n                            <td> {{ platformRole.translation_key|trans:{}:\'platform\' }} </td>\n                            <td> <input type="checkbox" checklist-model="frc.facet.roles" checklist-value="platformRole"> </input> </td>\n                        </tr>\n                    </tbody>\n                </table>\n                <input type="submit" class="btn btn-primary" aria-hidden="true" value="{{ \'edit\'|trans:{}:\'platform\' }}" ng-click="frc.onSubmit()"> </input>\n                <button class="btn btn-default" data-dismiss="modal" aria-hidden="true" ng-click="$close()">\n                    {{ \'cancel\'|trans:{}:\'platform \'}}\n                </button>\n            </form>\n        </div>\n    </div>\n</div>\n'},141:function(module,exports){module.exports='<div class="modal-content">\n    <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="$close()">&times;</button>\n        <h4> {{ mc.title|trans:{}:\'platform\' }} </h4>\n    </div>\n    <div class="modal-body">\n        <div>\n            <form class="form-horizontal" name="panelForm" ng-submit="mc.onSubmit(panelForm)">\n                <formbuilder form="mc.form" ng-model="mc.model" form-ctrl="panelForm"></formbuilder>\n                <input data-ng-disabled="!panelForm.$valid" type="submit" class="btn btn-primary" aria-hidden="true" value="{{ mc.submit|trans:{}:\'platform\' }}"> </input>\n                <button ng-click="$close()" class="btn btn-default" data-dismiss="modal" aria-hidden="true"> {{ \'cancel\'|trans:{}:\'platform \'}} </button>\n            </form>\n        </div>\n    </div>\n</div>\n'},142:function(module,exports){module.exports='<div class="modal-content">\n    <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="$close()">&times;</button>\n        <h4> {{ fmc.title|trans:{}:\'platform\' }} </h4>\n    </div>\n    <div class="modal-body">\n        <div>\n            <form name="fieldForm">\n                <form-field field="fmc.form.fields[0]" ng-model="fmc.model.name"></form-field>\n                <form-field field="fmc.form.fields[1]" ng-model="fmc.model.is_required"></form-field>\n                <form-field field="fmc.form.fields[2]" ng-model="fmc.model.type"></form-field>\n                <div ng-if="(fmc.model.type === 4 || fmc.model.type === 5 || fmc.model.type === 6)">\n                    <div dragula=\'"choice-bag"\' dragula-scope="$parent" dragula-model="fmc.model.field_facet_choices">\n                        <div ng-repeat="(key, choice) in fmc.model.field_facet_choices track by choice.id"\n                            class="row"\n                        >\n                            <div>\n                                <div class="col-xs-10"><form-field field="[\'choice\', \'text\']" ng-model="choice.label"></form-field></div>\n                                <div><button class="btn btn-primary btn-danger btn-xs " ng-click="fmc.removeChoice(choice)">x</button></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-xs-10"><form-field field="[\'choice\', \'text\']" ng-model="fmc.newChoice.label"></form-field></div>\n                        <div><button ng-click="fmc.addChoice()" class="btn btn-primary btn-xs btn-success">+</button></div>\n                    </div>\n                </div>\n                <input data-ng-disabled="!fieldForm.$valid" ng-click="fmc.onSubmit(fieldForm)" type="submit" class="btn btn-primary" aria-hidden="true" value="{{ fmc.submit|trans:{}:\'platform\' }}"> </input>\n                <button ng-click="$close()" class="btn btn-default" data-dismiss="modal" aria-hidden="true"> {{ \'cancel\'|trans:{}:\'platform \'}} </button>\n            </form>\n        </div>\n    </div>\n</div>\n'},143:function(module,exports){module.exports='<div class="modal-content">\n    <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="$close()">&times;</button>\n        <h4> {{ \'roles_management\'|trans:{}:\'platform\' }} </h4>\n    </div>\n    <div class="modal-body">\n        <div class="well">\n            {{ \'roles_panels_form_explanation\'|trans:{}:\'platform\' }}\n        </div>\n        <form>\n            <table class="table table-striped table-bordered table-condensed">\n                <thead>\n                <tr>\n                    <th> {{ \'role\'|trans:{}:\'platform\' }} ({{ firc.panel.name }})</th>\n                    <th> {{ \'show\'|trans:{}:\'platform\' }} </th>\n                    <th> {{ \'edit\'|trans:{}:\'platform\' }} </th>\n                </tr>\n                </thead>\n                <tbody>\n                    <tr ng-repeat="(key, panelRole) in firc.panel.panel_facets_role">\n                        <td> {{ panelRole.role.translation_key|trans:{}:\'platform\' }} </td>\n                        <td> <form-checkbox field="firc.form.fields[0]" ng-model="panelRole.can_open"></form-checkbox> </td>\n                        <td> <form-checkbox field="firc.form.fields[1]" ng-model="panelRole.can_edit"></form-checkbox> </td>\n                    </tr>\n                </tbody>\n            </table>\n            <div class="col-md-4">\n                <input ng-model="firc.panel.is_editable" type="checkbox" name="is_editable" value="is_editable"></input>\n                <label class="control-label" > {{ \'editable\'|trans:{}:\'platform\' }} </label>\n            </div>\n            <button class="btn btn-primary" aria-hidden="true" ng-click="firc.onSubmit()"> {{ \'edit\'|trans:{}:\'platform\' }} </button>\n            <button class="btn btn-default" data-dismiss="modal" aria-hidden="true" ng-click="$close()">\n                {{ \'cancel\'|trans:{}:\'platform \'}}\n            </button>\n        </form>\n    </div>\n</div>\n'},144:function(module,exports){module.exports='<script type="text/ng-template" id="facet_renderer.html">\n    <div class="panel-body">\n        <div class="panel-group" role="tablelist" aria-multiselectable="true">\n            <ul dragula=\'"panel-bag"\' dragula-scope="$parent" dragula-model="facet.panels" data-facet-id="{{ facet.id }}">\n                <li ng-repeat="(key, panel) in facet.panels" style="list-style-type: none;">\n                    <div class="panel panel-default" style="margin-bottom: 10px;">\n                        <div class="panel-heading" role="tab">\n                            <h4 class="panel-title">\n                                <div class="dropdown pull-left">\n                                    <i class="fa fa-cog pointer-hand" data-toggle="dropdown"></i>\n                                    <ul class="dropdown-menu" role="menu">\n                                        <li role="presentation"><a href="#" ng-click="fc.onEditPanelFormRequest(panel)">{{ "edit"|trans:{}:\'platform\' }}</a></li>\n                                        <li role="presentation"><a href="#" ng-click="fc.onSetPanelRoles(panel)"> {{ "roles"|trans:{}:\'platform\' }} </a>\n                                        <li role="presentation"><a class="pointer" ng-click="fc.onAddFieldFormRequest(panel)" class="add-field-to-panel">{{ \'add_field_to_panel\'|trans:{}:\'platform\' }}</a></li>\n                                    </ul>\n                                </div>\n                                <a data-toggle="collapse" href="#panel-{{ panel.id }}" aria-expanded="true" aria-controls="panel-{{ panel.id}}" id="name-panel-{{ panel.id }}">\n                                    {{ panel.name }}\n                                </a>\n                                <a href=\'#\' class="pull-right" ng-click="fc.onDeletePanel(panel)"> x </a>\n                            </h4>\n                        </div>\n                        <div id="panel-{{ panel.id }}" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="facet-panel-{{ panel.id }}">\n                            <div class="panel-body pointer" dragula=\'"field-bag"\' dragula-scope="$parent" dragula-model="panel.fields">\n                                <div ng-repeat="(key, field) in panel.fields" class="list-group-item" data-panel-id="{{ panel.id }}}">\n                                    <a ng-click="fc.onEditFieldFormRequest(field)" href="#">{{ field.name }} ({{ field.translation_key|trans:{}:\'platform\' }})</a>\n                                    <a class="close" ng-click="fc.onDeleteField(field)" href="#" aria-hidden="true">&times;</a>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n            </ul>\n        </div>\n    </div>\n    <div align="center">\n        <button class="btn btn-primary" ng-click="fc.onAddPanelFormRequest(facet)">\n            <i class="fa fa-plus-circle" data-facet-id="{{ facet.id }}"></i>\n            {{ \'add_panel_to_facet\'|trans:{}: \'platform\' }}\n        </button>\n    </div>\n</script>\n\n<script type="text/ng-template" id="facet_options.html">\n    <div class="dropdown">\n        <i class="fa fa-chevron-down pointer-hand" data-toggle="dropdown"></i>\n        <ul class="dropdown-menu" role="menu">\n            <li role="presentation"><i role="menuitem" ng-click="fc.onFacetUp(facet)" class="fa fa-arrow-left"> {{ "left"|trans:{}:\'platform\' }}</i></li>\n            <li role="presentation"><i role="menuitem" ng-click="fc.onFacetDown(facet)" class="fa fa-arrow-right"> {{ "right"|trans:{}:\'platform\' }}</i></li>\n            <li role="presentation"><i role="menuitem" ng-click="fc.onEditFacetFormRequest(facet)" class="fa fa-pencil"> {{ "edit"|trans:{}:\'platform\' }}</i></li>\n            <li role="presentation"><i role="menuitem" ng-click="fc.onDeleteFacet(facet)" class="fa fa-trash-o"> {{ "delete"|trans:{}:\'platform\' }}</i></li>\n            <li role="presentation"><i role="menuitem" ng-click="fc.onSetFacetRoles(facet)" class="fa fa-user"> {{ "roles"|trans:{}:\'platform\' }}</i></li>\n        </ul>\n    </div>\n</script>\n\n<div>\n    <uib-alert ng-repeat="alert in fc.alerts" type="{{ alert.type }}" close="fc.closeAlert($index)">{{ alert.msg }}</uib-alert>\n    <ul class="nav nav-tabs">\n        <li id="general-tab-btn" class="active">\n            <a href="#general-tab" data-toggle="tab">\n                {{ "general"|trans:{}:\'platform\' }}\n            </a>\n        </li>\n        <li ng-repeat="(key, facet) in fc.tabFacets" id="tab-facet-{{ facet.id }}">\n            <a href="#facet-pane-{{ facet.id }}" data-toggle="tab">\n                {{ facet.name }}\n                <span ng-include="\'facet_options.html\'"></span>\n            </a>\n        </li>\n        <li id="add-facet-btn">\n            <a class="pointer-hand" ng-click="fc.onAddFacetFormRequest()">\n                <i class="fa fa-plus"></i>\n            </a>\n        </li>\n    </ul>\n    <div id="facet-pane" class="tab-content">\n        <div class="tab-pane active" id="general-tab">\n            <div class="tab-pane active" id="general-tab">\n                <div class="panel-heading"></div>\n                <div class="panel-body">\n                    <div>\n                        <form method="post" ng-submit="fc.onSubmitProfilePreferences(formPreferences)" name="formPreferences">\n                            <div class="well"> {{ \'general_tab_form_explanation\'|trans:{}:\'platform\' }} </div>\n                            <table class="table table-striped table-bordered table-condensed">\n                                <thead>\n                                <tr>\n                                    <th> {{ \'role\'|trans:{}:\'platform\' }} </th>\n                                    <th> {{ \'base_informations\'|trans:{}:\'platform\' }} </th>\n                                    <th> {{ \'mail\'|trans:{}:\'platform\' }} </th>\n                                    <th> {{ \'phone\'|trans:{}:\'platform\' }} </th>\n                                    <th> {{ \'public_profile_preferences_allow_message_sending\'|trans:{}:\'platform\' }} </th>\n                                </tr>\n                                </thead>\n                                <tbody>\n                                    <tr ng-repeat="(key, profilePreference) in fc.profilePreferences">\n                                        <td> {{ profilePreference.role.translation_key|trans:{}:\'platform\' }}</td>\n                                        <td> <form-checkbox field="fc.formProfilePreference.fields[0]" ng-model="profilePreference.base_data"> </form-checkbox> </td>\n                                        <td> <form-checkbox field="fc.formProfilePreference.fields[1]" ng-model="profilePreference.mail"> </form-checkbox> </td>\n                                        <td> <form-checkbox field="fc.formProfilePreference.fields[2]" ng-model="profilePreference.phone"> </form-checkbox> </td>\n                                        <td> <form-checkbox field="fc.formProfilePreference.fields[3]" ng-model="profilePreference.send_message"> </form-checkbox> </td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                            <input type="submit" class="btn btn-primary" value="{{ \'edit\'|trans:{}:\'platform\' }}"></input>\n                        </form>\n                        </br>\n                        <div class="facet-main" ng-repeat="(key, facet) in fc.mainFacets">\n                            <h4 align="center">\n                                <span>  {{ facet.name }}  </span>\n                                <span class="dropdown">\n                                    <i class="fa fa-chevron-down pointer-hand" data-toggle="dropdown"></i>\n                                    <ul class="dropdown-menu" role="menu">\n                                        <li role="presentation"><a class="pointer" ng-click="fc.onFacetUp(facet)"><i role="menuitem" class="fa fa-arrow-up"> {{ "up"|trans:{}:\'platform\' }}</i></a></li>\n                                        <li role="presentation"><a class="pointer" ng-click="fc.onFacetDown(facet)"> <i role="menuitem" class="fa fa-arrow-down"> {{ "down"|trans:{}:\'platform\' }}</i></a></li>\n                                        <li role="presentation"><a class="pointer" ng-click="fc.onEditFacetFormRequest(facet)"><i role="menuitem" class="fa fa-pencil"> {{ "edit"|trans:{}:\'platform\' }}</i></a></li>\n                                        <li role="presentation"><a class="pointer" ng-click="fc.onDeleteFacet(facet)" ><i role="menuitem" class="fa fa-trash-o"> {{ "delete"|trans:{}:\'platform\' }}</i></a></li>\n                                        <li role="presentation"><a class="pointer" ng-click="fc.onSetFacetRoles(facet)" ><i role="menuitem" class="fa fa-user"> {{ "roles"|trans:{}:\'platform\' }}</i></a></li>\n                                    </ul>\n                                </span>\n                            </h4>\n                            <div ng-include="\'facet_renderer.html\'"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div ng-repeat="(key, facet) in fc.facets" class="tab-pane" id="facet-pane-{{ facet.id }}" ng-if="!facet.is_main" ng-include="\'facet_renderer.html\'">\n        </div>\n    </div>\n</div>\n'},145:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ModalController=function(){function ModalController(form,title,submit,model,$uibModalInstance){(0,_classCallCheck3.default)(this,ModalController);this.form=form;this.title=title;this.submit=submit;this.model=model;this.$uibModalInstance=$uibModalInstance}(0,_createClass3.default)(ModalController,[{key:"onSubmit",value:function onSubmit(form){if(form.$valid)this.$uibModalInstance.close(this.model)}}]);return ModalController}();exports.default=ModalController},146:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ModalController=function(){function ModalController(form,title,submit,model,$uibModalInstance,$http,FormBuilderService,ClarolineAPIService,dragulaService,$scope){(0,_classCallCheck3.default)(this,ModalController);this.form=form;this.title=title;this.submit=submit;this.model=this.field=model;this.$uibModalInstance=$uibModalInstance;this.FormBuilderService=FormBuilderService;this.ClarolineAPIService=ClarolineAPIService;this.dragulaService=dragulaService;this.newChoice={};this.$http=$http;this.idChoice=1;dragulaService.options($scope,"field-bag",{moves:function moves(el,container,handle){return handle.className==="handle"}})}(0,_createClass3.default)(ModalController,[{key:"onSubmit",value:function onSubmit(form){if(form.$valid)this.$uibModalInstance.close(this.model)}},{key:"addChoice",value:function addChoice(){var _this=this;if(this.model.id){this.FormBuilderService.submit(Routing.generate("api_post_facet_field_choice",{field:this.field.id}),{choice:this.newChoice}).then(function(d){_this.model.field_facet_choices.push(d.data)},function(d){ClarolineAPIService.errorModal()})}else{if(!this.model.field_facet_choices)this.model.field_facet_choices=[];this.model.field_facet_choices.push({label:this.newChoice.label,id:this.idChoice});this.idChoice++}this.newChoice={}}},{key:"removeChoice",value:function removeChoice(choice){var _this2=this;if(this.model.id){this.$http.delete(Routing.generate("api_delete_facet_field_choice",{choice:choice.id})).then(function(d){_this2.ClarolineAPIService.removeElements([choice],_this2.model.field_facet_choices)},function(d){ClarolineAPIService.errorModal()})}else{this.ClarolineAPIService.removeElements([choice],this.model.field_facet_choices)}}}]);return ModalController}();exports.default=ModalController},147:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FacetRolesController=function(){function FacetRolesController($uibModalInstance,platformRoles,facet){(0,_classCallCheck3.default)(this,FacetRolesController);this.$uibModalInstance=$uibModalInstance;this.platformRoles=platformRoles;this.facet=facet}(0,_createClass3.default)(FacetRolesController,[{key:"onSubmit",value:function onSubmit(){this.$uibModalInstance.close(this.facet)}}]);return FacetRolesController}();exports.default=FacetRolesController},148:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var PanelRolesController=function(){function PanelRolesController($uibModalInstance,platformRoles,panel,form){(0,_classCallCheck3.default)(this,PanelRolesController);this.$uibModalInstance=$uibModalInstance;this.platformRoles=platformRoles;this.panel=panel;this.form=form;var panelRoles=panel.panel_facets_role;var missingRoles=this.platformRoles.filter(function(element){var found=false;panelRoles.forEach(function(panelRole){
if(element.id===panelRole.role.id)found=true});return!found}).forEach(function(element){panelRoles.push({can_open:false,can_edit:false,role:element})})}(0,_createClass3.default)(PanelRolesController,[{key:"onSubmit",value:function onSubmit(){this.$uibModalInstance.close(this.panel)}}]);return PanelRolesController}();exports.default=PanelRolesController}});