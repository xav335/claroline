webpackJsonp([0],[function(module,exports,__webpack_require__){"use strict";var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);__webpack_require__(4);__webpack_require__(5);__webpack_require__(6);__webpack_require__(7);__webpack_require__(91);var _routing=__webpack_require__(120);var _routing2=_interopRequireDefault(_routing);var _AdminHomeTabsConfigCtrl=__webpack_require__(122);var _AdminHomeTabsConfigCtrl2=_interopRequireDefault(_AdminHomeTabsConfigCtrl);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_index2.default.module("AdminHomeTabsConfigModule",["ui.bootstrap","ui.bootstrap.tpls","ui.translation","ui.router","HomeTabsModule","WidgetsModule"]).controller("AdminHomeTabsConfigCtrl",["$http","$stateParams","$state","HomeTabService","WidgetService",_AdminHomeTabsConfigCtrl2.default]).config(_routing2.default)},,,,,,,function(module,exports,__webpack_require__){"use strict";var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);__webpack_require__(5);__webpack_require__(8);__webpack_require__(6);__webpack_require__(9);__webpack_require__(91);var _UserHomeTabCreationModalCtrl=__webpack_require__(107);var _UserHomeTabCreationModalCtrl2=_interopRequireDefault(_UserHomeTabCreationModalCtrl);var _UserHomeTabEditionModalCtrl=__webpack_require__(108);var _UserHomeTabEditionModalCtrl2=_interopRequireDefault(_UserHomeTabEditionModalCtrl);var _AdminHomeTabCreationModalCtrl=__webpack_require__(109);var _AdminHomeTabCreationModalCtrl2=_interopRequireDefault(_AdminHomeTabCreationModalCtrl);var _AdminHomeTabEditionModalCtrl=__webpack_require__(110);var _AdminHomeTabEditionModalCtrl2=_interopRequireDefault(_AdminHomeTabEditionModalCtrl);var _WorkspaceHomeTabCreationModalCtrl=__webpack_require__(111);var _WorkspaceHomeTabCreationModalCtrl2=_interopRequireDefault(_WorkspaceHomeTabCreationModalCtrl);var _WorkspaceHomeTabEditionModalCtrl=__webpack_require__(112);var _WorkspaceHomeTabEditionModalCtrl2=_interopRequireDefault(_WorkspaceHomeTabEditionModalCtrl);var _HomeTabService=__webpack_require__(113);var _HomeTabService2=_interopRequireDefault(_HomeTabService);var _DesktopHomeTabsDirective=__webpack_require__(114);var _DesktopHomeTabsDirective2=_interopRequireDefault(_DesktopHomeTabsDirective);var _AdminHomeTabsDirective=__webpack_require__(116);var _AdminHomeTabsDirective2=_interopRequireDefault(_AdminHomeTabsDirective);var _WorkspaceHomeTabsDirective=__webpack_require__(118);var _WorkspaceHomeTabsDirective2=_interopRequireDefault(_WorkspaceHomeTabsDirective);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_index2.default.module("HomeTabsModule",["ui.bootstrap","ui.bootstrap.tpls","colorpicker.module","ui.translation","ClarolineAPI","WidgetsModule"]).controller("UserHomeTabCreationModalCtrl",_UserHomeTabCreationModalCtrl2.default).controller("UserHomeTabEditionModalCtrl",_UserHomeTabEditionModalCtrl2.default).controller("AdminHomeTabCreationModalCtrl",_AdminHomeTabCreationModalCtrl2.default).controller("AdminHomeTabEditionModalCtrl",_AdminHomeTabEditionModalCtrl2.default).controller("WorkspaceHomeTabCreationModalCtrl",_WorkspaceHomeTabCreationModalCtrl2.default).controller("WorkspaceHomeTabEditionModalCtrl",_WorkspaceHomeTabEditionModalCtrl2.default).service("HomeTabService",_HomeTabService2.default).directive("desktopHomeTabs",function(){return new _DesktopHomeTabsDirective2.default}).directive("adminHomeTabs",function(){return new _AdminHomeTabsDirective2.default}).directive("workspaceHomeTabs",function(){return new _WorkspaceHomeTabsDirective2.default})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);__webpack_require__(5);__webpack_require__(8);__webpack_require__(6);__webpack_require__(9);var _DesktopWidgetInstanceCreationModalCtrl=__webpack_require__(92);var _DesktopWidgetInstanceCreationModalCtrl2=_interopRequireDefault(_DesktopWidgetInstanceCreationModalCtrl);var _DesktopWidgetInstanceEditionModalCtrl=__webpack_require__(93);var _DesktopWidgetInstanceEditionModalCtrl2=_interopRequireDefault(_DesktopWidgetInstanceEditionModalCtrl);var _AdminWidgetInstanceCreationModalCtrl=__webpack_require__(94);var _AdminWidgetInstanceCreationModalCtrl2=_interopRequireDefault(_AdminWidgetInstanceCreationModalCtrl);var _AdminWidgetInstanceEditionModalCtrl=__webpack_require__(95);var _AdminWidgetInstanceEditionModalCtrl2=_interopRequireDefault(_AdminWidgetInstanceEditionModalCtrl);var _WorkspaceWidgetInstanceCreationModalCtrl=__webpack_require__(96);var _WorkspaceWidgetInstanceCreationModalCtrl2=_interopRequireDefault(_WorkspaceWidgetInstanceCreationModalCtrl);var _WorkspaceWidgetInstanceEditionModalCtrl=__webpack_require__(97);var _WorkspaceWidgetInstanceEditionModalCtrl2=_interopRequireDefault(_WorkspaceWidgetInstanceEditionModalCtrl);var _WidgetService=__webpack_require__(98);var _WidgetService2=_interopRequireDefault(_WidgetService);var _WidgetsDirective=__webpack_require__(101);var _WidgetsDirective2=_interopRequireDefault(_WidgetsDirective);var _AdminWidgetsDirective=__webpack_require__(103);var _AdminWidgetsDirective2=_interopRequireDefault(_AdminWidgetsDirective);var _WorkspaceWidgetsDirective=__webpack_require__(105);var _WorkspaceWidgetsDirective2=_interopRequireDefault(_WorkspaceWidgetsDirective);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_index2.default.module("WidgetsModule",["ui.bootstrap","ui.bootstrap.tpls","colorpicker.module","ui.translation","ClarolineAPI","gridster"]).controller("DesktopWidgetInstanceCreationModalCtrl",_DesktopWidgetInstanceCreationModalCtrl2.default).controller("DesktopWidgetInstanceEditionModalCtrl",_DesktopWidgetInstanceEditionModalCtrl2.default).controller("AdminWidgetInstanceCreationModalCtrl",_AdminWidgetInstanceCreationModalCtrl2.default).controller("AdminWidgetInstanceEditionModalCtrl",_AdminWidgetInstanceEditionModalCtrl2.default).controller("WorkspaceWidgetInstanceCreationModalCtrl",_WorkspaceWidgetInstanceCreationModalCtrl2.default).controller("WorkspaceWidgetInstanceEditionModalCtrl",_WorkspaceWidgetInstanceEditionModalCtrl2.default).service("WidgetService",_WidgetService2.default).directive("widgets",function(){return new _WidgetsDirective2.default}).directive("adminWidgets",function(){return new _AdminWidgetsDirective2.default}).directive("workspaceWidgets",function(){return new _WorkspaceWidgetsDirective2.default})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DesktopWidgetInstanceCreationModalCtrl=function(){function DesktopWidgetInstanceCreationModalCtrl($http,$uibModal,$uibModalInstance,ClarolineAPIService,homeTabConfigId,callback){(0,_classCallCheck3.default)(this,DesktopWidgetInstanceCreationModalCtrl);this.$http=$http;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.ClarolineAPIService=ClarolineAPIService;this.homeTabConfigId=homeTabConfigId;this.callback=callback;this.widgetInstance={}}(0,_createClass3.default)(DesktopWidgetInstanceCreationModalCtrl,[{key:"submit",value:function submit(){var _this=this;var data=this.ClarolineAPIService.formSerialize("widget_instance_config_form",this.widgetInstance);var route=Routing.generate("api_post_desktop_widget_instance_creation",{_format:"html",htc:this.homeTabConfigId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.post(route,data,headers).then(function(d){_this.$uibModalInstance.close(d.data)},function(d){if(d.status===400){_this.$uibModalInstance.close();var instance=_this.$uibModal.open({template:d.data,controller:"DesktopWidgetInstanceCreationModalCtrl",controllerAs:"wfmc",bindToController:true,resolve:{homeTabConfigId:function homeTabConfigId(){return _this.homeTabConfigId},callback:function callback(){return _this.callback},widgetInstance:function widgetInstance(){return _this.widgetInstance}}});instance.result.then(function(result){if(!result){return}else{_this.callback(result)}})}})}}]);return DesktopWidgetInstanceCreationModalCtrl}();exports.default=DesktopWidgetInstanceCreationModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof2=__webpack_require__(34);var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DesktopWidgetInstanceEditionModalCtrl=function(){function DesktopWidgetInstanceEditionModalCtrl($http,$sce,$uibModal,$uibModalInstance,$httpParamSerializer,ClarolineAPIService,WidgetService,widgetInstanceId,widgetDisplayId,configurable,contentConfig){(0,_classCallCheck3.default)(this,DesktopWidgetInstanceEditionModalCtrl);this.$http=$http;this.$sce=$sce;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.$httpParamSerializer=$httpParamSerializer;this.ClarolineAPIService=ClarolineAPIService;this.WidgetService=WidgetService;this.widgetInstanceId=widgetInstanceId;this.widgetDisplayId=widgetDisplayId;this.configurable=configurable;this.widgetInstance={};this.contentConfig=this.secureHtml(contentConfig);this.initializeContentConfigForm()}(0,_createClass3.default)(DesktopWidgetInstanceEditionModalCtrl,[{key:"initializeContentConfigForm",value:function initializeContentConfigForm(){var _this=this;if(this.contentConfig===null){var route=Routing.generate("api_get_widget_instance_content_configuration_form",{widgetInstance:this.widgetInstanceId});this.$http.get(route).then(function(d){if(d["status"]===200){_this.contentConfig=_this.secureHtml(d["data"])}})}}},{key:"secureHtml",value:function secureHtml(html){return typeof html==="string"?this.$sce.trustAsHtml(html):html}},{key:"submit",value:function submit(){var _this2=this;if(this.configurable){this.submitContentConfiguration().then(function(result){if(result===null){_this2.submitMainForm()}else if(result){_this2.submitMainForm(result)}})}else{this.submitMainForm()}}},{key:"submitMainForm",value:function submitMainForm(){var _this3=this;var widgetContentConfigResult=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var data=this.ClarolineAPIService.formSerialize("widget_instance_config_form",this.widgetInstance);var route=Routing.generate("api_put_widget_instance_edition",{_format:"html",wdc:this.widgetDisplayId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.put(route,data,headers).then(function(d){_this3.WidgetService.updateWidget(d.data);if(widgetContentConfigResult){_this3.contentConfig=_this3.secureHtml(widgetContentConfigResult)}else{_this3.$uibModalInstance.close()}},function(d){if(d.status===400){_this3.$uibModalInstance.close();_this3.$uibModal.open({template:d.data,controller:"DesktopWidgetInstanceEditionModalCtrl",controllerAs:"wfmc",bindToController:true,resolve:{widgetInstanceId:function widgetInstanceId(){return _this3.widgetInstanceId},widgetDisplayId:function widgetDisplayId(){return _this3.widgetDisplayId},configurable:function configurable(){return _this3.configurable},contentConfig:function contentConfig(){return widgetContentConfigResult},widgetInstance:function widgetInstance(){return _this3.widgetInstance}}})}})}},{key:"submitContentConfiguration",value:function submitContentConfiguration(){var _this4=this;var forms=_index2.default.element(".widget-content-config-form");if(forms.length>0){var _ret=function(){var action=forms[0].action;var formData=_index2.default.element(forms[0]).serializeArray();var data={};formData.forEach(function(d){if(d["name"].endsWith("[]")){if(data[d["name"]]===undefined){data[d["name"]]=[]}data[d["name"]].push(d["value"])}else{data[d["name"]]=d["value"]}});return{v:_this4.$http.post(action,_this4.$httpParamSerializer(data),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(d){if(d["status"]===204){_this4.WidgetService.loadWidgetContent(_this4.widgetInstanceId);return null}else if(d["status"]===200){return d["data"]}})}}();if((typeof _ret==="undefined"?"undefined":(0,_typeof3.default)(_ret))==="object")return _ret.v}else{return null}}}]);return DesktopWidgetInstanceEditionModalCtrl}();exports.default=DesktopWidgetInstanceEditionModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdminWidgetInstanceCreationModalCtrl=function(){function AdminWidgetInstanceCreationModalCtrl($http,$uibModal,$uibModalInstance,ClarolineAPIService,homeTabId,callback){(0,_classCallCheck3.default)(this,AdminWidgetInstanceCreationModalCtrl);this.$http=$http;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.ClarolineAPIService=ClarolineAPIService;this.homeTabId=homeTabId;this.callback=callback;this.widgetInstance={}}(0,_createClass3.default)(AdminWidgetInstanceCreationModalCtrl,[{key:"submit",value:function submit(){var _this=this;var data=this.ClarolineAPIService.formSerialize("widget_instance_config_form",this.widgetInstance);var route=Routing.generate("api_post_admin_widget_instance_creation",{_format:"html",homeTab:this.homeTabId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.post(route,data,headers).then(function(d){_this.$uibModalInstance.close(d.data)},function(d){if(d.status===400){_this.$uibModalInstance.close();var instance=_this.$uibModal.open({template:d.data,controller:"AdminWidgetInstanceCreationModalCtrl",controllerAs:"wfmc",bindToController:true,resolve:{homeTabId:function homeTabId(){return _this.homeTabId},callback:function callback(){return _this.callback},widgetInstance:function widgetInstance(){return _this.widgetInstance}}});instance.result.then(function(result){if(!result){return}else{_this.callback(result)}})}})}}]);return AdminWidgetInstanceCreationModalCtrl}();exports.default=AdminWidgetInstanceCreationModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof2=__webpack_require__(34);var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdminWidgetInstanceEditionModalCtrl=function(){function AdminWidgetInstanceEditionModalCtrl($http,$sce,$uibModal,$uibModalInstance,$httpParamSerializer,ClarolineAPIService,WidgetService,widgetInstanceId,widgetHomeTabConfigId,widgetDisplayId,configurable,contentConfig){(0,_classCallCheck3.default)(this,AdminWidgetInstanceEditionModalCtrl);this.$http=$http;this.$sce=$sce;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.$httpParamSerializer=$httpParamSerializer;this.ClarolineAPIService=ClarolineAPIService;this.WidgetService=WidgetService;this.widgetInstanceId=widgetInstanceId;this.widgetHomeTabConfigId=widgetHomeTabConfigId;this.widgetDisplayId=widgetDisplayId;this.configurable=configurable;this.widgetInstance={};this.contentConfig=this.secureHtml(contentConfig);this.initializeContentConfigForm()}(0,_createClass3.default)(AdminWidgetInstanceEditionModalCtrl,[{key:"initializeContentConfigForm",value:function initializeContentConfigForm(){var _this=this;if(this.contentConfig===null){var route=Routing.generate("api_get_widget_instance_content_configuration_form",{widgetInstance:this.widgetInstanceId});this.$http.get(route).then(function(d){if(d["status"]===200){_this.contentConfig=_this.secureHtml(d["data"])}})}}},{key:"secureHtml",value:function secureHtml(html){return typeof html==="string"?this.$sce.trustAsHtml(html):html}},{key:"submit",value:function submit(){var _this2=this;if(this.configurable){this.submitContentConfiguration().then(function(result){if(result===null){_this2.submitMainForm()}else if(result){_this2.submitMainForm(result)}})}else{this.submitMainForm()}}},{key:"submitMainForm",value:function submitMainForm(){var _this3=this;var widgetContentConfigResult=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var data=this.ClarolineAPIService.formSerialize("widget_instance_config_form",this.widgetInstance);var route=Routing.generate("api_put_admin_widget_instance_edition",{_format:"html",wdc:this.widgetDisplayId,whtc:this.widgetHomeTabConfigId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.put(route,data,headers).then(function(d){_this3.WidgetService.updateWidget(d.data);if(widgetContentConfigResult){_this3.contentConfig=_this3.secureHtml(widgetContentConfigResult)}else{_this3.$uibModalInstance.close()}},function(d){if(d.status===400){_this3.$uibModalInstance.close();_this3.$uibModal.open({template:d.data,controller:"AdminWidgetInstanceEditionModalCtrl",controllerAs:"wfmc",bindToController:true,resolve:{widgetInstanceId:function widgetInstanceId(){return _this3.widgetInstanceId},widgetHomeTabConfigId:function widgetHomeTabConfigId(){return _this3.widgetHomeTabConfigId},widgetDisplayId:function widgetDisplayId(){return _this3.widgetDisplayId},configurable:function configurable(){return _this3.configurable},contentConfig:function contentConfig(){return widgetContentConfigResult},widgetInstance:function widgetInstance(){return _this3.widgetInstance}}})}})}},{key:"submitContentConfiguration",value:function submitContentConfiguration(){var _this4=this;var forms=_index2.default.element(".widget-content-config-form");if(forms.length>0){var _ret=function(){var action=forms[0].action;var formData=_index2.default.element(forms[0]).serializeArray();var data={};formData.forEach(function(d){if(d["name"].endsWith("[]")){if(data[d["name"]]===undefined){data[d["name"]]=[]}data[d["name"]].push(d["value"])}else{data[d["name"]]=d["value"]}});return{v:_this4.$http.post(action,_this4.$httpParamSerializer(data),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(d){if(d["status"]===204){_this4.WidgetService.loadWidgetContent(_this4.widgetInstanceId);return null}else if(d["status"]===200){return d["data"]}})}}();if((typeof _ret==="undefined"?"undefined":(0,_typeof3.default)(_ret))==="object")return _ret.v}else{return null}}}]);return AdminWidgetInstanceEditionModalCtrl}();exports.default=AdminWidgetInstanceEditionModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkspaceWidgetInstanceCreationModalCtrl=function(){function WorkspaceWidgetInstanceCreationModalCtrl($http,$uibModal,$uibModalInstance,ClarolineAPIService,homeTabId,callback){(0,_classCallCheck3.default)(this,WorkspaceWidgetInstanceCreationModalCtrl);this.$http=$http;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.ClarolineAPIService=ClarolineAPIService;this.homeTabId=homeTabId;this.callback=callback;this.widgetInstance={}}(0,_createClass3.default)(WorkspaceWidgetInstanceCreationModalCtrl,[{key:"submit",value:function submit(){var _this=this;var data=this.ClarolineAPIService.formSerialize("widget_instance_config_form",this.widgetInstance);var route=Routing.generate("api_post_workspace_widget_instance_creation",{_format:"html",homeTab:this.homeTabId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.post(route,data,headers).then(function(d){_this.$uibModalInstance.close(d.data)},function(d){if(d.status===400){_this.$uibModalInstance.close();var instance=_this.$uibModal.open({template:d.data,controller:"WorkspaceWidgetInstanceCreationModalCtrl",controllerAs:"wfmc",bindToController:true,resolve:{homeTabId:function homeTabId(){return _this.homeTabId},callback:function callback(){return _this.callback},widgetInstance:function widgetInstance(){return _this.widgetInstance}}});instance.result.then(function(result){if(!result){return}else{_this.callback(result)}})}})}}]);return WorkspaceWidgetInstanceCreationModalCtrl}();exports.default=WorkspaceWidgetInstanceCreationModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof2=__webpack_require__(34);var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkspaceWidgetInstanceEditionModalCtrl=function(){function WorkspaceWidgetInstanceEditionModalCtrl($http,$sce,$uibModal,$uibModalInstance,$httpParamSerializer,ClarolineAPIService,WidgetService,widgetInstanceId,widgetHomeTabConfigId,widgetDisplayId,configurable,contentConfig){(0,_classCallCheck3.default)(this,WorkspaceWidgetInstanceEditionModalCtrl);this.$http=$http;this.$sce=$sce;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.$httpParamSerializer=$httpParamSerializer;this.ClarolineAPIService=ClarolineAPIService;this.WidgetService=WidgetService;this.widgetInstanceId=widgetInstanceId;this.widgetHomeTabConfigId=widgetHomeTabConfigId;this.widgetDisplayId=widgetDisplayId;this.configurable=configurable;this.widgetInstance={};this.contentConfig=this.secureHtml(contentConfig);this.initializeContentConfigForm()}(0,_createClass3.default)(WorkspaceWidgetInstanceEditionModalCtrl,[{key:"initializeContentConfigForm",value:function initializeContentConfigForm(){var _this=this;if(this.contentConfig===null){var route=Routing.generate("api_get_widget_instance_content_configuration_form",{widgetInstance:this.widgetInstanceId});this.$http.get(route).then(function(d){if(d["status"]===200){_this.contentConfig=_this.secureHtml(d["data"])}})}}},{key:"secureHtml",value:function secureHtml(html){return typeof html==="string"?this.$sce.trustAsHtml(html):html}},{key:"submit",value:function submit(){var _this2=this;if(this.configurable){this.submitContentConfiguration().then(function(result){if(result===null){_this2.submitMainForm()}else if(result){_this2.submitMainForm(result)}})}else{this.submitMainForm()}}},{key:"submitMainForm",value:function submitMainForm(){var _this3=this;var widgetContentConfigResult=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var data=this.ClarolineAPIService.formSerialize("widget_instance_config_form",this.widgetInstance);var route=Routing.generate("api_put_workspace_widget_instance_edition",{_format:"html",wdc:this.widgetDisplayId,whtc:this.widgetHomeTabConfigId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.put(route,data,headers).then(function(d){_this3.WidgetService.updateWidget(d.data);if(widgetContentConfigResult){_this3.contentConfig=_this3.secureHtml(widgetContentConfigResult)}else{_this3.$uibModalInstance.close()}},function(d){if(d.status===400){_this3.$uibModalInstance.close();_this3.$uibModal.open({template:d.data,controller:"WorkspaceWidgetInstanceEditionModalCtrl",controllerAs:"wfmc",bindToController:true,resolve:{widgetInstanceId:function widgetInstanceId(){return _this3.widgetInstanceId},widgetHomeTabConfigId:function widgetHomeTabConfigId(){return _this3.widgetHomeTabConfigId},widgetDisplayId:function widgetDisplayId(){return _this3.widgetDisplayId},configurable:function configurable(){return _this3.configurable},contentConfig:function contentConfig(){return widgetContentConfigResult},widgetInstance:function widgetInstance(){return _this3.widgetInstance}}})}})}},{key:"submitContentConfiguration",value:function submitContentConfiguration(){var _this4=this;var forms=_index2.default.element(".widget-content-config-form");if(forms.length>0){var _ret=function(){var action=forms[0].action;var formData=_index2.default.element(forms[0]).serializeArray();var data={};formData.forEach(function(d){if(d["name"].endsWith("[]")){if(data[d["name"]]===undefined){data[d["name"]]=[]}data[d["name"]].push(d["value"])}else{data[d["name"]]=d["value"]}});return{v:_this4.$http.post(action,_this4.$httpParamSerializer(data),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(d){if(d["status"]===204){_this4.WidgetService.loadWidgetContent(_this4.widgetInstanceId);return null}else if(d["status"]===200){return d["data"]}})}}();if((typeof _ret==="undefined"?"undefined":(0,_typeof3.default)(_ret))==="object")return _ret.v}else{return null}}}]);return WorkspaceWidgetInstanceEditionModalCtrl}();exports.default=WorkspaceWidgetInstanceEditionModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _stringify=__webpack_require__(99);var _stringify2=_interopRequireDefault(_stringify);var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WidgetService=function(){function WidgetService($http,$sce,$uibModal,ClarolineAPIService){var _this=this;(0,_classCallCheck3.default)(this,WidgetService);this.$http=$http;this.$sce=$sce;this.$uibModal=$uibModal;this.ClarolineAPIService=ClarolineAPIService;this.widgets=[];this.options={canEdit:false};this.type="desktop";this.widgetsDisplayOptions={};this.widgetHasChanged=false;this.gridsterOptions={columns:12,floating:true,resizable:{enabled:false,handles:["ne","se","sw","nw"],start:function start(){},resize:function resize(){_this.widgetHasChanged=true},stop:function stop(){if(_this.widgetHasChanged){_this.widgetHasChanged=false;_this._updateWidgetsDisplay()}}},draggable:{enabled:false,handle:".widget-header",start:function start(){},drag:function drag(){_this.widgetHasChanged=true},stop:function stop(){if(_this.widgetHasChanged){_this.widgetHasChanged=false;_this._updateWidgetsDisplay()}}}};this._addWidgetCallback=this._addWidgetCallback.bind(this);this._updateWidgetsDisplay=this._updateWidgetsDisplay.bind(this);this._removeWidgetCallback=this._removeWidgetCallback.bind(this)}(0,_createClass3.default)(WidgetService,[{key:"_addWidgetCallback",value:function _addWidgetCallback(d){var data=this.parseWidgetDatas(d);this.widgetsDisplayOptions[data["displayId"]]={id:data["displayId"],row:data["row"],col:data["col"],sizeX:data["sizeX"],sizeY:data["sizeY"]};this.widgets.push(data);this.loadWidgetContent(data["instanceId"]);this._updateWidgetsDisplay()}},{key:"_updateWidgetsDisplay",value:function _updateWidgetsDisplay(){if(this.type==="desktop"){this.checkDesktopWidgetsDisplayOptions()}else if(this.type==="admin"){this.checkAdminWidgetsDisplayOptions()}else if(this.type==="workspace"){this.checkWorkspaceWidgetsDisplayOptions()}}},{key:"_removeWidgetCallback",value:function _removeWidgetCallback(d){var data=JSON.parse(d);if(data["id"]){var index=this.widgets.findIndex(function(w){return data["id"]===w["instanceId"]});if(index>-1){this.widgets.splice(index,1)}this._updateWidgetsDisplay()}}},{key:"getWidgets",value:function getWidgets(){return this.widgets}},{key:"getWidgetsDisplayOptions",value:function getWidgetsDisplayOptions(){return this.widgetsDisplayOptions}},{key:"getOptions",value:function getOptions(){return this.options}},{key:"getGridsterOptions",value:function getGridsterOptions(){return this.gridsterOptions}},{key:"setType",value:function setType(type){this.type=type}},{key:"parseWidgetDatas",value:function parseWidgetDatas(datas){var widgetDatas={};var config=datas["config"]?JSON.parse(datas["config"]):null;var display=datas["display"]?JSON.parse(datas["display"]):null;widgetDatas["configurable"]=datas["configurable"]?datas["configurable"]:null;if(config!==null){widgetDatas["configId"]=config["id"];widgetDatas["locked"]=config["locked"];widgetDatas["visible"]=config["visible"];widgetDatas["type"]=config["type"]}if(display!==null){widgetDatas["displayId"]=display["id"];widgetDatas["row"]=display["row"]>=0?display["row"]:null;widgetDatas["col"]=display["column"]>=0?display["column"]:null;widgetDatas["sizeX"]=display["width"];widgetDatas["sizeY"]=display["height"];widgetDatas["color"]=display["color"];widgetDatas["textTitleColor"]=display["details"]["textTitleColor"]?display["details"]["textTitleColor"]:null;widgetDatas["instanceId"]=display["widgetInstance"]["id"];widgetDatas["instanceName"]=this.$sce.trustAsHtml(display["widgetInstance"]["name"]);widgetDatas["instanceIcon"]=display["widgetInstance"]["icon"];widgetDatas["widgetId"]=display["widgetInstance"]["widget"]["id"];widgetDatas["widgetName"]=display["widgetInstance"]["widget"]["name"]}return widgetDatas}},{key:"generateWidgetsDatas",value:function generateWidgetsDatas(datas){var widgetsDatas=[];datas.forEach(function(d){var widgetDatas={};var config=JSON.parse(d["config"]);var display=JSON.parse(d["display"]);widgetDatas["content"]=d["content"];widgetDatas["configurable"]=d["configurable"];widgetDatas["configId"]=config["id"];widgetDatas["locked"]=config["locked"];widgetDatas["visible"]=config["visible"];widgetDatas["type"]=config["type"];widgetDatas["instanceId"]=config["widgetInstance"]["id"];widgetDatas["instanceName"]=config["widgetInstance"]["name"];widgetDatas["instanceIcon"]=config["widgetInstance"]["icon"];widgetDatas["widgetId"]=config["widgetInstance"]["widget"]["id"];widgetDatas["widgetName"]=config["widgetInstance"]["widget"]["name"];widgetDatas["displayId"]=display["id"];widgetDatas["row"]=display["row"]>=0?display["row"]:null;widgetDatas["col"]=display["column"]>=0?display["column"]:null;widgetDatas["sizeX"]=display["width"];widgetDatas["sizeY"]=display["height"];widgetDatas["color"]=display["color"];widgetDatas["textTitleColor"]=display["details"]["textTitleColor"]?display["details"]["textTitleColor"]:null;widgetsDatas.push(widgetDatas)});return widgetsDatas}},{key:"loadDesktopWidgets",value:function loadDesktopWidgets(tabId,isEditionEnabled){var _this2=this;this.options["canEdit"]=false;if(tabId===0){this.widgets.splice(0,this.widgets.length)}else{var route=Routing.generate("api_get_desktop_widgets_display",{homeTab:tabId});this.$http.get(route).then(function(datas){if(datas["status"]===200){_this2.options["canEdit"]=isEditionEnabled&&!datas["data"]["isLockedHomeTab"];_this2.widgets.splice(0,_this2.widgets.length);_index2.default.merge(_this2.widgets,_this2.generateWidgetsDatas(datas["data"]["widgets"]));_this2.generateWidgetsDisplayOptions();_this2.checkDesktopWidgetsDisplayOptions();_this2.updateGristerEdition();
_this2.secureWidgetsContents()}})}}},{key:"loadAdminWidgets",value:function loadAdminWidgets(tabId){var _this3=this;if(tabId===0){this.widgets.splice(0,this.widgets.length)}else{var route=Routing.generate("api_get_admin_widgets_display",{homeTab:tabId});this.$http.get(route).then(function(datas){if(datas["status"]===200){_this3.widgets.splice(0,_this3.widgets.length);_index2.default.merge(_this3.widgets,_this3.generateWidgetsDatas(datas["data"]));_this3.generateWidgetsDisplayOptions();_this3.checkAdminWidgetsDisplayOptions();_this3.switchGridsterEdition(true);_this3.secureWidgetsContents()}})}}},{key:"loadWorkspaceWidgets",value:function loadWorkspaceWidgets(tabId){var _this4=this;if(tabId===0){this.widgets.splice(0,this.widgets.length)}else{var route=Routing.generate("api_get_workspace_widgets_display",{homeTab:tabId});this.$http.get(route).then(function(datas){if(datas["status"]===200){_this4.widgets.splice(0,_this4.widgets.length);_index2.default.merge(_this4.widgets,_this4.generateWidgetsDatas(datas["data"]));_this4.generateWidgetsDisplayOptions();_this4.checkWorkspaceWidgetsDisplayOptions();_this4.updateGristerEdition();_this4.secureWidgetsContents()}})}}},{key:"updateWidget",value:function updateWidget(d){var data=this.parseWidgetDatas(d);var index=this.widgets.findIndex(function(w){return w["instanceId"]===data["instanceId"]});if(index>-1){this.widgets[index]["instanceName"]=data["instanceName"];this.widgets[index]["color"]=data["color"];this.widgets[index]["textTitleColor"]=data["textTitleColor"];if(data["visible"]!==undefined){this.widgets[index]["visible"]=data["visible"]}if(data["locked"]!==undefined){this.widgets[index]["locked"]=data["locked"]}}}},{key:"secureWidgetsContents",value:function secureWidgetsContents(){var _this5=this;this.widgets.forEach(function(w){w["instanceName"]=_this5.$sce.trustAsHtml(w["instanceName"]);w["content"]=_this5.$sce.trustAsHtml(w["content"])})}},{key:"secureDatas",value:function secureDatas(datas){return this.$sce.trustAsHtml(datas)}},{key:"loadWidgetContent",value:function loadWidgetContent(widgetInstanceId){var _this6=this;var index=this.widgets.findIndex(function(w){return w["instanceId"]===widgetInstanceId});if(index>-1){var route=Routing.generate("claro_widget_instance_content",{widgetInstance:widgetInstanceId});this.$http.get(route).then(function(d){if(d["status"]===200){_this6.widgets[index]["content"]=_this6.secureDatas(d["data"])}})}}},{key:"generateWidgetsDisplayOptions",value:function generateWidgetsDisplayOptions(){var _this7=this;this.widgets.forEach(function(w){var displayId=w["displayId"];_this7.widgetsDisplayOptions[displayId]={id:w["displayId"],row:w["row"],col:w["col"],sizeX:w["sizeX"],sizeY:w["sizeY"]}})}},{key:"checkDesktopWidgetsDisplayOptions",value:function checkDesktopWidgetsDisplayOptions(){var _this8=this;var modifiedWidgets=[];this.widgets.forEach(function(w){var displayId=w["displayId"];if(w["row"]!==_this8.widgetsDisplayOptions[displayId]["row"]||w["col"]!==_this8.widgetsDisplayOptions[displayId]["col"]||w["sizeX"]!==_this8.widgetsDisplayOptions[displayId]["sizeX"]||w["sizeY"]!==_this8.widgetsDisplayOptions[displayId]["sizeY"]){var widgetDatas={id:displayId,row:w["row"],col:w["col"],sizeX:w["sizeX"],sizeY:w["sizeY"]};modifiedWidgets.push(widgetDatas)}});if(modifiedWidgets.length>0){var json=(0,_stringify2.default)(modifiedWidgets);var route=Routing.generate("api_put_desktop_widget_display_update",{datas:json});this.$http.put(route).then(function(datas){if(datas["status"]===200){var displayDatas=datas["data"];displayDatas.forEach(function(d){var id=d["id"];_this8.widgetsDisplayOptions[id]["row"]=d["row"];_this8.widgetsDisplayOptions[id]["col"]=d["col"];_this8.widgetsDisplayOptions[id]["sizeX"]=d["sizeX"];_this8.widgetsDisplayOptions[id]["sizeY"]=d["sizeY"]})}})}}},{key:"checkAdminWidgetsDisplayOptions",value:function checkAdminWidgetsDisplayOptions(){var _this9=this;var modifiedWidgets=[];this.widgets.forEach(function(w){var displayId=w["displayId"];if(w["row"]!==_this9.widgetsDisplayOptions[displayId]["row"]||w["col"]!==_this9.widgetsDisplayOptions[displayId]["col"]||w["sizeX"]!==_this9.widgetsDisplayOptions[displayId]["sizeX"]||w["sizeY"]!==_this9.widgetsDisplayOptions[displayId]["sizeY"]){var widgetDatas={id:displayId,row:w["row"],col:w["col"],sizeX:w["sizeX"],sizeY:w["sizeY"]};modifiedWidgets.push(widgetDatas)}});if(modifiedWidgets.length>0){var json=(0,_stringify2.default)(modifiedWidgets);var route=Routing.generate("api_put_admin_widget_display_update",{datas:json});this.$http.put(route).then(function(datas){if(datas["status"]===200){var displayDatas=datas["data"];displayDatas.forEach(function(d){var id=d["id"];_this9.widgetsDisplayOptions[id]["row"]=d["row"];_this9.widgetsDisplayOptions[id]["col"]=d["col"];_this9.widgetsDisplayOptions[id]["sizeX"]=d["sizeX"];_this9.widgetsDisplayOptions[id]["sizeY"]=d["sizeY"]})}})}}},{key:"checkWorkspaceWidgetsDisplayOptions",value:function checkWorkspaceWidgetsDisplayOptions(){var _this10=this;var modifiedWidgets=[];this.widgets.forEach(function(w){var displayId=w["displayId"];if(w["row"]!==_this10.widgetsDisplayOptions[displayId]["row"]||w["col"]!==_this10.widgetsDisplayOptions[displayId]["col"]||w["sizeX"]!==_this10.widgetsDisplayOptions[displayId]["sizeX"]||w["sizeY"]!==_this10.widgetsDisplayOptions[displayId]["sizeY"]){var widgetDatas={id:displayId,row:w["row"],col:w["col"],sizeX:w["sizeX"],sizeY:w["sizeY"]};modifiedWidgets.push(widgetDatas)}});if(modifiedWidgets.length>0){var json=(0,_stringify2.default)(modifiedWidgets);var route=Routing.generate("api_put_workspace_widget_display_update",{datas:json});this.$http.put(route).then(function(datas){if(datas["status"]===200){var displayDatas=datas["data"];displayDatas.forEach(function(d){var id=d["id"];_this10.widgetsDisplayOptions[id]["row"]=d["row"];_this10.widgetsDisplayOptions[id]["col"]=d["col"];_this10.widgetsDisplayOptions[id]["sizeX"]=d["sizeX"];_this10.widgetsDisplayOptions[id]["sizeY"]=d["sizeY"]})}})}}},{key:"updateGristerEdition",value:function updateGristerEdition(){var editable=this.options["canEdit"];this.gridsterOptions["resizable"]["enabled"]=editable;this.gridsterOptions["draggable"]["enabled"]=editable}},{key:"switchGridsterEdition",value:function switchGridsterEdition(editable){this.gridsterOptions["resizable"]["enabled"]=editable;this.gridsterOptions["draggable"]["enabled"]=editable}},{key:"createUserWidget",value:function createUserWidget(tabConfigId){var _this11=this;if(!this.isHomeTabLocked){var modal=this.$uibModal.open({templateUrl:Routing.generate("api_get_widget_instance_creation_form",{htc:tabConfigId}),controller:"DesktopWidgetInstanceCreationModalCtrl",controllerAs:"wfmc",resolve:{homeTabConfigId:function homeTabConfigId(){return tabConfigId},callback:function callback(){return _this11._addWidgetCallback}}});modal.result.then(function(result){if(!result){return}else{_this11._addWidgetCallback(result)}})}}},{key:"editUserWidget",value:function editUserWidget(_widgetInstanceId,_widgetDisplayId,_configurable){if(!this.isHomeTabLocked){this.$uibModal.open({templateUrl:Routing.generate("api_get_widget_instance_edition_form",{wdc:_widgetDisplayId})+"?bust="+Math.random().toString(36).slice(2),controller:"DesktopWidgetInstanceEditionModalCtrl",controllerAs:"wfmc",resolve:{widgetInstanceId:function widgetInstanceId(){return _widgetInstanceId},widgetDisplayId:function widgetDisplayId(){return _widgetDisplayId},configurable:function configurable(){return _configurable},contentConfig:function contentConfig(){return null}}})}}},{key:"deleteUserWidget",value:function deleteUserWidget(widgetHTCId){if(!this.isHomeTabLocked){var url=Routing.generate("api_delete_desktop_widget_home_tab_config",{widgetHomeTabConfig:widgetHTCId});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},this._removeWidgetCallback,Translator.trans("widget_home_tab_delete_confirm_title",{},"platform"),Translator.trans("widget_home_tab_delete_confirm_message",{},"platform"))}}},{key:"hideAdminWidget",value:function hideAdminWidget(widgetHTCId){if(!this.isHomeTabLocked){var url=Routing.generate("api_put_desktop_widget_home_tab_config_visibility_change",{widgetHomeTabConfig:widgetHTCId});this.ClarolineAPIService.confirm({url:url,method:"PUT"},this._removeWidgetCallback,Translator.trans("widget_home_tab_delete_confirm_title",{},"platform"),Translator.trans("widget_home_tab_delete_confirm_message",{},"platform"))}}},{key:"createAdminWidget",value:function createAdminWidget(tabId){var _this12=this;var modal=this.$uibModal.open({templateUrl:Routing.generate("api_get_admin_widget_instance_creation_form"),controller:"AdminWidgetInstanceCreationModalCtrl",controllerAs:"wfmc",resolve:{homeTabId:function homeTabId(){return tabId},callback:function callback(){return _this12._addWidgetCallback}}});modal.result.then(function(result){if(!result){return}else{_this12._addWidgetCallback(result)}})}},{key:"editAdminWidget",value:function editAdminWidget(_widgetInstanceId2,_widgetHomeTabConfigId,_widgetDisplayId2,_configurable2){this.$uibModal.open({templateUrl:Routing.generate("api_get_admin_widget_instance_edition_form",{whtc:_widgetHomeTabConfigId,wdc:_widgetDisplayId2})+"?bust="+Math.random().toString(36).slice(2),controller:"AdminWidgetInstanceEditionModalCtrl",controllerAs:"wfmc",resolve:{widgetInstanceId:function widgetInstanceId(){return _widgetInstanceId2},widgetHomeTabConfigId:function widgetHomeTabConfigId(){return _widgetHomeTabConfigId},widgetDisplayId:function widgetDisplayId(){return _widgetDisplayId2},configurable:function configurable(){return _configurable2},contentConfig:function contentConfig(){return null}}})}},{key:"deleteAdminWidget",value:function deleteAdminWidget(widgetHTCId){var url=Routing.generate("api_delete_admin_widget_home_tab_config",{widgetHomeTabConfig:widgetHTCId});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},this._removeWidgetCallback,Translator.trans("widget_home_tab_delete_confirm_title",{},"platform"),Translator.trans("widget_home_tab_delete_confirm_message",{},"platform"))}},{key:"createWorkspaceWidget",value:function createWorkspaceWidget(tabId){var _this13=this;var modal=this.$uibModal.open({templateUrl:Routing.generate("api_get_workspace_widget_instance_creation_form",{homeTab:tabId}),controller:"WorkspaceWidgetInstanceCreationModalCtrl",controllerAs:"wfmc",resolve:{homeTabId:function homeTabId(){return tabId},callback:function callback(){return _this13._addWidgetCallback}}});modal.result.then(function(result){if(!result){return}else{_this13._addWidgetCallback(result)}})}},{key:"editWorkspaceWidget",value:function editWorkspaceWidget(_widgetInstanceId3,_widgetHomeTabConfigId2,_widgetDisplayId3,_configurable3){this.$uibModal.open({templateUrl:Routing.generate("api_get_workspace_widget_instance_edition_form",{whtc:_widgetHomeTabConfigId2,wdc:_widgetDisplayId3})+"?bust="+Math.random().toString(36).slice(2),controller:"WorkspaceWidgetInstanceEditionModalCtrl",controllerAs:"wfmc",resolve:{widgetInstanceId:function widgetInstanceId(){return _widgetInstanceId3},widgetHomeTabConfigId:function widgetHomeTabConfigId(){return _widgetHomeTabConfigId2},widgetDisplayId:function widgetDisplayId(){return _widgetDisplayId3},configurable:function configurable(){return _configurable3},contentConfig:function contentConfig(){return null}}})}},{key:"deleteWorkspaceWidget",value:function deleteWorkspaceWidget(widgetHTCId){var url=Routing.generate("api_delete_workspace_widget_home_tab_config",{widgetHomeTabConfig:widgetHTCId});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},this._removeWidgetCallback,Translator.trans("widget_home_tab_delete_confirm_title",{},"platform"),Translator.trans("widget_home_tab_delete_confirm_message",{},"platform"))}}]);return WidgetService}();exports.default=WidgetService},,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _widgets=__webpack_require__(102);var _widgets2=_interopRequireDefault(_widgets);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WidgetsDirective=function WidgetsDirective(){(0,_classCallCheck3.default)(this,WidgetsDirective);this.restrict="E";this.replace=true;this.template=_widgets2.default};exports.default=WidgetsDirective},function(module,exports){module.exports='<div gridster="dhmc.gridsterOptions">\n    <ul>\n        <li gridster-item="widget"\n            class="panel panel-default gridster-item-content"\n            ng-repeat="widget in dhmc.widgets"\n            style="border-color: {{ widget[\'color\'] }}"\n        >\n            <div class="panel-heading widget-header" style="background-color: {{ widget[\'color\'] }}">\n                <h3 class="panel-title">\n                    <span class="pull-right widget-header-control-box" ng-if="dhmc.widgetsOptions[\'canEdit\'] && !widget[\'locked\']">\n                        <span ng-if="widget[\'type\'] === \'desktop\'">\n                            <i class="fa fa-times close"\n                               ng-if="widget[\'type\'] === \'desktop\'"\n                               ng-click="dhmc.deleteUserWidget($event, widget[\'configId\'])"\n                            >\n                            </i>\n                            <span class="close">&nbsp;</span>\n                            <i class="fa fa-pencil close"\n                               ng-if="widget[\'type\'] === \'desktop\'"\n                               ng-click="dhmc.editUserWidget($event, widget[\'instanceId\'], widget[\'displayId\'], widget[\'configurable\'])"\n                            >\n                            </i>\n                        </span>\n                        <i class="fa fa-times close"\n                           ng-if="widget[\'type\'] !== \'desktop\'"\n                           ng-click="dhmc.hideAdminWidget($event, widget[\'configId\'])"\n                        >\n                        </i>\n                        <span class="close" ng-if="widget[\'type\'] !== \'desktop\'">&nbsp;</span>\n                    </span>\n                    <span class="widget-header-content"\n                          title="{{ widget[\'instanceName\'] }}"\n                          style="color: {{ widget[\'textTitleColor\'] }}"\n                          ng-bind-html="widget[\'instanceName\']"\n                    >\n                    </span>\n                </h3>\n            </div>\n            <div class="panel-body home-widget-content">\n                <div ng-bind-html="widget[\'content\']">\n                </div>\n            </div>\n        </li>\n    </ul>\n</div>'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _admin_widgets=__webpack_require__(104);var _admin_widgets2=_interopRequireDefault(_admin_widgets);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdminWidgetsDirective=function AdminWidgetsDirective(){(0,_classCallCheck3.default)(this,AdminWidgetsDirective);this.restrict="E";this.replace=true;this.template=_admin_widgets2.default};exports.default=AdminWidgetsDirective},function(module,exports){module.exports='<div gridster="ahtcc.gridsterOptions">\n    <ul>\n        <li gridster-item="widget"\n            class="panel panel-default gridster-item-content"\n            ng-repeat="widget in ahtcc.widgets"\n            style="border-color: {{ widget[\'color\'] }}"\n        >\n            <div class="panel-heading widget-header" style="background-color: {{ widget[\'color\'] }}">\n                <h3 class="panel-title">\n                    <span class="pull-right widget-header-control-box">\n                        <i class="fa fa-times close" ng-click="ahtcc.deleteAdminWidget($event, widget[\'configId\'])">\n                        </i>\n                        <span class="close">&nbsp;</span>\n                        <i class="fa fa-pencil close"\n                           ng-click="ahtcc.editAdminWidget($event, widget[\'instanceId\'], widget[\'configId\'], widget[\'displayId\'], widget[\'configurable\'])"\n                        >\n                        </i>\n                    </span>\n                    <span class="widget-header-content"\n                          title="{{ widget[\'instanceName\'] }}"\n                          style="color: {{ widget[\'textTitleColor\'] }}"\n                    >\n                        <span ng-if="widget[\'locked\']">\n                            <i class="fa fa-lock"></i>\n                        </span>\n                        <span ng-class="widget[\'visible\'] ? \'\' : \'strike\'" ng-bind-html="widget[\'instanceName\']">\n                        </span>\n                    </span>\n                </h3>\n            </div>\n            <div class="panel-body home-widget-content">\n                <div ng-bind-html="widget[\'content\']">\n                </div>\n            </div>\n        </li>\n    </ul>\n</div>'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _workspace_widgets=__webpack_require__(106);var _workspace_widgets2=_interopRequireDefault(_workspace_widgets);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkspaceWidgetsDirective=function WorkspaceWidgetsDirective(){(0,_classCallCheck3.default)(this,WorkspaceWidgetsDirective);this.restrict="E";this.replace=true;this.template=_workspace_widgets2.default};exports.default=WorkspaceWidgetsDirective},function(module,exports){module.exports='<div gridster="whc.gridsterOptions">\n    <ul>\n        <li gridster-item="widget"\n            class="panel panel-default gridster-item-content"\n            ng-repeat="widget in whc.widgets"\n            style="border-color: {{ widget[\'color\'] }}"\n        >\n            <div class="panel-heading widget-header" style="background-color: {{ widget[\'color\'] }}">\n                <h3 class="panel-title">\n                    <span class="pull-right widget-header-control-box" ng-if="whc.widgetsOptions[\'canEdit\']">\n                        <i class="fa fa-times close" ng-click="whc.deleteWorkspaceWidget($event, widget[\'configId\'])">\n                        </i>\n                        <span class="close">&nbsp;</span>\n                        <i class="fa fa-pencil close"\n                           ng-click="whc.editWorkspaceWidget($event, widget[\'instanceId\'], widget[\'configId\'], widget[\'displayId\'], widget[\'configurable\'])"\n                        >\n                        </i>\n                    </span>\n                    <span class="widget-header-content"\n                          title="{{ widget[\'instanceName\'] }}"\n                          style="color: {{ widget[\'textTitleColor\'] }}"\n                          ng-class="whc.widgetsOptions[\'canEdit\'] && !widget[\'visible\'] ? \'strike\' : \'\'"\n                          ng-bind-html="widget[\'instanceName\']"\n                    >\n                    </span>\n                </h3>\n            </div>\n            <div class="panel-body home-widget-content">\n                <div ng-bind-html="widget[\'content\']">\n                </div>\n            </div>\n        </li>\n    </ul>\n</div>'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var UserHomeTabCreationModalCtrl=function(){function UserHomeTabCreationModalCtrl($http,$uibModal,$uibModalInstance,ClarolineAPIService,callback){(0,_classCallCheck3.default)(this,UserHomeTabCreationModalCtrl);this.$http=$http;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.ClarolineAPIService=ClarolineAPIService;this.callback=callback;this.homeTab={}}(0,_createClass3.default)(UserHomeTabCreationModalCtrl,[{key:"submit",value:function submit(){var _this=this;var data=this.ClarolineAPIService.formSerialize("home_tab_form",this.homeTab);var route=Routing.generate("api_post_user_home_tab_creation",{_format:"html"});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.post(route,data,headers).then(function(d){_this.$uibModalInstance.close(d.data)},function(d){if(d.status===400){_this.$uibModalInstance.close();var instance=_this.$uibModal.open({template:d.data,controller:"UserHomeTabCreationModalCtrl",controllerAs:"htfmc",bindToController:true,resolve:{callback:function callback(){return _this.callback},homeTab:function homeTab(){return _this.homeTab}}});instance.result.then(function(result){if(!result){return}else{_this.callback(result)}})}})}}]);return UserHomeTabCreationModalCtrl}();exports.default=UserHomeTabCreationModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var UserHomeTabEditionModalCtrl=function(){function UserHomeTabEditionModalCtrl($http,$uibModal,$uibModalInstance,ClarolineAPIService,homeTabId,callback){(0,_classCallCheck3.default)(this,UserHomeTabEditionModalCtrl);this.$http=$http;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.ClarolineAPIService=ClarolineAPIService;this.homeTabId=homeTabId;this.callback=callback;this.homeTab={}}(0,_createClass3.default)(UserHomeTabEditionModalCtrl,[{key:"submit",value:function submit(){var _this=this;var data=this.ClarolineAPIService.formSerialize("home_tab_form",this.homeTab);var route=Routing.generate("api_put_user_home_tab_edition",{_format:"html",homeTab:this.homeTabId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.put(route,data,headers).then(function(d){_this.$uibModalInstance.close(d.data)},function(d){if(d.status===400){_this.$uibModalInstance.close();var instance=_this.$uibModal.open({template:d.data,controller:"UserHomeTabEditionModalCtrl",controllerAs:"htfmc",bindToController:true,resolve:{homeTabId:function homeTabId(){return _this.homeTabId},callback:function callback(){return _this.callback},homeTab:function homeTab(){return _this.homeTab}}});instance.result.then(function(result){if(!result){return}else{_this.callback(result)}})}})}}]);return UserHomeTabEditionModalCtrl}();exports.default=UserHomeTabEditionModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdminHomeTabCreationModalCtrl=function(){function AdminHomeTabCreationModalCtrl($http,$uibModal,$uibModalInstance,ClarolineAPIService,callback){(0,_classCallCheck3.default)(this,AdminHomeTabCreationModalCtrl);this.$http=$http;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.ClarolineAPIService=ClarolineAPIService;this.callback=callback;this.homeTab={}}(0,_createClass3.default)(AdminHomeTabCreationModalCtrl,[{key:"submit",value:function submit(){var _this=this;var data=this.ClarolineAPIService.formSerialize("home_tab_form",this.homeTab);var route=Routing.generate("api_post_admin_home_tab_creation",{_format:"html"});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.post(route,data,headers).then(function(d){_this.$uibModalInstance.close(d.data)},function(d){if(d.status===400){_this.$uibModalInstance.close();var instance=_this.$uibModal.open({template:d.data,controller:"AdminHomeTabCreationModalCtrl",controllerAs:"htfmc",bindToController:true,resolve:{callback:function callback(){return _this.callback},homeTab:function homeTab(){return _this.homeTab}}});instance.result.then(function(result){if(!result){return}else{_this.callback(result)}})}})}}]);return AdminHomeTabCreationModalCtrl}();exports.default=AdminHomeTabCreationModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdminHomeTabEditionModalCtrl=function(){function AdminHomeTabEditionModalCtrl($http,$uibModal,$uibModalInstance,ClarolineAPIService,homeTabConfigId,callback){(0,_classCallCheck3.default)(this,AdminHomeTabEditionModalCtrl);this.$http=$http;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.ClarolineAPIService=ClarolineAPIService;this.homeTabConfigId=homeTabConfigId;this.callback=callback;this.homeTab={}}(0,_createClass3.default)(AdminHomeTabEditionModalCtrl,[{key:"submit",value:function submit(){var _this=this;var data=this.ClarolineAPIService.formSerialize("home_tab_form",this.homeTab);var route=Routing.generate("api_put_admin_home_tab_edition",{_format:"html",homeTabConfig:this.homeTabConfigId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.put(route,data,headers).then(function(d){_this.$uibModalInstance.close(d.data)},function(d){if(d.status===400){_this.$uibModalInstance.close();var instance=_this.$uibModal.open({template:d.data,controller:"AdminHomeTabEditionModalCtrl",controllerAs:"htfmc",bindToController:true,resolve:{homeTabConfigId:function homeTabConfigId(){return _this.homeTabConfigId},callback:function callback(){return _this.callback},homeTab:function homeTab(){return _this.homeTab}}});instance.result.then(function(result){if(!result){return}else{_this.callback(result)}})}})}}]);return AdminHomeTabEditionModalCtrl}();exports.default=AdminHomeTabEditionModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkspaceHomeTabCreationModalCtrl=function(){function WorkspaceHomeTabCreationModalCtrl($http,$uibModal,$uibModalInstance,ClarolineAPIService,workspaceId,callback){(0,_classCallCheck3.default)(this,WorkspaceHomeTabCreationModalCtrl);this.$http=$http;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.ClarolineAPIService=ClarolineAPIService;this.workspaceId=workspaceId;this.callback=callback;this.homeTab={}}(0,_createClass3.default)(WorkspaceHomeTabCreationModalCtrl,[{key:"submit",value:function submit(){var _this=this;var data=this.ClarolineAPIService.formSerialize("home_tab_form",this.homeTab);var route=Routing.generate("api_post_workspace_home_tab_creation",{_format:"html",workspace:this.workspaceId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.post(route,data,headers).then(function(d){_this.$uibModalInstance.close(d.data)},function(d){if(d.status===400){_this.$uibModalInstance.close();var instance=_this.$uibModal.open({template:d.data,controller:"WorkspaceHomeTabCreationModalCtrl",controllerAs:"htfmc",bindToController:true,resolve:{workspaceId:function workspaceId(){return _this.workspaceId},callback:function callback(){return _this.callback},homeTab:function homeTab(){return _this.homeTab}}});instance.result.then(function(result){if(!result){return}else{_this.callback(result)}})}})}}]);return WorkspaceHomeTabCreationModalCtrl}();exports.default=WorkspaceHomeTabCreationModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkspaceHomeTabEditionModalCtrl=function(){function WorkspaceHomeTabEditionModalCtrl($http,$uibModal,$uibModalInstance,ClarolineAPIService,homeTabConfigId,callback){(0,_classCallCheck3.default)(this,WorkspaceHomeTabEditionModalCtrl);this.$http=$http;this.$uibModal=$uibModal;this.$uibModalInstance=$uibModalInstance;this.ClarolineAPIService=ClarolineAPIService;this.homeTabConfigId=homeTabConfigId;this.callback=callback;this.homeTab={}}(0,_createClass3.default)(WorkspaceHomeTabEditionModalCtrl,[{key:"submit",value:function submit(){var _this=this;var data=this.ClarolineAPIService.formSerialize("home_tab_form",this.homeTab);var route=Routing.generate("api_put_workspace_home_tab_edition",{_format:"html",homeTabConfig:this.homeTabConfigId});var headers={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.$http.put(route,data,headers).then(function(d){_this.$uibModalInstance.close(d.data)},function(d){if(d.status===400){_this.$uibModalInstance.close();var instance=_this.$uibModal.open({template:d.data,controller:"WorkspaceHomeTabEditionModalCtrl",controllerAs:"htfmc",bindToController:true,resolve:{homeTabConfigId:function homeTabConfigId(){return _this.homeTabConfigId},callback:function callback(){return _this.callback},homeTab:function homeTab(){return _this.homeTab}}});instance.result.then(function(result){if(!result){return}else{_this.callback(result)}})}})}}]);return WorkspaceHomeTabEditionModalCtrl}();exports.default=WorkspaceHomeTabEditionModalCtrl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HomeTabService=function(){function HomeTabService($http,$sce,$uibModal,ClarolineAPIService,WidgetService){(0,_classCallCheck3.default)(this,HomeTabService);this.$http=$http;this.$sce=$sce;this.$uibModal=$uibModal;this.ClarolineAPIService=ClarolineAPIService;this.WidgetService=WidgetService;this.adminHomeTabs=[];this.userHomeTabs=[];this.workspaceHomeTabs=[];this.options={canEdit:false,selectedTabId:0,selectedTabConfigId:0,selectedTabIsLocked:true,workspaceId:null};this._addUserHomeTabCallback=this._addUserHomeTabCallback.bind(this);this._addWorkspaceHomeTabCallback=this._addWorkspaceHomeTabCallback.bind(this);this._addAdminHomeTabCallback=this._addAdminHomeTabCallback.bind(this);this._updateUserHomeTabCallback=this._updateUserHomeTabCallback.bind(this);this._updateWorkspaceHomeTabCallback=this._updateWorkspaceHomeTabCallback.bind(this);this._updateAdminHomeTabCallback=this._updateAdminHomeTabCallback.bind(this);this._removeAdminHomeTabCallback=this._removeAdminHomeTabCallback.bind(this);this._removeWorkspaceHomeTabCallback=this._removeWorkspaceHomeTabCallback.bind(this);
this._removeUserHomeTabCallback=this._removeUserHomeTabCallback.bind(this)}(0,_createClass3.default)(HomeTabService,[{key:"_addUserHomeTabCallback",value:function _addUserHomeTabCallback(d){var data=this.formatHTCDatas(d);this.userHomeTabs.push(data)}},{key:"_addWorkspaceHomeTabCallback",value:function _addWorkspaceHomeTabCallback(d){var data=this.formatHTCDatas(d);this.workspaceHomeTabs.push(data)}},{key:"_addAdminHomeTabCallback",value:function _addAdminHomeTabCallback(d){var data=this.formatHTCDatas(d);this.adminHomeTabs.push(data)}},{key:"_updateUserHomeTabCallback",value:function _updateUserHomeTabCallback(d){var data=this.formatHTCDatas(d);if(data["tabId"]){var index=this.userHomeTabs.findIndex(function(tab){return data["tabId"]===tab["tabId"]});if(index>-1){this.userHomeTabs[index]["tabName"]=data["tabName"];this.userHomeTabs[index]["color"]=data["color"]}}}},{key:"_updateWorkspaceHomeTabCallback",value:function _updateWorkspaceHomeTabCallback(d){var data=this.formatHTCDatas(d);if(data["tabId"]){var index=this.workspaceHomeTabs.findIndex(function(tab){return data["tabId"]===tab["tabId"]});if(index>-1){this.workspaceHomeTabs[index]["tabName"]=data["tabName"];this.workspaceHomeTabs[index]["color"]=data["color"];this.workspaceHomeTabs[index]["locked"]=data["locked"];this.workspaceHomeTabs[index]["visible"]=data["visible"]}}}},{key:"_updateAdminHomeTabCallback",value:function _updateAdminHomeTabCallback(d){var data=this.formatHTCDatas(d);if(data["tabId"]){var index=this.adminHomeTabs.findIndex(function(tab){return data["tabId"]===tab["tabId"]});if(index>-1){this.adminHomeTabs[index]["tabName"]=data["tabName"];this.adminHomeTabs[index]["color"]=data["color"];this.adminHomeTabs[index]["locked"]=data["locked"];this.adminHomeTabs[index]["visible"]=data["visible"]}}}},{key:"_removeAdminHomeTabCallback",value:function _removeAdminHomeTabCallback(d){var data=this.formatHTCDatas(d);if(data["tabId"]){var index=this.adminHomeTabs.findIndex(function(tab){return data["tabId"]===tab["tabId"]});if(index>-1){this.adminHomeTabs.splice(index,1)}if(data["tabId"]===this.options["selectedTabId"]){this.selectDefaultHomeTab()}}}},{key:"_removeUserHomeTabCallback",value:function _removeUserHomeTabCallback(d){var data=this.formatHTCDatas(d);if(data["tabId"]){var index=this.userHomeTabs.findIndex(function(tab){return data["tabId"]===tab["tabId"]});if(index>-1){this.userHomeTabs.splice(index,1)}if(data["tabId"]===this.options["selectedTabId"]){this.selectDefaultHomeTab()}}}},{key:"_removeWorkspaceHomeTabCallback",value:function _removeWorkspaceHomeTabCallback(d){var data=this.formatHTCDatas(d);if(data["tabId"]){var index=this.workspaceHomeTabs.findIndex(function(tab){return data["tabId"]===tab["tabId"]});if(index>-1){this.workspaceHomeTabs.splice(index,1)}if(data["tabId"]===this.options["selectedTabId"]){this.selectDefaultHomeTab()}}}},{key:"getAdminHomeTabs",value:function getAdminHomeTabs(){return this.adminHomeTabs}},{key:"getUserHomeTabs",value:function getUserHomeTabs(){return this.userHomeTabs}},{key:"getWorkspaceHomeTabs",value:function getWorkspaceHomeTabs(){return this.workspaceHomeTabs}},{key:"getOptions",value:function getOptions(){return this.options}},{key:"homeTabsParse",value:function homeTabsParse(datas){var parsedDatas=[];datas.forEach(function(d){parsedDatas.push(JSON.parse(d))});return parsedDatas}},{key:"formatHTCDatas",value:function formatHTCDatas(datas){var jsonDatas=JSON.parse(datas);jsonDatas["tabId"]=jsonDatas["hometab"]["id"];jsonDatas["tabName"]=this.$sce.trustAsHtml(jsonDatas["hometab"]["name"]);jsonDatas["tabType"]=jsonDatas["hometab"]["type"];jsonDatas["tabIcon"]=jsonDatas["hometab"]["icon"];if(jsonDatas["details"]["color"]){jsonDatas["color"]=jsonDatas["details"]["color"]}return jsonDatas}},{key:"generateHomeTabsInfos",value:function generateHomeTabsInfos(homeTabs){var _this=this;homeTabs.forEach(function(h){h["tabId"]=h["hometab"]["id"];h["tabName"]=_this.$sce.trustAsHtml(h["hometab"]["name"]);h["tabType"]=h["hometab"]["type"];h["tabIcon"]=h["hometab"]["icon"];if(h["details"]["color"]){h["color"]=h["details"]["color"]}})}},{key:"loadDesktopHomeTabs",value:function loadDesktopHomeTabs(tabId){var _this2=this;var route=Routing.generate("api_get_desktop_home_tabs");return this.$http.get(route).then(function(datas){if(datas["status"]===200){_this2.adminHomeTabs.splice(0,_this2.adminHomeTabs.length);_this2.userHomeTabs.splice(0,_this2.userHomeTabs.length);_this2.workspaceHomeTabs.splice(0,_this2.workspaceHomeTabs.length);_index2.default.merge(_this2.adminHomeTabs,_this2.homeTabsParse(datas["data"]["tabsAdmin"]));_index2.default.merge(_this2.userHomeTabs,_this2.homeTabsParse(datas["data"]["tabsUser"]));_index2.default.merge(_this2.workspaceHomeTabs,_this2.homeTabsParse(datas["data"]["tabsWorkspace"]));_this2.generateHomeTabsInfos(_this2.adminHomeTabs);_this2.generateHomeTabsInfos(_this2.userHomeTabs);_this2.generateHomeTabsInfos(_this2.workspaceHomeTabs);_this2.selectDefaultHomeTab(tabId)}})}},{key:"loadAdminHomeTabs",value:function loadAdminHomeTabs(tabId){var _this3=this;var route=Routing.generate("api_get_admin_home_tabs");return this.$http.get(route).then(function(datas){if(datas["status"]===200){_this3.adminHomeTabs.splice(0,_this3.adminHomeTabs.length);_index2.default.merge(_this3.adminHomeTabs,_this3.homeTabsParse(datas["data"]));_this3.generateHomeTabsInfos(_this3.adminHomeTabs);_this3.selectDefaultAdminHomeTab(tabId)}})}},{key:"loadWorkspaceHomeTabs",value:function loadWorkspaceHomeTabs(tabId){var _this4=this;var route=Routing.generate("api_get_workspace_home_tabs",{workspace:this.options["workspaceId"]});return this.$http.get(route).then(function(datas){if(datas["status"]===200){_this4.workspaceHomeTabs.splice(0,_this4.workspaceHomeTabs.length);_index2.default.merge(_this4.workspaceHomeTabs,_this4.homeTabsParse(datas["data"]));_this4.generateHomeTabsInfos(_this4.workspaceHomeTabs);_this4.selectDefaultWorkspaceHomeTab(tabId)}})}},{key:"selectDefaultAdminHomeTab",value:function selectDefaultAdminHomeTab(){var tabId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;this.options["selectedTabId"]=0;this.options["selectedTabConfigId"]=0;if(tabId>0){var homeTab=this.adminHomeTabs.find(function(ht){return ht["tabId"]===parseInt(tabId)});if(homeTab){this.options["selectedTabId"]=homeTab["tabId"];this.options["selectedTabConfigId"]=homeTab["configId"]}}else{if(this.adminHomeTabs.length>0){this.options["selectedTabId"]=this.adminHomeTabs[0]["tabId"];this.options["selectedTabConfigId"]=this.adminHomeTabs[0]["configId"]}}this.WidgetService.loadAdminWidgets(this.options["selectedTabId"])}},{key:"selectDefaultWorkspaceHomeTab",value:function selectDefaultWorkspaceHomeTab(){var tabId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;this.options["selectedTabId"]=0;this.options["selectedTabConfigId"]=0;if(tabId>0){var homeTab=this.workspaceHomeTabs.find(function(ht){return ht["tabId"]===parseInt(tabId)});if(homeTab){this.options["selectedTabId"]=homeTab["tabId"];this.options["selectedTabConfigId"]=homeTab["configId"]}}else{if(this.workspaceHomeTabs.length>0){this.options["selectedTabId"]=this.workspaceHomeTabs[0]["tabId"];this.options["selectedTabConfigId"]=this.workspaceHomeTabs[0]["configId"]}}this.WidgetService.loadWorkspaceWidgets(this.options["selectedTabId"])}},{key:"selectDefaultHomeTab",value:function selectDefaultHomeTab(){var tabId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;this.options["selectedTabId"]=0;this.options["selectedTabConfigId"]=0;this.options["selectedTabIsLocked"]=true;if(tabId>0){var homeTab=this.adminHomeTabs.find(function(ht){return ht["tabId"]===parseInt(tabId)});if(homeTab){this.options["selectedTabId"]=homeTab["tabId"];this.options["selectedTabConfigId"]=homeTab["configId"];this.options["selectedTabIsLocked"]=homeTab["locked"]}else{homeTab=this.userHomeTabs.find(function(ht){return ht["tabId"]===parseInt(tabId)});if(homeTab){this.options["selectedTabId"]=homeTab["tabId"];this.options["selectedTabConfigId"]=homeTab["configId"];this.options["selectedTabIsLocked"]=false}else{homeTab=this.workspaceHomeTabs.find(function(ht){return ht["tabId"]===parseInt(tabId)});if(homeTab){this.options["selectedTabId"]=homeTab["tabId"];this.options["selectedTabConfigId"]=homeTab["configId"];this.options["selectedTabIsLocked"]=true}}}}else{if(this.adminHomeTabs.length>0){this.options["selectedTabId"]=this.adminHomeTabs[0]["tabId"];this.options["selectedTabConfigId"]=this.adminHomeTabs[0]["configId"];this.options["selectedTabIsLocked"]=this.adminHomeTabs[0]["locked"]}else if(this.userHomeTabs.length>0){this.options["selectedTabId"]=this.userHomeTabs[0]["tabId"];this.options["selectedTabConfigId"]=this.userHomeTabs[0]["configId"];this.options["selectedTabIsLocked"]=false}else if(this.workspaceHomeTabs.length>0){this.options["selectedTabId"]=this.workspaceHomeTabs[0]["tabId"];this.options["selectedTabConfigId"]=this.workspaceHomeTabs[0]["configId"];this.options["selectedTabIsLocked"]=true}}this.WidgetService.loadDesktopWidgets(this.options["selectedTabId"],this.options["canEdit"])}},{key:"createUserHomeTab",value:function createUserHomeTab(){var _this5=this;if(this.options["canEdit"]){var modal=this.$uibModal.open({templateUrl:Routing.generate("api_get_user_home_tab_creation_form"),controller:"UserHomeTabCreationModalCtrl",controllerAs:"htfmc",resolve:{callback:function callback(){return _this5._addUserHomeTabCallback}}});modal.result.then(function(result){if(!result){return}else{_this5._addUserHomeTabCallback(result)}})}}},{key:"editUserHomeTab",value:function editUserHomeTab(tabId){var _this6=this;if(this.options["canEdit"]){var modal=this.$uibModal.open({templateUrl:Routing.generate("api_get_user_home_tab_edition_form",{homeTab:tabId})+"?bust="+Math.random().toString(36).slice(2),controller:"UserHomeTabEditionModalCtrl",controllerAs:"htfmc",resolve:{homeTabId:function homeTabId(){return tabId},callback:function callback(){return _this6._updateUserHomeTabCallback}}});modal.result.then(function(result){if(!result){return}else{_this6._updateUserHomeTabCallback(result)}})}}},{key:"hideAmdinHomeTab",value:function hideAmdinHomeTab(tabConfigId){if(this.options["canEdit"]){var url=Routing.generate("api_put_admin_home_tab_visibility_toggle",{htc:tabConfigId});this.ClarolineAPIService.confirm({url:url,method:"PUT"},this._removeAdminHomeTabCallback,Translator.trans("home_tab_delete_confirm_title",{},"platform"),Translator.trans("home_tab_delete_confirm_message",{},"platform"))}}},{key:"deleteUserHomeTab",value:function deleteUserHomeTab(tabConfigId){if(this.options["canEdit"]){var url=Routing.generate("api_delete_user_home_tab",{htc:tabConfigId});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},this._removeUserHomeTabCallback,Translator.trans("home_tab_delete_confirm_title",{},"platform"),Translator.trans("home_tab_delete_confirm_message",{},"platform"))}}},{key:"deletePinnedWorkspaceHomeTab",value:function deletePinnedWorkspaceHomeTab(tabConfigId){var url=Routing.generate("api_delete_pinned_workspace_home_tab",{htc:tabConfigId});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},this._removeWorkspaceHomeTabCallback,Translator.trans("home_tab_bookmark_delete_confirm_title",{},"platform"),Translator.trans("home_tab_bookmark_delete_confirm_message",{},"platform"))}},{key:"createAdminHomeTab",value:function createAdminHomeTab(){var _this7=this;var modal=this.$uibModal.open({templateUrl:Routing.generate("api_get_admin_home_tab_creation_form"),controller:"AdminHomeTabCreationModalCtrl",controllerAs:"htfmc",resolve:{callback:function callback(){return _this7._addAdminHomeTabCallback}}});modal.result.then(function(result){if(!result){return}else{_this7._addAdminHomeTabCallback(result)}})}},{key:"editAdminHomeTab",value:function editAdminHomeTab(tabConfigId){var _this8=this;var modal=this.$uibModal.open({templateUrl:Routing.generate("api_get_admin_home_tab_edition_form",{homeTabConfig:tabConfigId})+"?bust="+Math.random().toString(36).slice(2),controller:"AdminHomeTabEditionModalCtrl",controllerAs:"htfmc",resolve:{homeTabConfigId:function homeTabConfigId(){return tabConfigId},callback:function callback(){return _this8._updateAdminHomeTabCallback}}});modal.result.then(function(result){if(!result){return}else{_this8._updateAdminHomeTabCallback(result)}})}},{key:"deleteAdminHomeTab",value:function deleteAdminHomeTab(tabConfigId){var url=Routing.generate("api_delete_admin_home_tab",{homeTabConfig:tabConfigId});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},this._removeAdminHomeTabCallback,Translator.trans("home_tab_delete_confirm_title",{},"platform"),Translator.trans("home_tab_delete_confirm_message",{},"platform"))}},{key:"createWorkspaceHomeTab",value:function createWorkspaceHomeTab(){var _this9=this;var modal=this.$uibModal.open({templateUrl:Routing.generate("api_get_workspace_home_tab_creation_form",{workspace:this.options["workspaceId"]}),controller:"WorkspaceHomeTabCreationModalCtrl",controllerAs:"htfmc",resolve:{workspaceId:function workspaceId(){return _this9.options["workspaceId"]},callback:function callback(){return _this9._addWorkspaceHomeTabCallback}}});modal.result.then(function(result){if(!result){return}else{_this9._addWorkspaceHomeTabCallback(result)}})}},{key:"editWorkspaceHomeTab",value:function editWorkspaceHomeTab(tabConfigId){var _this10=this;var modal=this.$uibModal.open({templateUrl:Routing.generate("api_get_workspace_home_tab_edition_form",{homeTabConfig:tabConfigId})+"?bust="+Math.random().toString(36).slice(2),controller:"WorkspaceHomeTabEditionModalCtrl",controllerAs:"htfmc",resolve:{workspaceId:function workspaceId(){return _this10.options["workspaceId"]},homeTabConfigId:function homeTabConfigId(){return tabConfigId},callback:function callback(){return _this10._updateWorkspaceHomeTabCallback}}});modal.result.then(function(result){if(!result){return}else{_this10._updateWorkspaceHomeTabCallback(result)}})}},{key:"deleteWorkspaceHomeTab",value:function deleteWorkspaceHomeTab(tabConfigId){var url=Routing.generate("api_delete_workspace_home_tab",{homeTabConfig:tabConfigId});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},this._removeWorkspaceHomeTabCallback,Translator.trans("home_tab_delete_confirm_title",{},"platform"),Translator.trans("home_tab_delete_confirm_message",{},"platform"))}},{key:"pinWorkspaceHomeTab",value:function pinWorkspaceHomeTab(tabConfigId){var url=Routing.generate("api_post_workspace_home_tab_bookmark",{homeTabConfig:tabConfigId});this.ClarolineAPIService.confirm({url:url,method:"DELETE"},function(){},Translator.trans("home_tab_bookmark_confirm_title",{},"platform"),Translator.trans("home_tab_bookmark_confirm_message",{},"platform"))}}]);return HomeTabService}();exports.default=HomeTabService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _desktop_home_tabs=__webpack_require__(115);var _desktop_home_tabs2=_interopRequireDefault(_desktop_home_tabs);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DesktopHomeTabsDirective=function DesktopHomeTabsDirective(){(0,_classCallCheck3.default)(this,DesktopHomeTabsDirective);this.restrict="E";this.replace=true;this.template=_desktop_home_tabs2.default};exports.default=DesktopHomeTabsDirective},function(module,exports){module.exports='<div class="home-tabs-panel home-tabpanel" role="tabpanel">\n    <ul class="nav nav-tabs" role="tablist" id="desktop-home-tabs-list">\n        <li ng-repeat="tab in dhmc.adminHomeTabs"\n            class="home-tab"\n            ng-class="(tab[\'tabId\'] === dhmc.homeTabsOptions[\'selectedTabId\']) ? \'active\' : \'\'"\n        >\n            <a href="" ng-click="dhmc.showTab(tab[\'tabId\'], tab[\'configId\'], tab[\'locked\'])">\n                <span class="icon-bg" style="background-color: {{  tab[\'color\']}}">\n                </span>\n                <span class="option-text">\n                    <span ng-bind-html="tab[\'tabName\']">\n                    </span>\n                    <span ng-if="dhmc.homeTabsOptions[\'canEdit\']">\n                        &nbsp;\n                        <i class="fa fa-lock" ng-if="tab[\'locked\']"></i>\n                        <i class="fa fa-times pointer-hand text-muted"\n                           ng-if="!tab[\'locked\']"\n                           ng-click="dhmc.hideAmdinHomeTab($event, tab[\'configId\'])"\n                        >    \n                        </i>\n                    </span>\n                </span>\n            </a>\n        </li>\n        <li ng-repeat="tab in dhmc.userHomeTabs"\n            class="home-tab movable-home-tab"\n            ng-class="(tab[\'tabId\'] === dhmc.homeTabsOptions[\'selectedTabId\']) ? \'active\' : \'\'"\n            data-hometab-config-id="{{ tab[\'configId\'] }}"\n        >\n            <a href="" ng-click="dhmc.showTab(tab[\'tabId\'], tab[\'configId\'], false)">\n                <span class="icon-bg" style="background-color: {{  tab[\'color\']}}">\n                </span>\n                <span class="option-text">\n                    <span ng-bind-html="tab[\'tabName\']">\n                    </span>\n                    <span ng-if="dhmc.homeTabsOptions[\'canEdit\']">\n                        &nbsp;\n                        <i class="fa fa-pencil pointer-hand text-muted"\n                           ng-click="dhmc.editUserHomeTab($event, tab[\'tabId\'])"\n                        >    \n                        </i>\n                        &nbsp;\n                        <i class="fa fa-times pointer-hand text-muted"\n                           ng-click="dhmc.deleteUserHomeTab($event, tab[\'configId\'])"\n                        >    \n                        </i>\n                    </span>\n                </span>\n            </a>\n        </li>\n        <li ng-repeat="tab in dhmc.workspaceHomeTabs"\n            class="home-tab"\n            ng-class="(tab[\'tabId\'] === dhmc.homeTabsOptions[\'selectedTabId\']) ? \'active\' : \'\'"\n        >\n            <a href="" ng-click="dhmc.showTab(tab[\'tabId\'], tab[\'configId\'], true)">\n                <span class="icon-bg" style="background-color: {{  tab[\'color\']}}">\n                </span>\n                <span class="option-text">\n                    <span ng-bind-html="tab[\'tabName\']">\n                    </span>\n                    &nbsp;\n                    <i class="fa fa-thumb-tack pointer-hand text-muted"\n                       ng-click="dhmc.deletePinnedWorkspaceHomeTab($event, tab[\'configId\'])"\n                    >\n                    </i>\n                </span>\n            </a>\n        </li>\n\n        <li class="new-home-tab" ng-if="dhmc.homeTabsOptions[\'canEdit\']">\n            <a href="" class="pointer-hand" ng-click="dhmc.createUserHomeTab()">\n                <span class="text-muted">\n                    <i class="fa fa-plus"></i>\n                    <span ng-if="dhmc.adminHomeTabs.length === 0 && dhmc.userHomeTabs.length === 0 && dhmc.workspaceHomeTabs.length === 0">\n                        {{ \'create_new_home_tab\'|trans:{}:\'platform\' }}\n                    </span>\n                </span>\n            </a>\n        </li>\n    </ul>\n</div>'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _admin_home_tabs=__webpack_require__(117);var _admin_home_tabs2=_interopRequireDefault(_admin_home_tabs);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdminHomeTabsDirective=function AdminHomeTabsDirective(){(0,_classCallCheck3.default)(this,AdminHomeTabsDirective);this.restrict="E";this.replace=true;this.template=_admin_home_tabs2.default};exports.default=AdminHomeTabsDirective},function(module,exports){module.exports='<div class="home-tabs-panel home-tabpanel" role="tabpanel">\n    <ul class="nav nav-tabs" role="tablist" id="admin-home-tabs-list">\n        <li ng-repeat="tab in ahtcc.adminHomeTabs"\n            class="home-tab"\n            ng-class="(tab[\'tabId\'] === ahtcc.homeTabsOptions[\'selectedTabId\']) ? \'active\' : \'\'"\n            data-hometab-config-id="{{ tab[\'configId\'] }}"\n        >\n            <a href="" ng-click="ahtcc.showTab(tab[\'tabId\'], tab[\'configId\'])">\n                <span class="icon-bg" style="background-color: {{ tab[\'color\'] }}">\n                </span>\n                <span class="option-text">\n                    <i class="fa fa-lock" ng-if="tab[\'locked\']"></i>\n                    <span ng-class="tab[\'visible\'] ? \'\' : \'strike\'" ng-bind-html="tab[\'tabName\']">\n                    </span>\n                    &nbsp;\n                    <i class="fa fa-pencil pointer-hand text-muted" ng-click="ahtcc.editAdminHomeTab($event, tab[\'configId\'])"></i>\n                    &nbsp;\n                    <i class="fa fa-times pointer-hand text-muted" ng-click="ahtcc.deleteAdminHomeTab($event, tab[\'configId\'])"></i>\n                </span>\n            </a>\n        </li>\n\n        <li class="new-home-tab">\n            <a href="" class="pointer-hand" ng-click="ahtcc.createAdminHomeTab()">\n                <span class="text-muted">\n                    <i class="fa fa-plus"></i>\n                    <span ng-if="ahtcc.adminHomeTabs.length === 0">\n                        {{ \'create_new_home_tab\'|trans:{}:\'platform\' }}\n                    </span>\n                </span>\n            </a>\n        </li>\n    </ul>\n</div>'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _workspace_home_tabs=__webpack_require__(119);var _workspace_home_tabs2=_interopRequireDefault(_workspace_home_tabs);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkspaceHomeTabsDirective=function WorkspaceHomeTabsDirective(){(0,_classCallCheck3.default)(this,WorkspaceHomeTabsDirective);this.restrict="E";this.replace=true;this.template=_workspace_home_tabs2.default};exports.default=WorkspaceHomeTabsDirective},function(module,exports){module.exports='<div class="home-tabs-panel home-tabpanel" role="tabpanel">\n    <ul class="nav nav-tabs" role="tablist" id="workspace-home-tabs-list">\n        <li ng-repeat="tab in whc.workspaceHomeTabs"\n            class="home-tab"\n            ng-class="(tab[\'tabId\'] === whc.homeTabsOptions[\'selectedTabId\']) ? \'active\' : \'\'"\n            data-hometab-config-id="{{ tab[\'configId\'] }}"\n        >\n            <a href="" ng-click="whc.showTab(tab[\'tabId\'], tab[\'configId\'])">\n                <span class="icon-bg" style="background-color: {{ tab[\'color\'] }}">\n                </span>\n                <span class="option-text">\n                    <i class="fa fa-lock" ng-if="tab[\'locked\'] &&  whc.homeTabsOptions[\'canEdit\']"></i>\n                    <span ng-class="!tab[\'visible\'] && whc.homeTabsOptions[\'canEdit\'] ? \'strike\' : \'\'" ng-bind-html="tab[\'tabName\']">\n                    </span>\n                    <span ng-if="tab[\'tabId\'] === whc.homeTabsOptions[\'selectedTabId\']">\n                        &nbsp;\n                        <i class="fa fa-thumb-tack pointer-hand text-muted" ng-click="whc.pinWorkspaceHomeTab($event, tab[\'configId\'])"></i>\n                    </span>\n                    <span ng-if="whc.homeTabsOptions[\'canEdit\']">\n                        &nbsp;\n                        <i class="fa fa-pencil pointer-hand text-muted" ng-click="whc.editWorkspaceHomeTab($event, tab[\'configId\'])"></i>\n                        &nbsp;\n                        <i class="fa fa-times pointer-hand text-muted" ng-click="whc.deleteWorkspaceHomeTab($event, tab[\'configId\'])"></i>\n                    </span>\n                </span>\n            </a>\n        </li>\n\n        <li class="new-home-tab" ng-if="whc.homeTabsOptions[\'canEdit\']">\n            <a href="" class="pointer-hand" ng-click="whc.createWorkspaceHomeTab()">\n                <span class="text-muted">\n                    <i class="fa fa-plus"></i>\n                    <span ng-if="whc.workspaceHomeTabs.length === 0">\n                        {{ \'create_new_home_tab\'|trans:{}:\'platform\' }}\n                    </span>\n                </span>\n            </a>\n        </li>\n    </ul>\n</div>'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function($stateProvider,$urlRouterProvider){$stateProvider.state("tab",{url:"/tab/{tabId}",template:_config2.default,controller:"AdminHomeTabsConfigCtrl",controllerAs:"ahtcc"});$urlRouterProvider.otherwise("/tab/-1")};var _config=__webpack_require__(121);var _config2=_interopRequireDefault(_config);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},function(module,exports){module.exports="<admin-home-tabs></admin-home-tabs>\n<br>\n<admin-widgets></admin-widgets>\n\n<div ng-if=\"ahtcc.homeTabsOptions['selectedTabId']\">\n    <hr>\n    <span class=\"btn btn-primary\" ng-click=\"ahtcc.createAdminWidget(ahtcc.homeTabsOptions['selectedTabId'])\">\n        <i class=\"fa fa-plus-circle\">\n        </i>\n        {{ 'add_widget_to_home_tab'|trans:{}:'platform' }}\n    </span>\n</div>"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=__webpack_require__(13);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(14);var _createClass3=_interopRequireDefault(_createClass2);var _index=__webpack_require__(1);var _index2=_interopRequireDefault(_index);var _jquery=__webpack_require__(123);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdminHomeTabsConfigCtrl=function(){function AdminHomeTabsConfigCtrl($http,$stateParams,$state,HomeTabService,WidgetService){(0,_classCallCheck3.default)(this,AdminHomeTabsConfigCtrl);this.$http=$http;this.$state=$state;this.HomeTabService=HomeTabService;this.WidgetService=WidgetService;this.tabId=$stateParams.tabId;this.adminHomeTabs=HomeTabService.getAdminHomeTabs();this.homeTabsOptions=HomeTabService.getOptions();this.widgets=WidgetService.getWidgets();this.widgetsDisplayOptions=WidgetService.getWidgetsDisplayOptions();this.gridsterOptions=WidgetService.getGridsterOptions();this.initialize();this.initializeDragAndDrop()}(0,_createClass3.default)(AdminHomeTabsConfigCtrl,[{key:"initialize",value:function initialize(){this.WidgetService.setType("admin");this.HomeTabService.loadAdminHomeTabs(this.tabId)}},{key:"initializeDragAndDrop",value:function initializeDragAndDrop(){var _this=this;_index2.default.element("#admin-home-tabs-list").sortable({items:".home-tab",cursor:"move"});_index2.default.element("#admin-home-tabs-list").on("sortupdate",function(event,ui){var hcId=(0,_jquery2.default)(ui.item).data("hometab-config-id");var nextHcId=-1;var nextElement=(0,_jquery2.default)(ui.item).next();if(nextElement!==undefined&&nextElement.hasClass("home-tab")){nextHcId=nextElement.data("hometab-config-id")}var route=Routing.generate("api_post_admin_home_tab_config_reorder",{homeTabConfig:hcId,nextHomeTabConfigId:nextHcId,homeTabType:"desktop"});_this.$http.post(route)})}},{key:"showTab",value:function showTab(tabId,tabConfigId){this.$state.go("tab",{tabId:parseInt(tabId)},{location:"replace",inherit:false,reload:false,notify:false});this.homeTabsOptions["selectedTabId"]=tabId;this.homeTabsOptions["selectedTabConfigId"]=tabConfigId;this.WidgetService.loadAdminWidgets(tabId)}},{key:"createAdminHomeTab",value:function createAdminHomeTab(){this.HomeTabService.createAdminHomeTab()}},{key:"editAdminHomeTab",value:function editAdminHomeTab($event,tabConfigId){$event.preventDefault();$event.stopPropagation();this.HomeTabService.editAdminHomeTab(tabConfigId)}},{key:"deleteAdminHomeTab",value:function deleteAdminHomeTab($event,tabConfigId){$event.preventDefault();$event.stopPropagation();this.HomeTabService.deleteAdminHomeTab(tabConfigId)}},{key:"createAdminWidget",value:function createAdminWidget(tabId){this.WidgetService.createAdminWidget(tabId)}},{key:"editAdminWidget",value:function editAdminWidget($event,widgetInstanceId,widgetHomeTabConfigId,widgetDisplayId,configurable){$event.preventDefault();$event.stopPropagation();this.WidgetService.editAdminWidget(widgetInstanceId,widgetHomeTabConfigId,widgetDisplayId,configurable)}},{key:"deleteAdminWidget",value:function deleteAdminWidget($event,widgetHTCId){$event.preventDefault();$event.stopPropagation();this.WidgetService.deleteAdminWidget(widgetHTCId)}}]);return AdminHomeTabsConfigCtrl}();exports.default=AdminHomeTabsConfigCtrl}]);